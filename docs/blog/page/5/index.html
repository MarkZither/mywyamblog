<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Blog | Mark Burton</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://blog.mark-burton.com/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://blog.mark-burton.com/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://blog.mark-burton.com/docs/blog/page/5"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="Blog | Mark Burton"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://blog.mark-burton.com/docs/blog/page/5"><link data-rh="true" rel="alternate" href="https://blog.mark-burton.com/docs/blog/page/5" hreflang="en"><link data-rh="true" rel="alternate" href="https://blog.mark-burton.com/docs/blog/page/5" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"Blog","@id":"https://blog.mark-burton.com/docs/blog/page/5","mainEntityOfPage":"https://blog.mark-burton.com/docs/blog/page/5","headline":"Blog","description":"Blog","blogPost":[{"@type":"BlogPosting","@id":"https://blog.mark-burton.com/docs/blog/2020/09/21/migrating-my_blog-from-wyam-to-statiq","mainEntityOfPage":"https://blog.mark-burton.com/docs/blog/2020/09/21/migrating-my_blog-from-wyam-to-statiq","url":"https://blog.mark-burton.com/docs/blog/2020/09/21/migrating-my_blog-from-wyam-to-statiq","headline":"Migrating my blog from Wyam to Statiq","name":"Migrating my blog from Wyam to Statiq","description":"The CleanBlog theme has been created for Statiq so time to try and migrate.","datePublished":"2020-09-21T00:00:00.000Z","author":{"@type":"Person","name":"Mark Burton","description":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","image":"https://github.com/MarkZither.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://blog.mark-burton.com/docs/blog/2020/09/17/local-hostname-resolution-to-port","mainEntityOfPage":"https://blog.mark-burton.com/docs/blog/2020/09/17/local-hostname-resolution-to-port","url":"https://blog.mark-burton.com/docs/blog/2020/09/17/local-hostname-resolution-to-port","headline":"Local Hostname Resolution To Port","name":"Local Hostname Resolution To Port","description":"How to Resolve a Local Hostname to a Port","datePublished":"2020-09-17T00:00:00.000Z","author":{"@type":"Person","name":"Mark Burton","description":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","image":"https://github.com/MarkZither.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://blog.mark-burton.com/docs/blog/2020/09/14/experimenting-with-yarp-a-reverse-proxy","mainEntityOfPage":"https://blog.mark-burton.com/docs/blog/2020/09/14/experimenting-with-yarp-a-reverse-proxy","url":"https://blog.mark-burton.com/docs/blog/2020/09/14/experimenting-with-yarp-a-reverse-proxy","headline":"","name":"","description":"YARP is a reverse proxy toolkit for building fast proxy servers in .NET using the infrastructure from ASP.NET and .NET.","datePublished":"2020-09-14T00:00:00.000Z","author":{"@type":"Person","name":"Mark Burton","description":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","image":"https://github.com/MarkZither.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://blog.mark-burton.com/docs/blog/2020/09/09/getting-the-most-out-of-swagger-in-your-asp-net-core-api","mainEntityOfPage":"https://blog.mark-burton.com/docs/blog/2020/09/09/getting-the-most-out-of-swagger-in-your-asp-net-core-api","url":"https://blog.mark-burton.com/docs/blog/2020/09/09/getting-the-most-out-of-swagger-in-your-asp-net-core-api","headline":"Getting the most out of Swagger in your ASP.NET Core api","name":"Getting the most out of Swagger in your ASP.NET Core api","description":"Even with next to no configuration or additional work on your API Swagger already provides great insights into your API.  To give consumers of the API even more information on what to expect from the API you can add annotations to","datePublished":"2020-09-09T00:00:00.000Z","author":{"@type":"Person","name":"Mark Burton","description":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","image":"https://github.com/MarkZither.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://blog.mark-burton.com/docs/blog/2020/09/09/how-to-setup-asp-net-core-health-check-ui","mainEntityOfPage":"https://blog.mark-burton.com/docs/blog/2020/09/09/how-to-setup-asp-net-core-health-check-ui","url":"https://blog.mark-burton.com/docs/blog/2020/09/09/how-to-setup-asp-net-core-health-check-ui","headline":"How to Setup ASP.NET Core Health Check UI","name":"How to Setup ASP.NET Core Health Check UI","description":"In Part one we setup the health check endpoints, now to add a frontend.","datePublished":"2020-09-09T00:00:00.000Z","author":{"@type":"Person","name":"Mark Burton","description":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","image":"https://github.com/MarkZither.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://blog.mark-burton.com/docs/blog/2020/09/08/secure-asp-net-core-health-checks-to-a-specific-port","mainEntityOfPage":"https://blog.mark-burton.com/docs/blog/2020/09/08/secure-asp-net-core-health-checks-to-a-specific-port","url":"https://blog.mark-burton.com/docs/blog/2020/09/08/secure-asp-net-core-health-checks-to-a-specific-port","headline":"Secure ASP.NET Core Health Checks to a specific port","name":"Secure ASP.NET Core Health Checks to a specific port","description":"Health Checks in ASP.NET Core can give valuable insights into the health of services, but that includes sensitive data that should not be leaked externally.","datePublished":"2020-09-08T00:00:00.000Z","author":{"@type":"Person","name":"Mark Burton","description":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","image":"https://github.com/MarkZither.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://blog.mark-burton.com/docs/blog/2020/09/08/secure-swagger-on-asp-net-core-by-address-and-port","mainEntityOfPage":"https://blog.mark-burton.com/docs/blog/2020/09/08/secure-swagger-on-asp-net-core-by-address-and-port","url":"https://blog.mark-burton.com/docs/blog/2020/09/08/secure-swagger-on-asp-net-core-by-address-and-port","headline":"Secure Swagger on ASP.NET Core by address and port","name":"Secure Swagger on ASP.NET Core by address and port","description":"This follows on from my previous post Secure ASP.NET Core Health Checks to a specific port and assumes that you already have your service running over 2 ports and have specified a ManagementPort in the appsettings.json file.","datePublished":"2020-09-08T00:00:00.000Z","author":{"@type":"Person","name":"Mark Burton","description":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","image":"https://github.com/MarkZither.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://blog.mark-burton.com/docs/blog/VSTO-installs-over-HTTPS-issues","mainEntityOfPage":"https://blog.mark-burton.com/docs/blog/VSTO-installs-over-HTTPS-issues","url":"https://blog.mark-burton.com/docs/blog/VSTO-installs-over-HTTPS-issues","headline":"VSTO installs over HTTPS issues","name":"VSTO installs over HTTPS issues","description":"Test with this setup.exe.  ## The Problem","datePublished":"2019-02-25T00:00:00.000Z","author":{"@type":"Person","name":"Mark Burton","description":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","image":"https://github.com/MarkZither.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://blog.mark-burton.com/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part 2","mainEntityOfPage":"https://blog.mark-burton.com/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part 2","url":"https://blog.mark-burton.com/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part 2","headline":"Using Netlify Identity with NetlifyCMS and Wyam","name":"Using Netlify Identity with NetlifyCMS and Wyam","description":"test a lead","datePublished":"2019-02-15T00:00:00.000Z","author":{"@type":"Person","name":"Mark Burton","description":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","image":"https://github.com/MarkZither.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://blog.mark-burton.com/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-3","mainEntityOfPage":"https://blog.mark-burton.com/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-3","url":"https://blog.mark-burton.com/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-3","headline":"Setting up NetlifyCMS with Wyam, Part 3","name":"Setting up NetlifyCMS with Wyam, Part 3","description":"Configuring a simple single user mode NetlifyCMS with Wyam","datePublished":"2018-03-09T00:00:00.000Z","author":{"@type":"Person","name":"Mark Burton","description":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","image":"https://github.com/MarkZither.png"},"keywords":[]}]}</script><link rel="alternate" type="application/rss+xml" href="/docs/blog/rss.xml" title="Mark Burton RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs/blog/atom.xml" title="Mark Burton Atom Feed"><link rel="stylesheet" href="/docs/assets/css/styles.59b7a052.css">
<script src="/docs/assets/js/runtime~main.b2f12d30.js" defer="defer"></script>
<script src="/docs/assets/js/main.2ee759bc.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/docs/img/logo.svg"><link rel="preload" as="image" href="https://github.com/MarkZither.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/logo.svg" alt="Mark Burton Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs/img/logo.svg" alt="Mark Burton Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Mark Burton</b></a><a class="navbar__item navbar__link" href="/docs/docs/intro">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/MarkZither/mywyamblog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/blog/2025/10/14/days-10-11-quiet-days-and-transfer">Days 10-12 of Recovery - Transfer to Kirchberg and Cardiologist Care</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/blog/2025/10/12/day-9-pacemaker-recovery">Day 9 of Recovery - Pacemaker Results, You Won&#x27;t Believe What Comes Next</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/blog/2025/10/11/day-8-pacemaker-surgery">Day 8 of Recovery - Additional Surgery to Fit Pacemaker</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/blog/2025/10/08/day-5-normal-ward-progress">Days 6-7 of Recovery - Settling Into the Normal Ward</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/blog/2025/10/07/day-6-normal-ward-progress">Day 5 - Progress on the Normal Ward</a></li></ul></div></nav></aside><main class="col col--7"><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/docs/blog/2020/09/21/migrating-my_blog-from-wyam-to-statiq">Migrating my blog from Wyam to Statiq</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2020-09-21T00:00:00.000Z">September 21, 2020</time> · <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/MarkZither.png" alt="Mark Burton"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp" translate="no">Mark Burton</span></a></div><small class="authorTitle_nd0D" title="Software Engineer &amp; Technical Writer">Software Engineer &amp; Technical Writer</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>The initial steps to setup a new blog with Statiq or migrate from Wyam are covered in <a href="https:/github.comstatiqdevCleanBlog#porting-from-wyam" target="_blank" rel="noopener noreferrer">porting from Wyam</a> document in the CleanBlog repo.  There are additional points raised in the GitHub discussions on the <a href="https:/github.comstatiqdevDiscussionsdiscussions" target="_blank" rel="noopener noreferrer">StatiqDev Discussions repo</a> most specifically in the <a href="https:/github.comstatiqdevDiscussionsdiscussions15" target="_blank" rel="noopener noreferrer">Migration from Wyam</a> discussion.  I had customized my blog slightly while using Wyam so there was some additional work to do.  ## Bringing back the triangles
Several javascript libraries have been removed from the CleanBlog theme, some of which were used to generate dynamic triangles for the header background when an image is not used. I started the discussion <a href="https:/github.comstatiqdevDiscussionsdiscussions17" target="_blank" rel="noopener noreferrer">Javascript changes between Wyam and Statiq CleanBlog (or where have my triangles gone? 😊 )</a> and reintroduced the necessary libraries to bring back the triangles.  ## Font Awesome Updates
The move from FontAwesome 4 to 5 means that many icons stopped working, this is due to brand icons moving to a new prefix, so I had to change <code>fa</code> to <code>fab</code> in a number of places, where <code>fa</code> still works it appears better to change those to <code>fas</code> based on <a href="https:/fontawesome.comhow-to-useon-the-websetupupgrading-from-version-4" target="_blank" rel="noopener noreferrer">FontAwesome&#x27;s own upgrading from version 4 guide</a>  ## Fix styles on custom navbar entries
I added a dropdown to my navbar, which has lost its style after the upgrade, this appears to be a bootstrap 3 to upgrade issue.  ## Publishing to Netlify
Install the Netlify CLI <code>npm install netlify-cli -g</code>  ## Exclude NetlifyCMS directory from processing and copy it to output
I have been managing my <a href="https:/github.comMarkZithermywyamblogtreemasterinputadmin" target="_blank" rel="noopener noreferrer">Wyam blog with NetlifyCMS</a>, this is simply a directory called <code>admin</code> with 2 files, <code>index.html</code> and <code>config.yml</code>. Wyam copied those files unchanged to the output.  With Statiq that has changed and it processes the html file which makes it invalid, skips the <code>config.yml</code> file and adds a link to <code>admin</code> to the NavBar.  Adding a file called <code>_directory.yml</code> to the <code>admin</code> directory makes it possible to set directory wide meta data, <code>ShowInNavBar: False</code> removes the admin link from the NavBar, setting the ContentType and MediaType, as discussed on the StatiqDev GitHub discussion <a href="https:/github.comstatiqdevDiscussionsdiscussions15" target="_blank" rel="noopener noreferrer">Migration from Wyam</a>, resulted in the desired behaviour  <code>yaml ShowInNavBar: False ContentType: Asset MediaType: textplain</code>  ## Update _post-footer.cshtml to set the Disqus configuration variables  ``` csharp  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */  var disqus_identifier = &#x27;@Document.Destination.FileNameWithoutExtension.FullPath&#x27;;  var disqus_title = &#x27;@Document.GetString(&quot;Title&quot;)&#x27;;  var disqus_url = &#x27;@Document.GetLink(true)&#x27;;</p>
<pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar language-## codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"></code></pre></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="Static site generator" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/wyam">Wyam</a></li><li class="tag_QGVx"><a rel="tag" title="Static site generator" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/statiq">Statiq</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/docs/blog/2020/09/17/local-hostname-resolution-to-port">Local Hostname Resolution To Port</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2020-09-17T00:00:00.000Z">September 17, 2020</time> · <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/MarkZither.png" alt="Mark Burton"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp" translate="no">Mark Burton</span></a></div><small class="authorTitle_nd0D" title="Software Engineer &amp; Technical Writer">Software Engineer &amp; Technical Writer</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>It is not possible to make this work on 127.0.0.1, however the entire block 1278 is reserved for local loopback so any other 127.n.n.n address will work, more interesting reading about that on <a href="https:/serverfault.comquestions157496why-is-loopback-ip-address-from-127-0-0-1-to-127-255-255-254" target="_blank" rel="noopener noreferrer">stackoverflow</a> and in <a href="https:/www.ietf.orgrfcrfc3330.txt" target="_blank" rel="noopener noreferrer">RFC 1700</a>
:::</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hosts-file--add-a-new-entry-for-each-service-to-the-hosts-file-in-cwindowssystem32driversetc---cmd--127002--mailhoginternal--127003--gitinternal">Hosts file  Add a new entry for each service to the <code>hosts</code> file in <code>C:\Windows\System32\drivers\etc\</code>.  ``` cmd  127.0.0.2  mailhog.internal  127.0.0.3  git.internal<a href="#hosts-file--add-a-new-entry-for-each-service-to-the-hosts-file-in-cwindowssystem32driversetc---cmd--127002--mailhoginternal--127003--gitinternal" class="hash-link" aria-label="Direct link to hosts-file--add-a-new-entry-for-each-service-to-the-hosts-file-in-cwindowssystem32driversetc---cmd--127002--mailhoginternal--127003--gitinternal" title="Direct link to hosts-file--add-a-new-entry-for-each-service-to-the-hosts-file-in-cwindowssystem32driversetc---cmd--127002--mailhoginternal--127003--gitinternal" translate="no">​</a></h3>
<p>```  ### Unbound  Install <a href="https:/nlnetlabs.nlprojectsunbounddownload" target="_blank" rel="noopener noreferrer">Unbound</a>.  Add entries to <code>service.conf</code> by default on Windows that is in <code>C:\Program Files\Unbound</code>  ### .local vs .localhost vs .test vs .internal</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>After reading round in circles about reserved TLDs such as <a href="https:/tools.ietf.orghtmlrfc2606#page-2" target="_blank" rel="noopener noreferrer">rfc2606</a> which lists <code>.test</code>, <code>.example</code>, <code>.invalid</code>, <code>.localhost</code> as reserved domain names. This stackoverflow on <a href="https:/stackoverflow.comquestions19016553add-subdomain-to-localhost-url" target="_blank" rel="noopener noreferrer">best practices for internal domain and network names</a> This <a href="https:/social.technet.microsoft.comwikicontentsarticles34981.active-directory-best-practices-for-internal-domain-and-network-names.aspx" target="_blank" rel="noopener noreferrer">TechNet article</a> which goes back on previous advice about the use of <code>.local</code> and <code>.internal</code>.The risks of using my initial choice of <code>.local</code> due to possible clashes with mDNS and Zero Configuration Networking. Trying to use servicename.localhost with mixed results (works with hosts file but causes Unbound to throw and error and fail to start) and noticing that docker uses <code>.internal</code> I finally found <a href="https:/tools.ietf.orghtmlrfc6762#appendix-G" target="_blank" rel="noopener noreferrer">RFC6762#appendix-G</a> which lists <code>.intranet.</code>, <code>.internal.</code>, <code>.private.</code>,  <code>.corp.</code>, <code>.home.</code> and <code>.lan.</code> as proposed reserved domain names, I settled on using .internal.</p></div></div>
<div class="language-cmd codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cmd codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">server:  local-data: &quot;mailhog.internal A 127.0.0.2&quot;  local-data-ptr: &quot;127.0.0.2 mailhog.internal&quot;  local-data: &quot;git.internal A 127.0.0.3&quot;  local-data-ptr: &quot;127.0.0.3 git.internal&quot;  ```  Restart the service to make sure the new settings are used.  Add `127.0.0.1` at the top of the list of DNS servers in network settings.  ![Network settings with 127.0.0.1 as DNS server](/img/local_dns_with_unbound_network_settings.png)  ## Add a netsh interface portproxy  ```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netsh interface portproxy add v4tov4 listenport=80 listenaddress=127.0.0.2 connectport=8025 connectaddress=127.0.0.2  netsh interface portproxy add v4tov4 listenport=80 listenaddress=127.0.0.3 connectport=3005 connectaddress=127.0.0.3</span><br></span></code></pre></div></div>
<p>or by domain name</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">netsh interface portproxy add v4tov4 listenport=80 listenaddress=mailhog connectport=8025 connectaddress=127.0.0.2  netsh interface portproxy add v4tov4 listenport=80 listenaddress=git.local connectport=3005 connectaddress=127.0.0.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```  :::info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Between the 16 million loopback addresses and 65 thousand (48k usable according to [TCPIP number usage] and the Microsoft article [Port Exhaustion and You]) ports that leaves us a whole lot of services we can address on a single machine. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I still need to figure out how this will work with IPv6 at the moment I only use IPv4 locally. I also need to understand the exact equivalence of `127.0.0.08` and `::1128`.  netsh interface portproxy add v6tov4 listenport=80 listenaddress \\{IPv6Address | HostName\} \[connectaddress=] \\{IPv4Address | HostName\} \[[connectport=] \\{Integer | ServiceName\}] \[[listenaddress=] \\{IPv6Address | HostName\} \[[protocol=]tcp]  Full [Network Shell (netsh) documentation](https:/docs.microsoft.comen-uswindows-servernetworkingtechnologiesnetshnetsh-interface-portproxy) on Microsoft docs.  ## References</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Using port number in Windows host file]: https:/stackoverflow.coma/366467497400768</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[TCPIP number usage]: https:/stackoverflow.comquestions113224what-is-the-largest-tcp-ip-network-port-number-allowable-for-ipv4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Port Exhaustion and You]: https:/docs.microsoft.comen-usarchiveblogsaskdsport-exhaustion-and-you-or-why-the-netstat-tool-is-your-friend</span><br></span></code></pre></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="Windows network shell" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/netsh">netsh</a></li><li class="tag_QGVx"><a rel="tag" title="DNS resolver" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/unbound">Unbound</a></li><li class="tag_QGVx"><a rel="tag" title="Domain Name System" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/dns">DNS</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/docs/blog/2020/09/14/experimenting-with-yarp-a-reverse-proxy"></a></h2><div class="container_mt6G margin-vert--md"><time datetime="2020-09-14T00:00:00.000Z">September 14, 2020</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/MarkZither.png" alt="Mark Burton"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp" translate="no">Mark Burton</span></a></div><small class="authorTitle_nd0D" title="Software Engineer &amp; Technical Writer">Software Engineer &amp; Technical Writer</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>A Route is the inbound URL which the reverse proxy is going to act on. The cluster is a list of potential destination URLs.</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;ReverseProxy&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;Routes&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;RouteId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;LoginServiceRoute&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;ClusterId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;clusterLoginService&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;Match&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;Path&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/loginservice/{**remainder}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;Transforms&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;PathRemovePrefix&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/loginservice&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;Clusters&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;clusterLoginService&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;Destinations&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;clusterLoginService/destination1&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;Address&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://localhost:1116/&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```  This would be similar to this NGINX virtual server configuration.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  listen </span><span class="token number" style="color:#36acaa">80</span><span class="token plain">;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  server_name localhost;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  location /loginservice/ </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy_pass https</span><span class="token operator" style="color:#393A34">:</span><span class="token comment" style="color:#999988;font-style:italic">//localhost:1116/;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```  Take care when adding a transformation to a route</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> **do not** add a single transformation</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> it must be wrapped in </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> or you will get no transformations and lots of confusion.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">My mistake looked like this</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;RouteId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;TestServiceRoute&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;ClusterId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;clusterTestService&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;Match&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;Path&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/testservice/{**remainder}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;Transforms&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;PathRemovePrefix&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/testservice&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```  It took debugging into the YARP source to figure out my mistake which resulted in </span><span class="token number" style="color:#36acaa">503</span><span class="token plain"> and </span><span class="token number" style="color:#36acaa">404</span><span class="token plain"> errors due to URLs like `https</span><span class="token operator" style="color:#393A34">:</span><span class="token comment" style="color:#999988;font-style:italic">//localhost:1116/loginservice/hc` instead of the correct `https://localhost:1116/hc`.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;RouteId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;TestServiceRoute&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;ClusterId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;clusterTestService&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;Match&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;Path&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/testservice/{**remainder}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;Transforms&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// &lt;-- was missing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;PathRemovePrefix&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/testservice&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// &lt;-- was missing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```  It is easier to see the issue as soon as you start adding additional transformations. In preview </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> for example it is possible to transform route values to querystring parameters</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> now it is clear that `Transformations` must be an array.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;RouteId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;TestPatternServiceRoute&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;ClusterId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;clusterTestService&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;Match&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;Path&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/testpatternservice/{**remainder}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;Transforms&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;PathPattern&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/search&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;QueryRouteParameter&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;q&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;Append&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;remainder&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><br></span></code></pre></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="Microsoft ASP.NET Core framework" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/aspnet-core">ASP.NET Core</a></li><li class="tag_QGVx"><a rel="tag" title="Yet Another Reverse Proxy" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/yarp">YARP</a></li><li class="tag_QGVx"><a rel="tag" title="Reverse proxy technologies" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/reverse-proxy">Reverse Proxy</a></li><li class="tag_QGVx"><a rel="tag" title="NGINX web server" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/nginx">NGINX</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/docs/blog/2020/09/09/getting-the-most-out-of-swagger-in-your-asp-net-core-api">Getting the most out of Swagger in your ASP.NET Core api</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2020-09-09T00:00:00.000Z">September 9, 2020</time> · <!-- -->One min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/MarkZither.png" alt="Mark Burton"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp" translate="no">Mark Burton</span></a></div><small class="authorTitle_nd0D" title="Software Engineer &amp; Technical Writer">Software Engineer &amp; Technical Writer</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>Even with next to no configuration or additional work on your API Swagger already provides great insights into your API.  To give consumers of the API even more information on what to expect from the API you can add annotations to</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="Microsoft ASP.NET Core framework" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/aspnet-core">ASP.NET Core</a></li><li class="tag_QGVx"><a rel="tag" title="API documentation with Swagger" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/swagger">Swagger</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/docs/blog/2020/09/09/how-to-setup-asp-net-core-health-check-ui">How to Setup ASP.NET Core Health Check UI</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2020-09-09T00:00:00.000Z">September 9, 2020</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/MarkZither.png" alt="Mark Burton"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp" translate="no">Mark Burton</span></a></div><small class="authorTitle_nd0D" title="Software Engineer &amp; Technical Writer">Software Engineer &amp; Technical Writer</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>In <a href="/docs/blog/page/2020-09-08-secure-asp-net-core-health-checks-to-a-specific-port">Part one</a> we setup the health check endpoints, now to add a frontend.</p>
<p>The <a href="/docs/blog/page/2020-09-08-secure-asp-net-core-health-checks-to-a-specific-port">Health Checks UI</a> is best hosted in its own service as it can consolidate health checks for a number of services.</p>
<p><img decoding="async" loading="lazy" alt="Swagger CORS error" src="/docs/assets/images/healthchecksui-94af31c8318f7d45315679e579de276e.png" width="1366" height="728" class="img_ev3q"></p>
<p>Adding the HealthChecks UI to the service involves adding 2 nuget packages, the main <code>AspNetCore.HealthChecks.UI</code> package and a storage provider, initially I have used the InMemory storage provider as I do not have the need to see historical data. There are also providers various databases including SqlServer and SQLite which can be used to persist the data.</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">PackageReference</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">Include</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">AspNetCore.HealthChecks.UI</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">Version</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">$(AspNetCoreHealthChecksUIVersion)</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">PackageReference</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">Include</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">AspNetCore.HealthChecks.UI.InMemory.Storage</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">Version</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">$(AspNetCoreHealthChecksUIVersion)</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><br></span></code></pre></div></div>
<p>As the HealthChecks nuget packages will be used across all projects I have set the version numbers centrally in <a href="https://github.com/MarkZither/SwaggerAndHealthCheckBlog/blob/master/Directory.Build.props" target="_blank" rel="noopener noreferrer">Directory.Build.props</a>.</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">AspNetCoreHealthChecksUIVersion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">3.1.1</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">AspNetCoreHealthChecksUIVersion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<p>The HealthChecks UI can now be added to <code>ConfigureServices</code> and <code>Configure</code> in <a href="https://github.com/MarkZither/SwaggerAndHealthCheckBlog/blob/master/src/MonitoringService/Startup.cs" target="_blank" rel="noopener noreferrer">Startup.cs</a>.</p>
<p>As I want to limit the access to the UI in the same way as I did for the HealthCheck endpoints I have the service listening on multiple ports and use <code>RequireHost</code> when configuring the endpoints to ensure the UI is only accessible internally.</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public void ConfigureServices(IServiceCollection services)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .AddHealthChecksUI()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .AddInMemoryStorage();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  services.AddControllers();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void Configure(IApplicationBuilder app, IWebHostEnvironment env)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  app.UseHealthChecksUI();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  app.UseEndpoints(endpoints =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    endpoints.MapControllers();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    endpoints.MapHealthChecksUI(config =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      config.UIPath = &quot;/hc-ui&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }).RequireHost($&quot;*:{Configuration[&quot;ManagementPort&quot;]}&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```  Finally we need to tell the UI where to read the HealthChecks from, this can either be done in a configuration file  ```json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;https_port&quot;: 1131,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Urls&quot;: &quot;http://localhost:1130;https://localhost:1131;https://localhost:1132&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;ManagementPort&quot;: &quot;1132&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;AllowedHosts&quot;: &quot;*&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;HealthChecks-UI&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;HealthChecks&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Name&quot;: &quot;LoginService Check&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Uri&quot;: &quot;https://localhost:1116/hc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Name&quot;: &quot;ResourceService Check&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Uri&quot;: &quot;https://localhost:5002/hc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Name&quot;: &quot;NotificationService Check&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Uri&quot;: &quot;https://localhost:1179/hc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```  or in code by adding settings to the `AddHealthChecksUI` method.  ```csharp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">services.AddHealthChecksUI(setupSettings: settings =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  settings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .DisableDatabaseMigrations()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .AddHealthCheckEndpoint(name: healthCheckName, uri: healthCheckUri)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .AddWebhookNotification(name: webhookName, uri: webhookUri, payload: webhookPayload,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      restorePayload: webhookRestorePayload)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .SetEvaluationTimeInSeconds(evaluationTimeInSeconds)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .SetMinimumSecondsBetweenFailureNotifications(minimumSeconds);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}).AddInMemoryStorage();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```  You can get the full working demo from [my GitHub repo](https:/github.comMarkZitherSwaggerAndHealthCheckBlog).</span><br></span></code></pre></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="Microsoft ASP.NET Core framework" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/aspnet-core">ASP.NET Core</a></li><li class="tag_QGVx"><a rel="tag" title="Application health monitoring" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/health-checks">Health Checks</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/docs/blog/2020/09/08/secure-asp-net-core-health-checks-to-a-specific-port">Secure ASP.NET Core Health Checks to a specific port</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2020-09-08T00:00:00.000Z">September 8, 2020</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/MarkZither.png" alt="Mark Burton"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp" translate="no">Mark Burton</span></a></div><small class="authorTitle_nd0D" title="Software Engineer &amp; Technical Writer">Software Engineer &amp; Technical Writer</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>To secure Health Checks it is possible to make them available on internal addresses only and on a different port to the publicly served pagesAPI endpoints.  First we need to make the service available over 2 different ports, this can be achieved by adding a Urls value to the appsettings.config.  <code>json  &quot;Logging&quot;: \\\{  &quot;IncludeScopes&quot;: false,  &quot;LogLevel&quot;: \{  &quot;Default&quot;: &quot;Debug&quot;,  &quot;System&quot;: &quot;Information&quot;,  &quot;Microsoft&quot;: &quot;Information&quot;  \\}  },  &quot;Urls&quot;: &quot;http:/localhost:1114;http:/localhost:1115&quot;,  &quot;ManagementPort&quot;: &quot;1115&quot;,  &quot;ConnectionStrings&quot;: \\{  &quot;LoginServiceDb&quot;: &quot;Data Source=.,11433;Initial Catalog=LoginServiceDatabase;Integrated Security=true;&quot;  \}, </code>  This can be done in several ways, and is described in more detail by Andrew Lock in his post <a href="https:/andrewlock.net5-ways-to-set-the-urls-for-an-aspnetcore-app" target="_blank" rel="noopener noreferrer">5 ways to set the URLs for an ASP.NET Core app</a>.  Now when you debug the service you should see in the log that it is listening on 2 ports  ```
info: Microsoft.Hosting.Lifetime[0]  Now listening on: http:/localhost:1114
info: Microsoft.Hosting.Lifetime[0]  Now listening on: http:/localhost:1115
info: Microsoft.Hosting.Lifetime[0]  Application started. Press Ctrl+C to shut down.</p>
<div class="language-:::primary codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-:::primary codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">**Special note if you are using http.sys** If you want to run this over https you will need to take care of the port reservation and certification binding. I have a explanation of that in the GitHub Repo README.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::  Now that we have the service listening on 2 addresses we can specify one of them will serve up the Health Checks by setting the `ManagementPort`.  In `startup.cs` we can use the `ManagementPort` to secure the Health Check endpoint  ```csharp  HealthCheck middleware  app.UseHealthChecks(&quot;hc&quot;, $&quot;\\{Configuration[&quot;ManagementPort&quot;]\}&quot;, new HealthCheckOptions() \\{  Predicate = _ =&gt; true,  ResponseWriter = UIResponseWriter.WriteHealthCheckUIResponse  \});  app.UseEndpoints(endpoints =&gt; \\\{  endpoints.MapControllerRoute(&quot;default&quot;, &quot;\{controller=Home\\}\{action=Index\}\\{id?\}&quot;);  endpoints.MapHealthChecks(&quot;health&quot;).RequireHost($&quot;*:\\{Configuration[&quot;ManagementPort&quot;]\}&quot;);  });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```  If you debug now you will have access to the `health` endpoint only on the `ManagementPort` and not on the public facing URL.  ![HealthCheck external shows 404 while internal shows overall health status](/img/health_endpoint.png) More interestingly you can also go to the `hc` endpoint, this contains more detailed information about the state of the service and therefore needs to be secured.  ![HealthCheck external shows 404 while internal shows detailed health status](/img/hc_endpoint.png) Now you can safely get the status of your services reported as json, but there are 2 further aspects of ASP.NET Core Health Checks, the UI and push-based monitoring, i will cover those in parts 2 and 3.</span><br></span></code></pre></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="Microsoft ASP.NET Core framework" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/aspnet-core">ASP.NET Core</a></li><li class="tag_QGVx"><a rel="tag" title="Application health monitoring" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/health-checks">Health Checks</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/docs/blog/2020/09/08/secure-swagger-on-asp-net-core-by-address-and-port">Secure Swagger on ASP.NET Core by address and port</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2020-09-08T00:00:00.000Z">September 8, 2020</time> · <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/MarkZither.png" alt="Mark Burton"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp" translate="no">Mark Burton</span></a></div><small class="authorTitle_nd0D" title="Software Engineer &amp; Technical Writer">Software Engineer &amp; Technical Writer</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>This follows on from my previous post <a href="/docs/blog/page/2020-09-08-secure-asp-net-core-health-checks-to-a-specific-port">Secure ASP.NET Core Health Checks to a specific port</a> and assumes that you already have your service running over 2 ports and have specified a <code>ManagementPort</code> in the appsettings.json file.</p>
<div><p><strong>Special note if you are using http.sys</strong> If you want to run this over https you will need to take care of the port reservation and certification binding. I have a explanation of that in the GitHub Repo README.</p></div>
<p>Swagger is a powerful tool to test your APIs and allow users to easily discover how to consume your APIs, but it can also open up security issues and make it easier for attackers to access your data.</p>
<p>Best practice is to <a href="https://www.scottbrady91.com/Identity-Server/ASPNET-Core-Swagger-UI-Authorization-using-IdentityServer4" target="_blank" rel="noopener noreferrer">secure access to your Swagger pages using OAuth as described by Scott Brady</a> but in some scenarios it would be better if the Swagger pages are not be accessible externally at all.</p>
<p>As discussed in this <a href="https://github.com/domaindrivendev/Swashbuckle/issues/384" target="_blank" rel="noopener noreferrer">GitHub issue, it is not possible out of the box to limit access to a specific URL</a>.</p>
<p>By changing the SwaggerEndpoint to specify absolute URL it is possible to prevent access to the documentation on the public facing URL.</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">app.UseSwaggerUI(c =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  c.SwaggerEndpoint(&quot;http://localhost:1115/swagger/v1/swagger.json&quot;, &quot;Login Service API V1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  c.RoutePrefix = string.Empty;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span></code></pre></div></div>
<p>However this still leaves the Swagger homepage accessible displaying an error message due to CORS issues.</p>
<p><img decoding="async" loading="lazy" alt="Swagger CORS error" src="/docs/assets/images/swagger_internal_only_error-c73ab3a30e39b310ee56b2bdecf24c3b.png" width="655" height="701" class="img_ev3q"></p>
<p>To reject all requests to Swagger that are not on an internal address we need to create a middleware, <a href="https://github.com/domaindrivendev/Swashbuckle/issues/384#issuecomment-410117400" target="_blank" rel="noopener noreferrer">something like this suggestion by Thwaitesy</a></p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class SwaggerUrlPortAuthMiddleware {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private readonly RequestDelegate next;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public SwaggerUrlPortAuthMiddleware(RequestDelegate next) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    this.next = next;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public async Task InvokeAsync(HttpContext context, IConfiguration configuration) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Make sure we are hitting the swagger path, and not doing it locally and are on the management port</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (context.Request.Path.StartsWithSegments(&quot;/swagger&quot;) &amp;&amp; !configuration.GetValue&lt;int&gt;(&quot;ManagementPort&quot;).Equals(context.Request.Host.Port)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Return unauthorized</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      context.Response.StatusCode = (int)HttpStatusCode.Unauthorized;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      await next.Invoke(context);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public bool IsLocalRequest(HttpContext context) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Handle running using the Microsoft.AspNetCore.TestHost and the site being run entirely locally in memory without an actual TCP/IP connection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (context.Connection.RemoteIpAddress == null &amp;&amp; context.Connection.LocalIpAddress == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (context.Connection.RemoteIpAddress.Equals(context.Connection.LocalIpAddress)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (IPAddress.IsLoopback(context.Connection.RemoteIpAddress)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASoAAADFCAYAAADjX7/MAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAACNhSURBVHhe7Z0LlBTVmce/IS4DAQTBR4y2hbx0FrNs4pDd1ckQ0ESWHGcX427EPiATE8nJSY7TnqzHDGGWMwzo7mbt8REMJu4gnAnuxjBJ+4JV4GTSWY1M1uNuso2MJnTaRxIfEVED6jh7v1u3um9V36ququ6evl3z/c4pqLpVde+tmq5/f9+tqn83zJ+/YBQIgiA0ZoL4nyAIQltIqAiC0B4SKoIgtEebMapr718j5oJxz5U7xBxBEFFFK6G696r7xJI/rrnvKg+haoPeoQ3QIpaQdPdi6EiJBS+aOmBgZxxiYhFy/bB6ZS9kxGIwsB9rIbv6CkjaKnArDwHvbysMVqIugtCQiqZ+s2fPFnO6kIP+1YuhuZlNq/vB6EoyeShB/qIX+7GpO2vAfLFaDYrObkg0icWq42gv0wsrm0mkiOhSMaFatGgR3HvvdrGk5uici+D4jQ/CzJsPwInOR+CN85aKNXYuvviv4Dvf+TafcB7Befn/wGR+BVkwYK6nmDRBYkscst32iz7VkQA/gRhBENWhIkKFIrV167dgypQpokRN49Ub4d2n9sJvbo7DO4//EKavWg+jji6gMK1dew1cf30CvvjFL8Ezhw4XiVQosWpbCi3p7XkBaus9CENDYuoVcVbTZdAaS8N+L1XCiMvabwgjNCvFjEF8p1RXUGz1HoRCNUw8B+RyVXtyhCXmE8n8PgNyqCe1M5DosEdmBKEpZQsVitRdd22FxsZGUeLOpJ5Pw7RH74Cpb7wI0w5sg9GNl0IDvC/WmqBIffObt8Lbb/+RL7/y6qtcsBDn/6URFzNemF0A3dIAVarDSu02QbplbeFizWVhWMw2JXaLi10SATkt7AZoTwxDB9ZhpZnKQTCpH/lJHj/DejGSE/XyNFW02XYdxLObRF9xjC3lrz3jgOhjGmLx61gLiL2dTmi1jeERhK6UJVSWSE2cOFGUeDPzlh8XTX4IH1HJY1RZaJejhzYr4rAPuEOsMB6VSV7B9kVREDTNYcmjLH4srjG8R69MpH7kJ2e9UiSX6YW+dAx41cNZyLVssEdFJWHtbROVpQ6wmkXKi+3k+sFalUluL/SBIDQmtFAFFSmZN77xKTFXTCr1AHztazfABz84mS+fOmtWGRGVRGYvDObExY/pD0ZYXDDWQH/O3MTfOFZa7CcmX7cRy4APlGP0s5mLY9jMkiDqmVBChXf3br/9tlAiVYoHHniIi9VttyV55BQ752xeXpZIIXz8KQdZzOvms7jISvF4Oc4gKdjWDyxicrk7yIWshaV7paIbeczIB6LeZVajTEjbW+xjZRjdrWaKanirqDfYTiwO60Q7TYm1lPoRdUEooTpy5AgsWfLJQlQhTX44uedRMacGxQoFCaennnpalIZBStPk54xSd0M/xGEnlm8xIGtFVAye7nUDdPG0EKcNYPSvF4PwKehYjUq2Q6xjEw9xUrCfpWqFwe2gmPUaXaJO3ldxpzGfoh6EnfEs9JkHELI91k53GlpEO1tgkFI/oi6I8AOfREkwBd5pQF8zPX5B6A29QjOOwUc0uoxynroniLGB/KjGFfhM1g6I58fk8MYARVOE/pBQEQShPWU/8EkQBFFtSKgIgtAeEiqCILSHhIogCO2puVDhqzgEQRBe1Fyo7rzzjpqIVV/fv9kmd/B1GPHEuJiCvSBcLQK+puMXbgNThXoJogxqLlSTJ0+G3t5kVcTKnxD5QXY/2ARZfIUmqm8Hk1sooSFajFH19PRUTaxkKiNa5nt5uZal6heXCYKoOFoI1b59+8dErNrbP8+nsuGWMXa3A7vrJyJSszbZUVPKp7z28eXOOUcUCsLUV+QeimWOlFJZr2o/gqgeWggVgmK1a9d9XKymTZsmSsvDEiaVOFVMtPDCLnL9tK7yGMTbATqxnLsubBYCUGKfwO6cYeozX6dpHVxjrmNTsbWWS71FrqNic4KoEtoIFUZSq1ZdxSOrY8eOidLKIo9ZWSlgeMES3laerp856O8UL/zKrp2l9gnqzhmqPtMf3rSNccGt3lCuowQRHi2ECkUKIykUKYysysEpRFWBX+RZeC5/jftx/WyCuYaY5VTaKbRazqOKesl1lBhjtBCqSomUisqLlpWCCdcBT9fPGLQuF+XyL9z4dgqV8HLnDFWfOc7muU+JeiviOkoQPqi5UI2MjFRNpJDKjEVJ6Q//dWN5XMbN9RNh6aFhRh1Dsrh57uOGlztnmPoykFwpHrUQ+xTv4lKv0nWUIKpHzW1eLrlkWdVEyokzsqrMYLobLPKq1E+2E8Q4h/yoqgYJFUFUCm3u+hEEQbhBERVBENpDERVBENpDQkUQhPaQUBEEoT0kVARBaE/NB9Px9Zmnny7nZ9tL87mPnwTxv10iltS0de4TcwRB6EbNheonPxmEr3zlq1UVq/+46QLIHnkevn7/26LEzu7uT/gQKsePd+Zq+QvD8jNa9LwWEX1qLlT4Gga6JXR0JComVqktl4g5/3gKFXoyCYuV/KszrCwxvxeS+VdpglKOwJBQEeMLLcaogprmHZ1zERy/8UGYefMBONH5CLxx3lKxphqwSGqLQ6SQTDkiRRBEELQQKnzXL4hYNV69Ed59ai/85uY4vPP4D2H6qvUwWq1DkV0P3LC5YMov92K0o3LYxPIN0GK97Mx3MLft7d3NthNOmq71eqB05HTWTQ6dRH2hzV0/FCu/Dp+Tej4N0x69A6a+8SJMO7ANRjdeCg3wvlhbBXJZQI88NUwEJOdNdPI0uiQrXxSjIofNFHQ0b4I0mtqhe2Y+VIuBkV3PtkWXhVL1qsB93J0+83WTQydRZ2gjVEEcPmfe8uOiqarEDLD8MovgLphSxCU7eXJcHDaV5GBwjxhoKlmvghJOn/m6yaGTqDO0EKqwDp9vfONTYq6KOH/IQXt8OH2SQydRZ2ghVNV0+CyfDCT7TMM62wWNd/1wWbhgyr9I095SYkzLD2HqDej0SQ6dRL1Qc6Eqx+Hz5J5HxVyVSSXEGFFhAHpoC8AeLhqmC2Z+HR8jspw8vUjBfpbKFQbTnYSp16fTJzl0EnVGzZ+jqobDZ8WfoyIIoqaQHxVBENqjzV0/giAIN0ioCILQHhIqgiC0h4SKIAjtIaEiCEJ7SKgIgtCecfN4wveuPws+ePpcsWTnxOu/g8/9yzNiiSAI3RgXQnVpE8An/nQabPrRCVFiZ2BTK1z+9cfEkhO0SEFLlgJppzfVWID2LfzpdDLII8YfWgrV7Nmz4ciRI2IpOLtumA2TZ50jlkyuvDkNcPwksWSntFAFcdAMuj1BEKXQbowKnRTuvXe7WFJTyuFz6mnz4Mp/fMI2uYkUQRD6o5VQoUht3fotmDJliihRM6YOn0pMh8y8nxO+5DvQwUqtNNHxsrGH62ax+yeicuAU2+c3CeoqipCzJ1GfaCNUKFJ33bUVGhsbRYk7Y+7wKZvRcaHJQHLlJshyt04mDF0A3fwXaVTOnWy9h+tmsfsno6QDJ9YZ1FWUQc6eRJ2ihVBZIjVx4kRR4o2Xw+f3Oy/g/+O4k9c05eR3+Xb+EMLDL3DLaoWJEhOdLhZBQbeH/UoJ102l+2cpB86wrqLk7EnUKTUXqqAiJaNy+Nz3uLu7ucy3rj5DzI0FPlw3ZarlwEnOnkSdUlOhwrt7t99+WyiRUjE6CvCDJ9/0dVTTz7oALp4nFkIhUj6W6kGXNe6kIKDrpoyrA2eZrqLk7EnUGzUVKnwEYcmSTxYiDWnyg9Phs6EB4OW3/gR+/csnRYk3HasWQ4OvMyCPUeHgdBskBjaA0X83S/lSsK3fgC4+mI44nTt9um7KlHTgDOP+ySBnT6JOieQDn63nNcA/rPXn8jmYfgIW/9k58Pc3/58oIQhCN8jhkyAI7an5YDpBEEQpSKgIgtAeEiqCILSHhIogCO0hoSIIQntIqAiC0J7ICBW+ikMQRDSJjFDdeecdmouVsF8pemvFrTwoWI94Ul1Mer7Lp0k/uU1OJc47MRZERqgmT54Mvb3JqojVR7/0Ebj2/jX5aeHq83g5zsv/l49TtIKKmOTy0J2GFq93EMcM1THIbhSl7GaCngOf8Be0yYW1XojUGFVPT08gsSrlFIqgSH3s0o/Cm79/E5740c/gvx97Ct58+c0ikaqcWFUI2d6FIOqcSAnVvn37A4mVH6dQFKl33noHfnDjXvjlzmfgqW//L2T3vAD3XLmDr3f+Hx6MHGR30KRjGWMjEV20Fdw9Xb2l2pZCS24Q9lgRg9JllCGVDyQ6pOjFGck4lpX1OR1EncfkFt9F2TFVtY2f/QiZSAkVgmK1a9d9XKymTZsmStX4dQp9+TevwHtvviWWTMJFVOKCEx9Qc8ILEXG6gyYUbqEIq6MdoBPTJu7KsFkSE6n+ZQegmbuOIuxiU7qMYnnBKbQTWkVfSuFSX5GDqMrxFJHPAwpNVB1TUZB2QOvgGvs25LQamMgJFUZSq1ZdxSOrY8eOiVI1Xk6hMqedcyqcNNXu4x4uorKPzZgTXohBYHV0CgFSOXti/exCy7UsNS8mxM1lFMtz/WCZgWaS2/31xa0+3w6i8nmIsGNq02XQGksX2+mQ02pgIiVUKFIYSaFIYWTlF5VTKDJhwgR4IfMiTJwyET77z5fxQXQcs5r/2XP5+sqlfWFpgrmGmJVhF1pnv+Ew6wvoMloSRX1j5iBa546pY3aeokOkhCqMSHkxMvIePPZPj3Oxmnr6VPjLv/kLPmZVW2LQulwIkPjGVjl7YnSUtdJCN5dRLI/FYZ24UJoSa6XUbxiyOSmqwDEvMVvKtTScg6hI+ViEWd+Oqew4rLGvzF4YzFX6PI1PIiNUIyMjoUXK6RRq0dAwAd5l6eOeDY/xqMmanhvIwuhoNX71ptgd1L6M5CBrmN/EQ3xcxS1NQudRgPgWHJQ2HUGLXUYx3cLHGMyyLTDIYhWLDCT7CuuGlmEcY+FSn9JBVHUMUurGpug6plpjb4W+8q6S02pgImOcd8klyyoWSekLfltX81eYq10/QYQjMhFV9EWKIMYvkbvrRxBE9CDPdIIgtKcBOodIqAiC0BpK/QiC0B4SKoIgtIeEiiAI7YmMULUYU8UcQRBRIzKD6cf+8aPw19uHIZ19U5RUhsbXszDzlz+AqS8OiRJ3hv/ue2JOxanw0OYZsHv9s3CPKEGuveZC+C5koeHeV0RJOWAbH4Jntv4CboCzYfjLM+ABnH9BrA7LWZWoC/tmwAqxhDw88HP4TKnTamtbOr6ifnitcyNknypNRc5vtIlMRDV14gR4YM28QJHVjGf/E8598Csw//tX8/9nDO8Ra0xQpM7+cQ98ou0Et3GxJjeHT6wnEOwDetOso/DwrA/BrWeJskrxwvMwf33YDz5ewBcU+lRWXTInILn159Cwnk1bfwcLVs6Da8UaVyrWthtSn9jkLVKO81Ipqn6M9U+kxqi+OJD1LVYzDj8CE48ehve+uoM7fI4k+qHxjzk45fBDYgvgkdSFn59TNYfPxYtmABx6CTYeArh8kd1GJvK8cBwOwyRYWOmLnogkkRKq+3/xB99iNfOZlNLhc8ahglBhulc9h88psOp8gAeefgsOPv06wPmnwGKxJv/N3cxSgs0XwiibhldYQua1Tsb57T8Fbr3B3B6nh5rNUkw9rbLRa05lJbgfpkONkPiyXCbVhamKtY9UV367FfPy69R9YzTPgBWHfyuiCGdf5WXnOgmpH8MrJolCga2PVuRm1vXQNRdIZU7M85TvdzM7lhvOZn8b3Nd5Xhge7ajPg+rv4DjGUOdX/fe1o9rGz361J3J3/VCsbvuv33OxmjHpA6K0mA8cP6p0+DzpBBMNB5Vz+JQ46xS4HF6HXXihvvAHeABmwCrbxcguiFaAq0WaBBefK12sXutU4IfxfLj80KGiFOeee620JwsPL8AU9BX4DM5bKVHR2Bm7WL58BhweEPvxFE4WEta301431w0chXkXnykJgrjI8aJYCfCFssbl7P24mp2/wlgTrsMxH9HHAYCb8hd0Iyx4+des3BorlPrEheYtuOHWLBzm/Wb1YD9vfR4Oguq8eLejPA/NZ0Li1axZzqbiVDPk+S1Zr8tnoOR+ehA5ocJI6vqLTueR1evHR0SpmrF3+Cxgpn1/YBcA8hbsYulf4lLxLc1hF8S/4wXCeOF5uOVwI5x3Jl/B8FqnAEVx1lG45WG72HIwYuAXqX1Q2ZWzJsECOAq7rQ+0qm+PCQEaep1d2HJ6Jy5yvCi2Hoeb3CIlP2A/Xv0dbBT9OPjwb1lbAt5HWRSnw7zTJouVJ3gUW0DqU168mCgx0fkuOycwYL/5YaNEO8rz8NJxeHaB4R5phj2/Jet1+QyU2k8TIiVUKFIYSaFIYWTlFzeHz5GpZwRy+PS+6ydzKmy8uJF9G54vROJCeJItw4IZUvQhMwUWzhKzRXitKwGmGBgx8Iv0ECRfFeVjAUaRr5YQ2LI4Ko5LTBW5q6oiYDt84BwjwHP5371iqVbYeqvVnwoTKaEKI1JevPixL7g6fL628LNcmOTJNzg+w6KBj1sfbj6hUEyHK/IflMbCALv4Nsx/y3quU8BFYbqUlgjOnATzXj0O/4PzvB5e6g0fBJf6ycTupgUl2lfB2zsBz7yEC3+EZ2TRwvMjZl3Bfsw6AzaKfixe8aHCPqKPRcfrG5HysVQPvO5MltHOwYd/AR//6QlYcLpj3zLPr71edhxW1Or2GRC49kcTIiNU770/Glqk3Bw+j5+xEH79sQ740b8O86jJmg7tfRvemnW+2Co41y6cDs/m0z4LTP9OwIqFVvp3Ag6fZn7LjfIxCzkF8Vqnwhp3KURw/Jtz6CVIwhnwJJZ9bhIczkdUr8Bulm7YBo3zsLSIj5uY9YzyMZpS7VtIaZLtuSHWv8GjsMKqcyEU0jhXMD0r7PM9wDTIwuwjSMdbfBwWUp/YNLziVLj1BgMW/PQldkyvwMafToLv8sF0xHlegrQjyKfaGEUfV6TjIc9vyXpdPgMl99ODyDzweeUFpwQSKa9nngJFR1UBvwkr+WAjQdQ3ZPOiJSRUBCETubt+BEFED4qoCILQHoqoCILQHvJMJwhCeyiiIghCe0ioCILQnsgI1aJFi8QcQRBRIzJCdeedd2guVvhz6Un2rzW/GxJNfEHCrTwMWNdBGJKmXrPxsaWpAwYqdkzEeCUyQjV58mTo7U1WRazwRWS0cbEmN4fP2qISuRz0r14Mzc3m1JESxUoqKZISmV5Y2XwFJDNimSBCEKkxqp6enkBidXTORXD8xge5w+eJzkfgjfOWijUFUKSq5fBJEIQ/IiVU+/btDyRWKofPUccpqZ7Dpw942qRK3ZogMSCXYzS0AVogBvGdrMw1xzP3G7DCprYkDA10sFKX/W3tO9LWBNtXrMvXV9QvLHNEaq7HFLReJ6pt/OxH1AOREioExWrXrvu4WE2bNk2UqlE5fDbA+2Jtgao4fFqiIC4ic0KxsGAX7s44ZLtF6ra6H4wuccG3XQfx7CYppUtBR/MmSFupXj7Hk9tAoclAcuUmyMavY/Os/i6A7pW9rFS1P7bfCoNW6tgN0J4XDlavcUCUpyHG62MU9YtvLOFxTJyw9aIg7YDWwTX2bUruR9QLkRMqjKRWrbqKR1bHjh0TpWpq6fDpHD8yJxQLQdMcMNjSfuviyvRCXzoGxnw2P5yFXMsGKeJwQ24jweQIYaLERKeLiSJ0W2UKePuS0HWxeIs3jrB6t4k9UwdYLw2Yi10p1S+vY+KErfcyaI2loc85EOb7PBG6EymhQpHCSApFCiMrv7g5fE6YMCGQw+eYwQeoF0MnbOYiUr2UJg3dspCWCkmq1a+w9Y7ZeSKqTaSEKoxIeTEy8p6rw2fVyfwKsiwRXGZdXE0d0N4iRSOMTPIKWN2fA4OHHX4RKR+L3qDLGndSINovpHv+ce2Xj2Pywl4vOw5r7CuzFwZz7n0Nd54InYiMUI2MjIQWKTeHz4aGCfAuSx/3bHiMR03W9NxAFkZHi8eyKgtL0fgYjki9+HiRSNVwEBzL2LQznhUpTwr2szTKPpguj1Hh4HQbJAY2gNF/N9s6Bdv6Dejig+mIc3+zfYjvyO/vPkgvUPZLxuOYvChZrzX2Vugr72rJ/Yh6ITIvJV9yybKKRVIEQegFuScQBKE9kbvrRxBE9CChIghCe0ioCILQHhIqgiC0h4SKIAjtIaEiCEJ7IiNU1fChIghCDyIjVPXl8MmQnpouWKiUCbdQkd0IwmC3RjFtYEohvc5imy+TihwP9kc6HjbV5J2/ihzL+CUyQlVXDp/4oeXv24mXfVdnYW4lLh7+Em4Zbpr8YtoBRp/0InInwPIxu7AdIlfu8eSxO1V4v1tdQaGVqdixjE8iNUYVxDQPqZnD53wDYrksDItF/BAnfb6YWz1YJLXF9IqyXcha9I0Y70RKqPBdvyBiVTOHT/RaisVhi+prm0c1Vppid9Xs7d3NynbDAEvNbOkLppF5p045GnBxuFS1ITydPJ0MbPv5TKGUx4M4+4Z9d7qMOo7HtX2xndIdVIXZdn4b2/kjp1MdiZRQIShW+jt8oqPmGhhsNd/2t31IPVw1jex6Vn4FrOxLQ0veK4XttawF0n29YM8q8MOpcL30akOO8orA/bzcOVW4taXqG54TlUupRan2mbio3EE5sosECg05ndYbkRMqjKTqw+ETLxbrQyrEqoSr5uAeIUUYkbUsNT+87N9lRj9Yxph53FwvvdqIGZA323RS0p1TgVtbbn3zIqw7KEceoyKn03okUkKFIhXGPK+mDp/sQ9rZn5MiJD+umqaXFH6zNyXWgjG41xFNlULRhjCfkwK1ChHQJVRLyOm01kRKqMKIlBdVc/hs65DC/CZY3hpjWRdLugK4amb2DAK0XgfrWl0M4dxcL13bYBEeppRWdGfRxPqKy2HcOd3aKuHIqaRMd9BiRMpHTqd1QWSEqq4cPlO/AiM/ZrKDjx+s5GJjOmD6ctXEDyX7sLdkD7ikLS6ul15tpBL5VDS/bgvAHt6AuV8wd063ttz7VuxSahGmfQspdWMTOZ0Gi791gBw+CYLQHnL4JAhCeyJ3148giOhBQkUQhPaQUBEEoT0kVARBaA8JFUEQ2kNCRRCE9tRcqKrhH0UQRLSouVDVhzOneIJYTKUeTM7jsPLw55appq2X7e+7YQZvu5S7AUHUBzUXqvpw5pTevuevPni8G2aBQiHbg7CpO+vhTsCR3tuSwXfBjDSkjbX+hYe/iEqOkkQ00GKMKojZHVIzZ06Ev1AqW4ioaBJumXahSHX4fTfNTtPyVoDBu2Ebvoe8nEIkYvyhhVDhO3pBxKpmzpxI21JoSW/PCxBPyazUzkrNArtlYoSG0ZTCXZK7KzCd2pMRjgmXSemjiMDaCnUVPIdcojOOyvFRVUYQeqCFUCEoVvo6c8rGaQDdkh9RqsNK7TZBukVKzSS3zKYEWgjj/pZwMBEpco0cVjtcoujBIHDPPO6Y0Ar2oIr1rR2gU6SlEN9cIj2MrgskEV20ESqMpPR15pTHqLLQLkcqeQsNjIYkJLdM9AHiQiaWvV0j7Zhpn2WMlwEMquLr5HCH9a2z11yf8eO6GV0XSCK6aCFUKFJhTO9q4szJzcmEGGD6lv/ZqzXQnzM38TeO5cc1sg3WxWMQk/yFdrJlyNsQO2mCuYaYDUoEXCCJ6KKFUIURKS+q5syJ8IgkB2jIafvZK16OMwiasbHIZ6fL3UG/rpE4Hpbrh9WyoHFBlC2DY4UBdtexMWm8KsIukER0qbkf1c9+9gR0dnYGEilVqvfaTUvEnAk6cKJDpwxGWihiznJvrEFuC0wDrbt55ngPBjmQS7MYyYBsp3SnD9NCltZZ5PrXCCdPBn98Ic5kRpDexKMqHJznu7DlbtgA7VlpHwGOee00trPtmcgPrcXgDFpazJrS+d/lw36vhSzvqzxvrSscE98H5L5itBfuDiVBVIOaCxU5c5aDU4AIIprUPPUjkSIIohRajFERBEF4QZ7pBEFoD0VUBEFoDwkVQRDaQ0JFEIT2kFARBKE9NReqavhQEQQRLWouVOTw6QW27bRqUZVZKNaV3QeCqD01Fypy+JTxEqEQhOpDNanw8RHjBi3GqMjhsxro0AeCqAxaCBW+RkMOnxhtqBw+vTAjlN5eNOZzRHmh+oCIqCdh+WzJrqEMj33kfhSfF5fjs9Unp9Uex8ZROZKqyogooIVQIShW5PCpcPgsSQyM7HpWjyJSCtwHq/PseI0DojwNsfh1Qii895H7UXxeUorjw/ow6hPb8rRaTg3djs10rSCX0vGDNkKFkRQ5fIYhx/3UlYTuAzvebeIqTx1g+4hUt8Q+tn64nRcZXp8U9RU5lLocm4gWyaV0/KCFUKFIhTHPi77D5zBkrTot+MWdhedctClPxfrgxMc+buel2pBLaWTRQqjCiJQXkXH4hAw8l2URzJbCIwVt6+IQSx/wMSBeqT5I+N3H9bw4EPXl3UqZwLW3uI2rmWNWvGlyKR131FyoRkZGQovUyT2Pijk76OD5Lksf92x4jEdN1vTcQJY7fwZHSnf4GI24k5a6G/ohDjuxfAuLc6TIgada3QBdPP0xUyCjf70YhE9BB//FmIIXujm4nIL9LPXhbYlwINXBIhKrDTZ1Gf2w2ufgS7g+eOFzH9fz4jw+sz6jS9TFz62fu5IZSK7cBFmpH7y6fLqJ3vLZ4tSQqFvI4ZMgCO0hPyqCILRHm7t+BEEQbpBQEQShPSRUBEFoDwkVQRDaQ0JFEIT2kFARBKE9NReqavhQEQQRLWouVPo7fAqkp55xqtmLr9wWRXYYKAe7LcrYun9Kr8TY5v3i3J/13+XJetM5Qmzref68+lFuf4lyqLlQ1YXDJ4pUl1FwUGheA4OtO8ZIrBwXBX/x1m6GFwp+we4Ao886JjZ1Aiwv9RaNtuQgZ0g2O3naYF1cetmwUuePGFO0GKMKYpqHjK3DJ4s62lsgbXPKzECyE995s3ya6g12TNz90+HZxC7ipL/XCLUkmwVoXe5QKm50mIa8vQ1Rl2ghVPiuXxCxGlOHTzenTP4Gv2WjIqKeNoxSFKkhj16sFKtcV0xHhGWru9ghU+nU6XZMEkrnUq86OS4Om8rj98Bte6l8IDFHFBbIbtsOWduXB37JsEh42wGxjLifv6I6S7SXR9FfPH9Ffwu5TbHS6zzb3E0VbRSjOv8uf5M6QwuhQlCstHX4lJwy7cgmb0xM2gE6MYXiDgObxQeTfegq6oopg3V7O2SqnToZrsdk4upc6lonXhAK103P41fhtr39WDuhlQm4E3RnkG1jmCDDILj5CnrX6ac9RN3f1P40tFgdYVGdkStEe03LW5mqmmff6zwXPhtu50TG5fxHxPVUG6HCSEpbh0/JKdOO8KXiMDHp7GVJIUN2qqy0K6aMD4dMpVMn4npMAte+uLl/mlFakbWK5/ErcNsey3P9YDWdSW5XpnOpbUys282bAujdle0TfxMVXnX6bM+1v+g2aswx+7HMgMG+QaZUl7HlJkCdyv/dPc5zfhu3NmTczn9EXE+1ECoUqTDmeWPi8ClM2vLf0hb8g+HmtNkEcw0xy9HMFdPtmCwq3pegTqJhnEcFeGws+lnO0vB2oyA01UXRX6sfTW2wzGBRXQqX2ZeDHOUFOs8hzwm/eVD/rqdaCFUYkfKisg6fGUj2sTDe9lt+ZloA/XdLJm+xwkCu+HbjkU6lXTFlAjlkyljH5Pjgsv0TuByqL6b4FR1nUCdRt+2xPBaHdaK/TYm1jgjEAo8tC/Eu9vcZ3OseTSFedfptz/X4MrAHg6gta8Hg/cBlA5atY99gVr8COqEWt8E+h9bYl9v5F9S762nNhaouHD5TCT4uIDtlQvdiWGkLs1kaaJjfWkN8bMNyqqy0K6ZMWIdMBh6TvC9vF9g3P65zdy51x8V10+/x53HbnpV3m+KKZVtYVOJ6Jw/7n1OkQUV41em3Pffjy6BSMfGxUjhcNlpYGmildL7Ps3sbBVzOv/T8Xz27npLDZ0XAb7a1kLUsigmCqCgNS5Z8etw5fL744hExR+jAhz88W8wRhJqGj3zkz8eVUM2ceToJlWagUL322u/FEkE4Afh/GXOEXa9mTpMAAAAASUVORK5CYII=" width="298" height="197" class="img_ev3q"></p>
<p>Assuming your <a href="https://github.com/loic-sharma/BaGet" target="_blank" rel="noopener noreferrer">project layout is something like BaGet</a>.</p>
<p>The middleware should be added to your shared project in the <code>Extensions</code> directory.</p>
<p>Add the following extension method to <code>IApplicationBuilderExtensions</code> to add the middleware and keep your startup clean.</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public static class SwaggerAuthorizeExtensions {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public static IApplicationBuilder UseSwaggerAuthorized(this IApplicationBuilder builder) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return builder.UseMiddleware&lt;SwaggerUrlPortAuthMiddleware&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>This middleware must be registered before swagger, so in startup.cs change <code>Configure</code> to add the middleware by calling the new extension method.</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public void Configure(IApplicationBuilder app, IWebHostEnvironment env) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  app.UseSwaggerAuthorized();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  app.UseSwagger();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  app.UseSwaggerUI(c =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c.SwaggerEndpoint(&quot;/v1/swagger.json&quot;, &quot;Login Service API V1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Now running the service will return a 401 on the public facing URL and serve swagger internally.</p>
<p><img decoding="async" loading="lazy" alt="Public facing swagger returns 401 internal works" src="/docs/assets/images/swagger_secured_by_port-ba9cbcb5068f1876f9a6e30316589036.png" width="1171" height="686" class="img_ev3q"></p>
<p>It is still recommended to secure swagger with OAuth as a misconfiguration could still lead to your Swagger being exposed this way, for example behind a reverse proxy.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="Microsoft ASP.NET Core framework" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/aspnet-core">ASP.NET Core</a></li><li class="tag_QGVx"><a rel="tag" title="API documentation with Swagger" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/swagger">Swagger</a></li><li class="tag_QGVx"><a rel="tag" title="Swagger tools for .NET" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/swashbuckle">Swashbuckle</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/docs/blog/VSTO-installs-over-HTTPS-issues">VSTO installs over HTTPS issues</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2019-02-25T00:00:00.000Z">February 25, 2019</time> · <!-- -->One min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/MarkZither.png" alt="Mark Burton"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp" translate="no">Mark Burton</span></a></div><small class="authorTitle_nd0D" title="Software Engineer &amp; Technical Writer">Software Engineer &amp; Technical Writer</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>Test with this <a href="/docs/blog/page/assetstestvstosetup.exe">setup.exe</a>.  ## The Problem
Setup runs sucessfully over http, but switch to https by publishing again with the https url or by using <code>setup.exe -url=&quot;https:/myurl.comMyAppFoldersetup.exe&quot;</code></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">URLDownloadToCacheFile failed with HRESULT &#x27;-2146697208&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Error: An error occurred trying to download &#x27;https:/myurl.comMyAppFoldersetup.exe&#x27;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```  ## Other Examples</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https:/stackoverflow.comquestions20244507download-clickonce-fails-from-setup-exe  ## Solution  As explained on technet [https:/social.technet.microsoft.comForumsieen-US3d443283-c251-44b8-99ab-7ee33c928eeegroup-policy-setting-blocking-downloads-from-https-even-on-trusted-sites?forum=ieitprocurrentver](Check the GPO) the GPO was under:  User Configuration\Policies\Administrative Templates\Windows Components\Internet Explorer\Internet Control Panel\Security Pages\Advanced Page\Do not save encrypted pages to disk  or  User Configuration\Policies\Administrative Templates\Windows Components\Internet Explorer\Internet Control Panel\Advanced Page\Do not save encrypted pages to disk  ![Group Policy Management Editor](/img/GPOIE.png)  By default this value is not configured</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">![Do Not Save Encrypted File To Disc Dialog](/img/DoNotSaveEncryptedFileToDiscDialog.png)  In Internet Explorer the associated configuration option is found in Internet Options on the Advanced tab.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">![Do Not Save Encrypted File To Disc Dialog](/img/IEOptions.png)  </span><br></span></code></pre></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="Visual Studio Tools for Office" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/vsto">VSTO</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/https">HTTPS</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/gpo">GPO</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/ie-security">IE Security</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part 2">Using Netlify Identity with NetlifyCMS and Wyam</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2019-02-15T00:00:00.000Z">February 15, 2019</time> · <!-- -->One min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/MarkZither.png" alt="Mark Burton"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp" translate="no">Mark Burton</span></a></div><small class="authorTitle_nd0D" title="Software Engineer &amp; Technical Writer">Software Engineer &amp; Technical Writer</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">build_script:  - ..\Wyam\wyam --output ..\output -s LinkRoot=&quot;BigDoorWyamBlog&quot; # https:/noknokmls.github.ioBigDoorWyamBlogposts2018-02-12-where-i-live-john-naughton-krakow-rzaska.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```  # Setup your Netlify site to use  Now we have AppVeyor building the site and pushing the output back to GitHub we can configure the deploy settings in Netlify so that changes are automatically published to your blog.</span><br></span></code></pre></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="Static site generator" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/wyam">Wyam</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/app-veyor">AppVeyor</a></li><li class="tag_QGVx"><a rel="tag" title="NetlifyCMS headless CMS" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/netlify-cms">NetlifyCMS</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/netlify">Netlify</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-3">Setting up NetlifyCMS with Wyam, Part 3</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2018-03-09T00:00:00.000Z">March 9, 2018</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/MarkZither.png" alt="Mark Burton"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/MarkZither" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp" translate="no">Mark Burton</span></a></div><small class="authorTitle_nd0D" title="Software Engineer &amp; Technical Writer">Software Engineer &amp; Technical Writer</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="use-appveyor-for-ci">Use AppVeyor for CI<a href="#use-appveyor-for-ci" class="hash-link" aria-label="Direct link to Use AppVeyor for CI" title="Direct link to Use AppVeyor for CI" translate="no">​</a></h2>
<p>To get started with a simple NetlifyCMS setup without the editorial workflow you can use the <a href="https:/wyam.iodocsdeploymentappveyor" target="_blank" rel="noopener noreferrer">AppVeyor for Continuous Integration</a> Wyam document.  # Enabling the editorial workflow  ## Turn off webhook for PR to prevent extra build being triggered in AppVeyor
For more details see <a href="https:/github.comappveyorciissues1636" target="_blank" rel="noopener noreferrer">Do not build virtual merge on Pull Requests #1636</a> and <a href="http:/help.appveyor.comdiscussionsquestions5082-preventing-master-ci-run-when-a-commit-a-made-on-a-feature-branch" target="_blank" rel="noopener noreferrer">Preventing master CI run when a commit a made on a feature branch</a>
<img decoding="async" loading="lazy" src="/docs/assets/images/NetlifyCMS_Webhooks-a0567cc0554cad5679b50dcd86ac2f74.PNG" width="1005" height="313" class="img_ev3q"> If this is not done AppVeyor will run the master branch config when a draft is saved in NetlifyCMS as a PR is created, it will fail with</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git push</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">remote: Anonymous access to MarkZitherProjectName.git denied.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fatal: Authentication failed for &#x27;https:/github.comMarkZitherProjectName.git&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Command exited with code 128</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```  ## Advanced AppVeyor config to support Editorial_Workflow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">When a blog post is saved as a draft it will create a branch starting with &#x27;cms&#x27;, use the for branches with a regular expression to control different aspects of the build on master and cms branches, here is [an example of this in action](https:/github.comNokNokMLSBigDoorWyamBlogblobmasterappveyor.yml)</span><br></span></code></pre></div></div>
<p>for:  # override settings for <code>master</code> branch</p>
<ul>
<li>version: 1.0. branches:  only:  - master  #######################  # removed for brevity #  #######################  # override settings for <code>cms*</code> branches</li>
<li>branches:  only:  - /cms.*/  deploy:</li>
</ul>
<pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar language-## codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"></code></pre>
<p>git push
remote: Anonymous access to MarkZitherProjectName.git denied.
fatal: Authentication failed for &#x27;https:/github.comMarkZitherProjectName.git&#x27;
Command exited with code 128</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">This is caused by the PR firing a Webhook which triggers the build on the master branch.  ## Other things to write about</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* show the correct loggedlogged out menu based on [Netlify Identity Widget](https:/github.comnetlifynetlify-identity-widget) events and user object.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* how to populate the author field from the Netlify Identity metadata.</span><br></span></code></pre></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="Static site generator" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/wyam">Wyam</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/app-veyor">AppVeyor</a></li><li class="tag_QGVx"><a rel="tag" title="NetlifyCMS headless CMS" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/netlify-cms">NetlifyCMS</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs/blog/tags/netlify">Netlify</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/blog/page/4"><div class="pagination-nav__label">Newer entries</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/blog/page/6"><div class="pagination-nav__label">Older entries</div></a></nav></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/MarkZither/mywyamblog" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Mark Burton. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>