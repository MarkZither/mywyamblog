"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7611],{7183:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/NetlifyCMS_Webhooks-a0567cc0554cad5679b50dcd86ac2f74.PNG"},8473:e=>{e.exports=JSON.parse('{"permalink":"/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-3","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-3.md","source":"@site/blog/Setting-up-NetlifyCMS-with-Wyam---Part-3.md","title":"Setting up NetlifyCMS with Wyam, Part 3","description":"Configuring a simple single user mode NetlifyCMS with Wyam","date":"2018-03-09T00:00:00.000Z","tags":[{"inline":false,"label":"Wyam","permalink":"/docs/blog/tags/wyam","description":"Static site generator"},{"inline":true,"label":"AppVeyor","permalink":"/docs/blog/tags/app-veyor"},{"inline":false,"label":"NetlifyCMS","permalink":"/docs/blog/tags/netlify-cms","description":"NetlifyCMS headless CMS"},{"inline":true,"label":"Netlify","permalink":"/docs/blog/tags/netlify"}],"readingTime":1.75,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Setting up NetlifyCMS with Wyam, Part 3","authors":["mark-burton"],"date":"2018-03-09","tags":["Wyam","AppVeyor","NetlifyCMS","Netlify"],"description":"Configuring a simple single user mode NetlifyCMS with Wyam"},"unlisted":false,"prevItem":{"title":"Using Netlify Identity with NetlifyCMS and Wyam","permalink":"/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part 2"},"nextItem":{"title":"Using Netlify Identity with NetlifyCMS and Wyam","permalink":"/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-4"}}')},26653:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>c});var n=i(8473),o=i(74848),r=i(28453);const a={title:"Setting up NetlifyCMS with Wyam, Part 3",authors:["mark-burton"],date:"2018-03-09",tags:["Wyam","AppVeyor","NetlifyCMS","Netlify"],description:"Configuring a simple single user mode NetlifyCMS with Wyam"},s=void 0,l={authorsImageUrls:[void 0]},c=[{value:"Use AppVeyor for CI",id:"use-appveyor-for-ci",level:2}];function d(e){const t={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h2,{id:"use-appveyor-for-ci",children:"Use AppVeyor for CI"}),"\n",(0,o.jsxs)(t.p,{children:["To get started with a simple NetlifyCMS setup without the editorial workflow you can use the ",(0,o.jsx)(t.a,{href:"https:/wyam.iodocsdeploymentappveyor",children:"AppVeyor for Continuous Integration"})," Wyam document.  # Enabling the editorial workflow  ## Turn off webhook for PR to prevent extra build being triggered in AppVeyor\nFor more details see ",(0,o.jsx)(t.a,{href:"https:/github.comappveyorciissues1636",children:"Do not build virtual merge on Pull Requests #1636"})," and ",(0,o.jsx)(t.a,{href:"http:/help.appveyor.comdiscussionsquestions5082-preventing-master-ci-run-when-a-commit-a-made-on-a-feature-branch",children:"Preventing master CI run when a commit a made on a feature branch"}),"\n",(0,o.jsx)(t.img,{src:i(7183).A+"",width:"1005",height:"313"})," If this is not done AppVeyor will run the master branch config when a draft is saved in NetlifyCMS as a PR is created, it will fail with"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"git push\nremote: Anonymous access to MarkZitherProjectName.git denied.\nfatal: Authentication failed for 'https:/github.comMarkZitherProjectName.git'\nCommand exited with code 128\n```  ## Advanced AppVeyor config to support Editorial_Workflow\nWhen a blog post is saved as a draft it will create a branch starting with 'cms', use the for branches with a regular expression to control different aspects of the build on master and cms branches, here is [an example of this in action](https:/github.comNokNokMLSBigDoorWyamBlogblobmasterappveyor.yml)\n"})}),"\n",(0,o.jsxs)(t.p,{children:["for:  # override settings for ",(0,o.jsx)(t.code,{children:"master"})," branch"]}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["version: 1.0. branches:  only:  - master  #######################  # removed for brevity #  #######################  # override settings for ",(0,o.jsx)(t.code,{children:"cms*"})," branches"]}),"\n",(0,o.jsx)(t.li,{children:"branches:  only:  - /cms.*/  deploy:"}),"\n"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-##",metastring:"Errors and issues i hit while setting this up  ### [the build phase is set to msbuild mode default but no visual studio project or solution files were found](https:/help.appveyor.comdiscussionsproblems11287-the-build-phase-is-set-to-msbuild-mode-default-but-no-visual-studio-project-or-solution-files-were-found)  caused by having version: 1.0. in wrong place in appveyor.yml  ### Failed build after saving a post"})}),"\n",(0,o.jsx)(t.p,{children:"git push\nremote: Anonymous access to MarkZitherProjectName.git denied.\nfatal: Authentication failed for 'https:/github.comMarkZitherProjectName.git'\nCommand exited with code 128"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"This is caused by the PR firing a Webhook which triggers the build on the master branch.  ## Other things to write about\n* show the correct loggedlogged out menu based on [Netlify Identity Widget](https:/github.comnetlifynetlify-identity-widget) events and user object.\n* how to populate the author field from the Netlify Identity metadata.\n"})})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453:(e,t,i)=>{i.d(t,{R:()=>a,x:()=>s});var n=i(96540);const o={},r=n.createContext(o);function a(e){const t=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);