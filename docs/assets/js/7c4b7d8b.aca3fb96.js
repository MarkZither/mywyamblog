"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7892],{2446:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/NetlifyCMS_Main-9b8a8c221132157f5149e797cca36ccb.PNG"},3354:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/NetlifyCMS_Login-70a03aa7ba810cbd4d4642e7a686682d.PNG"},16695:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>d});var n=i(63787),s=i(74848),a=i(28453);const o={title:"Setting up NetlifyCMS with Wyam, Part 1",authors:["mark-burton"],date:"2018-02-09",tags:["Wyam","AppVeyor","NetlifyCMS","Netlify"],description:"Configuring a simple single user mode NetlifyCMS with Wyam"},r="Setting up NetlifyCMS with Wyam  Despite the length of this series of blog posts NetlifyCMS is actually really easy to setup. It just involves configuration across a few different tools to get it all working in an automated fashion, from publishing a post in the CMS, thereby the file being pushed to GitHub, to automatically building and publishing your site, in this instance to Netlify. I was not familiar with all these tools when i started so please leave a comment if there are improvements that can be made.  Lets start with what Wyam and NetlifyCMS are;",l={authorsImageUrls:[void 0]},d=[{value:"Add an admin directory under your Wyam input directory",id:"add-an-admin-directory-under-your-wyam-input-directory",level:3},{value:"Local Testing",id:"local-testing",level:2}];function c(e){const t={a:"a",blockquote:"blockquote",code:"code",div:"div",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components},{Head:n}=t;return n||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Head",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:['""Wyam is different.\nIt\'s a static content toolkit and can be used to generate web sites, produce documentation, create ebooks, and much more. Since everything is configured by chaining together flexible modules (that you can even write yourself), the only limits to what it can create are your imagination.""--',(0,s.jsx)("cite",{}),"\n",(0,s.jsx)(t.a,{href:"https:/wyam.io",children:"wyam.io"}),(0,s.jsx)("cite",{}),'  > ""Netlify CMS is an open source content management system for your Git workflow that enables you to provide editors with friendly UI and intuitive workflow. You can use it with any static site generator to create faster, more flexible web projects.""\n--<cite>\n',(0,s.jsx)(t.a,{href:"https:/www.netlifycms.orgdocsintro",children:"NetlifyCMS"}),(0,s.jsx)("cite",{}),"  ## Now onto the steps I went through to setup NetlifyCMS for my blog.  This information is what worked for me and makes some assumptions"]}),"\n"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Your code is in a GitHub repository"}),"\n",(0,s.jsx)(t.li,{children:"Your site is hosted on Netlify"}),"\n",(0,s.jsx)(t.li,{children:"You are using AppVeyor for continuous deployment"}),"\n",(0,s.jsx)(t.li,{children:"You are the only editor of your blog (Part 2 will deal with adding users and Netlify Identify features to the blog)"}),"\n",(0,s.jsx)(t.li,{children:"You know that your CMS will be accessed at by manually adding admin to your site URL"}),"\n",(0,s.jsx)(t.li,{children:"You are happy pushing your changes directly to master (Part 3 will explain the editorial workflow, which saves drafts to feature branches, creates a PR and merges once the post is published)  ## Changes in your Wyam project"}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"add-an-admin-directory-under-your-wyam-input-directory",children:"Add an admin directory under your Wyam input directory"}),"\n",(0,s.jsxs)(t.p,{children:["The general instructions to ",(0,s.jsx)(t.a,{href:"https:/www.netlifycms.orgdocsadd-to-your-site",children:"add NetlifyCMS to your site"})," cover several static site generators but not Wyam (I have a PR in to add it to the table for App File Structure).  Assuming you are using the default Wyam input directory name and structure the setup is;  * add a folder called ",(0,s.jsx)(t.code,{children:"admin"})," under your Wyam ",(0,s.jsx)(t.code,{children:"input"})," directory  * add 2 files to it, ",(0,s.jsx)(t.code,{children:"index.html"})," and ",(0,s.jsx)(t.code,{children:"config.yml"}),".  In the ",(0,s.jsx)(t.code,{children:"index.html"})," add the following,  ```html"]}),"\n",(0,s.jsx)(n,{children:(0,s.jsx)("link",{rel:"stylesheet",href:"https://unpkg.com/netlify-cms@^1.0.0/dist/cms.css"})}),"\n",(0,s.jsxs)("body",{children:[(0,s.jsx)("script",{src:"https://unpkg.com/netlify-cms@^1.0.0/dist/cms.js"}),(0,s.jsx)("script",{src:"https://identity.netlify.com/v1/netlify-identity-widget.js"})]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-**note**",metastring:"i also added the Netlify Identity script since we will be using that, which is not in the Netlify instructions at this point, you could also use [Netlify\u2019s Script Injection](https:/www.netlify.comdocsinject-analytics-snippets) feature to achieve the same.  The second file, adminconfig.yml, is the heart of your Netlify CMS installation, and a bit more complex. It is explained in full in the [add NetlifyCMS to your site](https:/www.netlifycms.orgdocsadd-to-your-site) and [configuration options](https:/www.netlifycms.orgdocsconfiguration-options) documentation and I have added a working version below.  ### Example NetlifyCMS config file",children:'\n```yaml\nbackend:\n  name: git-gateway\n  branch: master # Branch to update (optional; defaults to master)\n\nmedia_folder: "input/assets/Images" # Media files will be stored in the repo under input/assets/Images\npublic_folder: "/assets/Images" # public_folder indicates where they can be found in the published site\n\ncollections:\n  - name: "blog" # Used in routes, e.g., /admin/collections/blog\n    label: "Blog" # Used in the UI\n    folder: "input/posts" # The path to the folder where the documents are stored\n    create: true # Allow users to create new documents in this collection\n    slug: "{{year}}-{{month}}-{{day}}-{{slug}}" # Filename template, e.g., YYYY-MM-DD-title.md\n    fields: # The fields for each document, usually in front matter\n      - {label: "Title", name: "Title", widget: "string"}\n      - {label: "Lead", name: "Lead", widget: "string", optional: true, required: false}\n      - {label: "Published", name: "Published", widget: "datetime"}\n      - {label: "Featured Image", name: "Image", widget: "image", optional: true, required: false, pattern: [\'^\\S*$\', "Please rename your image remove any spaces from the filename"]}\n      - label: Tags\n        name: Tags\n        widget: list\n      - {label: "Body", name: "body", widget: "markdown"}\n'})}),"\n",(0,s.jsxs)(t.div,{children:[(0,s.jsxs)(t.p,{children:["::: A couple of things to note here are;\nIt is using git-gateway as the backend, if you don't intend on having additional editors for your blog you could connect directly to GitHub as described in ",(0,s.jsx)(t.a,{href:"https:/www.netlifycms.orgdocsauthentication-backends",children:"authentication and backends"})," and ",(0,s.jsx)(t.a,{href:"https:/www.netlify.comdocsauthentication-providers#using-an-authentication-provider",children:"Using an Authentication Provider"}),", but it looks to be more work for less functionality.  The Tags field, in the CMS it will display as a simple textbox, but you add your tags as a comma separated list. I tried to get the list to add and item for each tag i wanted to add, but hit some JavaScript errors which prevented me typing more than 1 character per tag.  The Featured Image (and media upload screen) will happily accept a filename with spaces in it, which markdownhtml will then fail to render as it doesn't get escaped to %20. The field can have validation added to it like ",(0,s.jsx)(t.code,{children:"pattern: ['^\\S*$', \"Please rename your image remove any spaces from the filename\"]"})," not very user friendly, but better than the image just not working.\n:::\n::: ",(0,s.jsx)(t.img,{src:i(38735).A+"",width:"822",height:"629"})," :::\n::::::  ## Setup your blog on Netlify\nThe Wyam website already has a guide on ",(0,s.jsx)(t.a,{href:"https:/wyam.iodocsdeploymentnetlify",children:"setting up a site on Netlify"})," to get started you can just drag and drop your site as described, in Part 3 we will setup the continuous deployment from GitHub.  ### Enable Netlify Identity\nAs the config states is setup with ",(0,s.jsx)(t.code,{children:"backend:  name:git-gateway"})," we will be using Netlify Identity.\n",(0,s.jsx)(t.img,{src:i(89178).A+"",width:"687",height:"547"})," ### Set registration preference and external providers\nRegistration settings and External providers are in settings under Identity.  ",(0,s.jsx)(t.img,{src:i(43409).A+"",width:"747",height:"367"})," At this stage I only want access myself, so I have made it invite only and enabled GitHub as the sole external provider.\n",(0,s.jsx)(t.img,{src:i(72818).A+"",width:"1034",height:"577"})," ### Enable Git Gateway in Netlify"]}),(0,s.jsxs)(t.div,{children:[(0,s.jsxs)(t.p,{children:["::: Your CMS users are likely to not have GitHub logins. Enable the Git Gateway to allow them to save and publish posts to GitHub without having to setup an account on Github, this is also required as we set the backend to git-gateway. Without it you will get errors in the console when you try to save media or posts.\nIt is explained further in the ",(0,s.jsx)(t.a,{href:"https:/www.netlify.comdocsgit-gateway",children:"Netlify Docs on Git Gateway"}),"\nThe Git Gateway option is in settings under Identity, further down than the Registration preferences and external providers settings.  :::\n::: ",(0,s.jsx)(t.img,{src:i(23165).A+"",width:"1275",height:"496"})," :::\n::::::  ### NetlifyCMS in action"]}),(0,s.jsxs)(t.div,{children:[(0,s.jsxs)(t.p,{children:["::: At this point you should have a working CMS, run ",(0,s.jsx)(t.code,{children:"wyam -p 5080 -w"})," - ",(0,s.jsx)(t.a,{href:"https:/wyam.iodocsusagecommand-line",children:"here is more information on the wyam command line"})," - then navigate to http:/localhost:5080admin, you should be greeted with the NetlifyCMS screen.\n:::\n::: ",(0,s.jsx)(t.img,{src:i(91224).A+"",width:"529",height:"325"})," :::\n::::::  ::::::row\n::: Click Login with Netlify and login with your GitHub account, you might be redirected here to your site on Netlify, just correct the first part of the URL to ",(0,s.jsx)(t.code,{children:"https:/localhost:5080admin"})," and be sure to keep the ",(0,s.jsx)(t.code,{children:"#access_token=eyj...lkdAGI&expires_in=3600&refresh_token=zEM...BQSw&token_type=bearer"})," in the URL, this should log you in to your local instance.\n:::\n::: ",(0,s.jsx)(t.img,{src:i(3354).A+"",width:"544",height:"597"})," :::\n::::::  Finally we have NetlifyCMS in all its glory  ",(0,s.jsx)(t.img,{src:i(2446).A+"",width:"1024",height:"510"})," Create a new post and publish it  ",(0,s.jsx)(t.img,{src:i(46075).A+"",width:"1024",height:"520"})," ## NetlifyCMS successfully publishing to GitHub"]}),(0,s.jsxs)(t.div,{children:[(0,s.jsxs)(t.p,{children:["::: you should see a commit in GitHub  ",(0,s.jsx)(t.img,{src:i(24481).A+"",width:"1013",height:"348"})," :::\n::: and the markdown as rendered in GitHub  ",(0,s.jsx)(t.img,{src:i(85242).A+"",width:"981",height:"334"})," :::\n::::::  This is all well and good, but you could have done that in VS Code or similar, in Parts 2 and 3 I will describe how I configured AppVeyor and Netlify to support continuous deployment, the editorial workflow and adding the Netlify Identity widget to my blog to make this a fully functioning CMS.  ## Errors and issues I encountered while setting this up"]}),(0,s.jsx)(t.h2,{id:"local-testing",children:"Local Testing"}),(0,s.jsx)(t.div,{children:(0,s.jsxs)(t.p,{children:["::: If you are testing your site locally you can still use the Netlify Identity. You just need to specify the URL of your site on Netlify. This is explained in full in the ",(0,s.jsx)(t.a,{href:"https:/github.comnetlifynetlify-identity-widget#localhost",children:"netlify identity widget docs"}),".  It does however seem to have a side effect of redirecting to your hosted site after login if you use the external provider, logging in with a Netlify Identity account works and leaves you on the same page, alternatively just correct the first part of the URL to https:/localhost:5080admin/ and be sure to keep the #access_token=eyj...lkdAGI&expires_in=3600&refresh_token=zEM...BQSw&token_type=bearer in the URL, this should log you in to your local instance. Sometimes it needs a refresh to load the actual CMS.\n:::\n::: ",(0,s.jsx)(t.img,{src:i(55895).A+"",width:"384",height:"342"})," :::\n::::::  ### Front Matter syntax\nInitially i found that none of my existing posts were displaying any details at all in the CMS, it just showed up as a blank line, ",(0,s.jsx)(t.img,{src:i(22913).A+"",width:"1021",height:"394"})," you can click on the blank line and it will open a blank editor window ",(0,s.jsx)(t.img,{src:i(83739).A+"",width:"1354",height:"634"})," .\nAny new posts created by the CMS did display correctly.  The only difference i found between the existing posts and those created in NetlifyCMS was the leading ",(0,s.jsx)(t.code,{children:"---"})," to start the front matter section. Once i added that in all posts displayed correctly in the CMS."]})})]})]})]})]})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},22913:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/NetlifyCMS_Missing_Posts-371fbc67d9f190598a6cabe422f09105.PNG"},23165:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/Netlify_Git_Gateway-a65624930785380496f144ece7ee1cbd.PNG"},24481:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/NetlifyCMS_Published_GitHub-fed1ffef78de6dfb23e7fb10b8a5db8e.PNG"},28453:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>r});var n=i(96540);const s={},a=n.createContext(s);function o(e){const t=n.useContext(a);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(a.Provider,{value:t},e.children)}},38735:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/NetlifyCMS_Validation-d89c3b727bcdb10d71aa82bd11363dab.PNG"},43409:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/Netlify_Site_Settings-cb5cd6c5ba870486799f05ebf106f887.PNG"},46075:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/NetlifyCMS_Publish_New-1b490bf4cb9f9037d1453e17051b9dfd.PNG"},55895:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/Netlify_Identity_Local_Testing-6038b83f03ebc219e7c03410fbdbeb2f.PNG"},63787:e=>{e.exports=JSON.parse('{"permalink":"/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-1","editUrl":"https://github.com/MarkZither/mywyamblog/tree/main/docs/blog/Setting-up-NetlifyCMS-with-Wyam---Part-1.md","source":"@site/blog/Setting-up-NetlifyCMS-with-Wyam---Part-1.md","title":"Setting up NetlifyCMS with Wyam, Part 1","description":"Configuring a simple single user mode NetlifyCMS with Wyam","date":"2018-02-09T00:00:00.000Z","tags":[{"inline":false,"label":"Wyam","permalink":"/docs/blog/tags/wyam","description":"Static site generator"},{"inline":true,"label":"AppVeyor","permalink":"/docs/blog/tags/app-veyor"},{"inline":false,"label":"NetlifyCMS","permalink":"/docs/blog/tags/netlify-cms","description":"NetlifyCMS headless CMS"},{"inline":true,"label":"Netlify","permalink":"/docs/blog/tags/netlify"}],"readingTime":7.32,"hasTruncateMarker":false,"authors":[{"name":"Mark Burton","title":"Software Engineer & Technical Writer","url":"https://github.com/MarkZither","imageURL":"https://github.com/MarkZither.png","key":"mark-burton","page":null}],"frontMatter":{"title":"Setting up NetlifyCMS with Wyam, Part 1","authors":["mark-burton"],"date":"2018-02-09","tags":["Wyam","AppVeyor","NetlifyCMS","Netlify"],"description":"Configuring a simple single user mode NetlifyCMS with Wyam"},"unlisted":false,"prevItem":{"title":"Test blog post for docs","permalink":"/docs/blog/2018/02/11/test-blog-post-for-docs"},"nextItem":{"title":"How to fork a cloned repository in Visual Studio","permalink":"/docs/blog/Fork a cloned git repository"}}')},72818:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/Netlify_Identity_Reg_pref_providers-4fc5ba856203c95db114bd1642f604cc.PNG"},83739:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/NetlifyCMS_Missing_Post_Details-43ba1b698c6379e75a7485604082c271.PNG"},85242:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/NetlifyCMS_Published_GitHub_Details-88b3fca2224ecd8c1e3bd4a5f5a8a6bf.PNG"},89178:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/Netlify_Identity_Enable-b3379e6b82b8e48e896424e37f794354.PNG"},91224:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/NetlifyCMS_Home-c6b9918b703aa92564d86a167a2575ce.PNG"}}]);